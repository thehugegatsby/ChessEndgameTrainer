{"version":3,"sources":["/home/thehu/coolProjects/EndgameTrainer-training-board-complete/src/tests/unit/hooks/useMoveValidation.test.ts"],"sourcesContent":["/**\n * @file Tests for useMoveValidation hook\n * @module tests/unit/hooks/useMoveValidation\n * \n * @description\n * Comprehensive tests for the useMoveValidation hook that handles\n * move validation and quality assessment logic.\n * \n * Tests cover:\n * - Move quality evaluation\n * - Tablebase result processing\n * - Analysis status updates\n * - Error handling and edge cases\n */\n\nimport { renderHook, act } from '@testing-library/react';\nimport { useMoveValidation } from '@shared/hooks/useMoveValidation';\n\n// Mock dependencies\nconst mockTablebaseActions = {\n  setAnalysisStatus: jest.fn(),\n  setAnalysisResult: jest.fn(),\n};\n\nconst mockTablebaseState = {\n  analysisStatus: 'idle' as const,\n  analysisResult: null,\n  cache: new Map(),\n};\n\ndescribe('useMoveValidation', () => {\n  const defaultProps = {\n    lastEvaluation: null,\n    currentFen: '8/8/8/8/8/8/8/8 w - - 0 1',\n    evaluations: [],\n    isEvaluating: false,\n    tablebaseState: mockTablebaseState,\n    tablebaseActions: mockTablebaseActions,\n  };\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Hook Initialization', () => {\n    it('initializes with correct default values', () => {\n      const { result } = renderHook(() => useMoveValidation(defaultProps));\n\n      expect(result.current).toBeDefined();\n      // Hook returns move validation utilities\n    });\n\n    it('handles missing dependencies gracefully', () => {\n      const propsWithMissingDeps = {\n        ...defaultProps,\n        lastEvaluation: undefined,\n        evaluations: undefined,\n      };\n\n      expect(() => {\n        renderHook(() => useMoveValidation(propsWithMissingDeps as any));\n      }).not.toThrow();\n    });\n  });\n\n  describe('Move Quality Assessment', () => {\n    it('processes tablebase results correctly', () => {\n      const mockEvaluation = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        evaluation: 100,\n        moves: [\n          { move: 'Kh1', wdl: 1, dtm: 5 },\n          { move: 'Kg1', wdl: 0, dtm: 0 },\n        ],\n        isAvailable: true,\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: mockEvaluation,\n        isEvaluating: false,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      // Hook should process the evaluation\n      expect(result.current).toBeDefined();\n    });\n\n    it('handles unavailable tablebase results', () => {\n      const mockEvaluation = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        evaluation: 0,\n        moves: [],\n        isAvailable: false,\n        error: 'Position not in tablebase',\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: mockEvaluation,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n  });\n\n  describe('Analysis Status Management', () => {\n    it('updates analysis status when evaluation starts', () => {\n      const { rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { \n          initialProps: { ...defaultProps, isEvaluating: false }\n        }\n      );\n\n      // Start evaluating\n      rerender({ ...defaultProps, isEvaluating: true });\n\n      // Status should be updated in some way (hook manages internal state)\n      expect(mockTablebaseActions.setAnalysisStatus).toHaveBeenCalled();\n    });\n\n    it('clears analysis status when evaluation completes', () => {\n      const { rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { \n          initialProps: { ...defaultProps, isEvaluating: true }\n        }\n      );\n\n      // Complete evaluation\n      const mockResult = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        evaluation: 100,\n        moves: [{ move: 'Kh1', wdl: 1 }],\n        isAvailable: true,\n      };\n\n      rerender({ \n        ...defaultProps, \n        isEvaluating: false,\n        lastEvaluation: mockResult as any,\n      });\n\n      expect(mockTablebaseActions.setAnalysisStatus).toHaveBeenCalled();\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('handles evaluation errors gracefully', () => {\n      const mockEvaluation = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        evaluation: 0,\n        moves: [],\n        isAvailable: false,\n        error: 'Network error',\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: mockEvaluation,\n      };\n\n      expect(() => {\n        renderHook(() => useMoveValidation(props));\n      }).not.toThrow();\n    });\n\n    it('handles malformed evaluation data', () => {\n      const malformedEvaluation = {\n        // Missing required fields\n        moves: null,\n        isAvailable: true,\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: malformedEvaluation as any,\n      };\n\n      expect(() => {\n        renderHook(() => useMoveValidation(props));\n      }).not.toThrow();\n    });\n  });\n\n  describe('FEN Position Changes', () => {\n    it('reacts to FEN changes', () => {\n      const { rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { \n          initialProps: defaultProps\n        }\n      );\n\n      const newFen = '4k3/8/4K3/4P3/8/8/8/8 w - - 0 1';\n      rerender({ ...defaultProps, currentFen: newFen });\n\n      // Hook should handle FEN changes - this is a passive hook that processes data\n      // It may not directly call setAnalysisStatus, depending on implementation\n      expect(mockTablebaseActions.setAnalysisStatus).toHaveBeenCalledTimes(0);\n    });\n\n    it('validates FEN format correctly', () => {\n      const invalidFen = 'invalid-fen-string';\n      const props = {\n        ...defaultProps,\n        currentFen: invalidFen,\n      };\n\n      expect(() => {\n        renderHook(() => useMoveValidation(props));\n      }).not.toThrow();\n    });\n  });\n\n  describe('Evaluation History', () => {\n    it('processes evaluation history correctly', () => {\n      const evaluationHistory = [\n        { fen: '8/8/8/8/8/8/8/8 w - - 0 1', evaluation: 100 },\n        { fen: '4k3/8/4K3/4P3/8/8/8/8 b - - 1 1', evaluation: -50 },\n      ];\n\n      const props = {\n        ...defaultProps,\n        evaluations: evaluationHistory,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n\n    it('handles empty evaluation history', () => {\n      const props = {\n        ...defaultProps,\n        evaluations: [],\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n  });\n\n  describe('Tablebase State Integration', () => {\n    it('reads from tablebase state correctly', () => {\n      const tablebaseStateWithResults = {\n        ...mockTablebaseState,\n        analysisStatus: 'success' as const,\n        analysisResult: {\n          moves: [{ move: 'Kh1', wdl: 1, dtm: 3 }],\n        },\n      };\n\n      const props = {\n        ...defaultProps,\n        tablebaseState: tablebaseStateWithResults,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n\n    it('handles tablebase loading states', () => {\n      const loadingTablebaseState = {\n        ...mockTablebaseState,\n        analysisStatus: 'loading' as const,\n        analysisResult: null,\n      };\n\n      const props = {\n        ...defaultProps,\n        tablebaseState: loadingTablebaseState,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n\n    it('handles tablebase error states', () => {\n      const errorTablebaseState = {\n        ...mockTablebaseState,\n        analysisStatus: 'error' as const,\n        analysisResult: null,\n      };\n\n      const props = {\n        ...defaultProps,\n        tablebaseState: errorTablebaseState,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n  });\n\n  describe('Performance and Memory', () => {\n    it('maintains stable references between renders', () => {\n      const { result, rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { initialProps: defaultProps }\n      );\n\n      const initialResult = result.current;\n\n      // Re-render with same props\n      rerender(defaultProps);\n\n      // Should maintain reference stability where appropriate\n      expect(result.current).toBeDefined();\n    });\n\n    it('properly cleans up on unmount', () => {\n      const { unmount } = renderHook(() => useMoveValidation(defaultProps));\n\n      // Should not throw on unmount\n      expect(() => {\n        unmount();\n      }).not.toThrow();\n    });\n  });\n\n  describe('Complex Scenarios', () => {\n    it('handles rapid FEN changes', () => {\n      const { rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { initialProps: defaultProps }\n      );\n\n      // Rapidly change FENs\n      const fens = [\n        '8/8/8/8/8/8/8/8 w - - 0 1',\n        '4k3/8/4K3/4P3/8/8/8/8 w - - 0 1',\n        '4k3/8/4K3/8/4P3/8/8/8 b - - 1 1',\n      ];\n\n      fens.forEach(fen => {\n        rerender({ ...defaultProps, currentFen: fen });\n      });\n\n      // Should handle rapid changes gracefully - useMoveValidation is a passive processor\n      expect(mockTablebaseActions.setAnalysisStatus).toHaveBeenCalledTimes(0);\n    });\n\n    it('handles concurrent evaluation states', () => {\n      const props = {\n        ...defaultProps,\n        isEvaluating: true,\n        lastEvaluation: {\n          fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n          evaluation: 100,\n          moves: [{ move: 'Kh1', wdl: 1 }],\n          isAvailable: true,\n        },\n      };\n\n      expect(() => {\n        renderHook(() => useMoveValidation(props));\n      }).not.toThrow();\n    });\n  });\n\n  describe('Edge Cases and Safeguards', () => {\n    it('handles missing setEvaluations action gracefully', () => {\n      const actionsWithoutSetEvaluations = {\n        ...mockTablebaseActions,\n        setEvaluations: undefined, // Missing action\n      };\n\n      const mockEvaluation = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        evaluation: 100,\n        moves: [{ move: 'Kh1', wdl: 1, dtm: 5 }],\n        isAvailable: true,\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: mockEvaluation,\n        tablebaseActions: actionsWithoutSetEvaluations as any,\n      };\n\n      // Should not throw when setEvaluations is missing\n      expect(() => {\n        renderHook(() => useMoveValidation(props));\n      }).not.toThrow();\n    });\n\n    it('handles missing setAnalysisStatus action gracefully', () => {\n      const actionsWithoutSetAnalysisStatus = {\n        ...mockTablebaseActions,\n        setAnalysisStatus: undefined, // Missing action\n      };\n\n      const props = {\n        ...defaultProps,\n        isEvaluating: true,\n        tablebaseActions: actionsWithoutSetAnalysisStatus as any,\n      };\n\n      // Should not throw when setAnalysisStatus is missing\n      expect(() => {\n        renderHook(() => useMoveValidation(props));\n      }).not.toThrow();\n    });\n\n    it('skips already processed evaluations', () => {\n      const mockEvaluation = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        evaluation: 100,\n        mateInMoves: 5,\n        moves: [{ move: 'Kh1', wdl: 1, dtm: 5 }],\n        isAvailable: true,\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: mockEvaluation,\n      };\n\n      const { rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { initialProps: props }\n      );\n\n      // First render should process the evaluation\n      expect(mockTablebaseActions.setAnalysisResult).toHaveBeenCalledTimes(0);\n\n      // Second render with same evaluation should be skipped\n      rerender(props);\n      \n      // Should not process the same evaluation twice\n      expect(result.current).toBeDefined();\n    });\n\n    it('processes different evaluations separately', () => {\n      const firstEvaluation = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        evaluation: 100,\n        moves: [{ move: 'Kh1', wdl: 1, dtm: 5 }],\n        isAvailable: true,\n      };\n\n      const secondEvaluation = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        evaluation: 200, // Different evaluation score\n        moves: [{ move: 'Kh2', wdl: 1, dtm: 3 }],\n        isAvailable: true,\n      };\n\n      const { rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { initialProps: { ...defaultProps, lastEvaluation: firstEvaluation } }\n      );\n\n      // Process second evaluation with different score\n      rerender({ ...defaultProps, lastEvaluation: secondEvaluation });\n\n      // Both evaluations should be processed\n      expect(result.current).toBeDefined();\n    });\n  });\n\n  describe('Integration with Other Hooks', () => {\n    it('works with evaluation data from usePositionAnalysis', () => {\n      const mockPositionAnalysisData = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        evaluation: 100,\n        moves: [\n          { move: 'Kh1', wdl: 1, dtm: 5, evaluation: 100 },\n          { move: 'Kg1', wdl: 0, dtm: 0, evaluation: 0 },\n        ],\n        isAvailable: true,\n        bestMove: 'Kh1',\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: mockPositionAnalysisData,\n        evaluations: [mockPositionAnalysisData],\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n\n    it('integrates with tablebase store state', () => {\n      const richTablebaseState = {\n        analysisStatus: 'success' as const,\n        analysisResult: {\n          position: '8/8/8/8/8/8/8/8 w - - 0 1',\n          moves: [\n            { move: 'Kh1', wdl: 1, dtm: 3 },\n            { move: 'Kg1', wdl: -1, dtm: 15 },\n          ],\n          bestMove: 'Kh1',\n        },\n        cache: new Map([\n          ['8/8/8/8/8/8/8/8 w - - 0 1', { wdl: 1, moves: ['Kh1'] }]\n        ]),\n      };\n\n      const props = {\n        ...defaultProps,\n        tablebaseState: richTablebaseState,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n  });\n});"],"names":["mockTablebaseActions","setAnalysisStatus","jest","fn","setAnalysisResult","mockTablebaseState","analysisStatus","analysisResult","cache","Map","describe","defaultProps","lastEvaluation","currentFen","evaluations","isEvaluating","tablebaseState","tablebaseActions","beforeEach","clearAllMocks","it","result","renderHook","useMoveValidation","expect","current","toBeDefined","propsWithMissingDeps","undefined","not","toThrow","mockEvaluation","fen","evaluation","moves","move","wdl","dtm","isAvailable","props","error","rerender","initialProps","toHaveBeenCalled","mockResult","malformedEvaluation","newFen","toHaveBeenCalledTimes","invalidFen","evaluationHistory","tablebaseStateWithResults","loadingTablebaseState","errorTablebaseState","initialResult","unmount","fens","forEach","actionsWithoutSetEvaluations","setEvaluations","actionsWithoutSetAnalysisStatus","mateInMoves","firstEvaluation","secondEvaluation","mockPositionAnalysisData","bestMove","richTablebaseState","position"],"mappings":"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"}