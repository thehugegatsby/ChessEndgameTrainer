{"version":3,"sources":["/home/thehu/coolProjects/EndgameTrainer-training-board-complete/src/shared/components/training/AnalysisPanel/AnalysisDetails.tsx"],"sourcesContent":["/**\n * @file Analysis details component for detailed move analysis display\n * @module components/training/AnalysisPanel/AnalysisDetails\n *\n * @description\n * Detailed analysis display component showing comprehensive information about\n * selected chess moves including evaluation, best moves, principal variations,\n * and move classification. Provides rich visual feedback for move analysis.\n *\n * @remarks\n * Key features:\n * - Detailed move analysis display with evaluation bars\n * - Principal variation visualization and interaction\n * - Move classification with color-coded feedback\n * - Position evaluation with descriptive explanations\n * - Responsive design with mobile-optimized layout\n * - Multi-language support (German interface)\n * - Dark mode compatibility\n *\n * The component integrates with the PrincipalVariation component and\n * evaluation utilities to provide comprehensive move analysis feedback.\n */\n\nimport React from \"react\";\nimport { Move } from \"chess.js\";\nimport { getEvaluationBarWidth } from \"../../../utils/chess/evaluation\";\nimport { PrincipalVariation } from \"../PrincipalVariation\";\n\n/**\n * Move analysis data structure for detailed analysis display\n *\n * @interface MoveAnalysisData\n *\n * @property {Move} move - Chess move object from chess.js\n * @property {number} [evaluation] - Position evaluation after the move (in centipawns)\n * @property {string} [bestMove] - Best move according to engine analysis\n * @property {'excellent' | 'good' | 'inaccuracy' | 'mistake' | 'blunder'} [classification] - Move quality classification\n * @property {string[]} [pv] - Principal variation moves array\n * @property {string} [pvString] - Principal variation as formatted string\n * @property {number} [depth] - Analysis depth used for evaluation\n */\ninterface MoveAnalysisData {\n  move: Move;\n  evaluation?: number;\n  bestMove?: string;\n  classification?: \"excellent\" | \"good\" | \"inaccuracy\" | \"mistake\" | \"blunder\";\n  // PHASE 2.2: Enhanced evaluation data\n  pv?: string[];\n  pvString?: string;\n  depth?: number;\n}\n\n/**\n * Props for the AnalysisDetails component\n *\n * @interface AnalysisDetailsProps\n *\n * @property {number | null} selectedMoveIndex - Index of currently selected move for detailed analysis, null if none selected\n * @property {MoveAnalysisData[]} analysisData - Array of move analysis data for all moves in the game\n */\ninterface AnalysisDetailsProps {\n  selectedMoveIndex: number | null;\n  analysisData: MoveAnalysisData[];\n}\n\n/**\n * Format evaluation number for display\n *\n * @param {number} [evaluation] - Evaluation value in centipawns\n * @returns {string} Formatted evaluation string with + sign for positive values\n *\n * @example\n * ```typescript\n * formatEvaluation(1.5)    // \"+1.50\"\n * formatEvaluation(-0.8)   // \"-0.80\"\n * formatEvaluation(undefined) // \"0.00\"\n * ```\n */\nconst formatEvaluation = (evaluation?: number) => {\n  if (evaluation === undefined) return \"0.00\";\n  return evaluation > 0 ? `+${evaluation.toFixed(2)}` : evaluation.toFixed(2);\n};\n\n/**\n * Analysis details component for comprehensive move analysis display\n *\n * @component\n * @description\n * Displays detailed analysis information for a selected chess move including\n * evaluation, best moves, principal variations, move classification, and\n * position assessment. Provides rich visual feedback with evaluation bars,\n * color-coded move quality indicators, and descriptive text explanations.\n *\n * @remarks\n * Feature sections:\n * - Evaluation bar with visual position assessment\n * - Best move suggestion from engine analysis\n * - Principal variation display with interactive moves\n * - Move classification with color-coded quality indicators\n * - Position evaluation with descriptive explanations in German\n * - Empty state with helpful instruction message\n *\n * Visual design:\n * - Responsive layout optimized for mobile devices\n * - Dark mode support with appropriate color schemes\n * - Color-coded move quality (green=excellent, red=blunder)\n * - Gradient evaluation bars for intuitive position assessment\n * - Clean card-based layout with consistent spacing\n *\n * The component is memoized for performance optimization and integrates\n * seamlessly with the broader analysis panel system.\n *\n * @example\n * ```tsx\n * // Basic usage in analysis panel\n * <AnalysisDetails\n *   selectedMoveIndex={currentMoveIndex}\n *   analysisData={gameAnalysisData}\n * />\n *\n * // With no selection (shows empty state)\n * <AnalysisDetails\n *   selectedMoveIndex={null}\n *   analysisData={[]}\n * />\n * ```\n *\n * @param {AnalysisDetailsProps} props - Component configuration\n * @returns {JSX.Element} Detailed analysis display with comprehensive move information\n */\nexport const AnalysisDetails: React.FC<AnalysisDetailsProps> = React.memo(\n  ({ selectedMoveIndex, analysisData }) => {\n    const selectedAnalysis =\n      selectedMoveIndex !== null ? analysisData[selectedMoveIndex] : null;\n\n    return (\n      <div className=\"w-3/5 flex flex-col\">\n        <div className=\"p-2 border-b border-gray-100 dark:border-gray-800 bg-gray-50 dark:bg-gray-800\">\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n            {selectedMoveIndex !== null && selectedAnalysis\n              ? `Zug ${selectedMoveIndex + 1}: ${selectedAnalysis.move.san}`\n              : \"Wähle einen Zug\"}\n          </h4>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto p-3\">\n          {selectedMoveIndex !== null && selectedAnalysis ? (\n            <div className=\"space-y-3\">\n              {/* Compact Evaluation Bar */}\n              <div>\n                <div className=\"flex justify-between items-center mb-1\">\n                  <span className=\"text-xs font-medium text-gray-600 dark:text-gray-400\">\n                    Bewertung\n                  </span>\n                  <span className=\"text-xs font-mono text-gray-700 dark:text-gray-300\">\n                    {formatEvaluation(selectedAnalysis.evaluation)}\n                  </span>\n                </div>\n                <div className=\"w-full h-4 bg-gray-200 dark:bg-gray-700 rounded overflow-hidden\">\n                  <div\n                    className=\"h-full bg-gradient-to-r from-red-500 to-green-500 transition-all duration-300\"\n                    style={{\n                      width: `${getEvaluationBarWidth(selectedAnalysis.evaluation)}%`,\n                    }}\n                  />\n                </div>\n                <div className=\"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  <span>Schwarz führt</span>\n                  <span>Ausgeglichen</span>\n                  <span>Weiß führt</span>\n                </div>\n              </div>\n\n              {/* Best Move */}\n              {selectedAnalysis.bestMove && (\n                <div className=\"bg-gray-50 dark:bg-gray-800 rounded-lg p-3\">\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <span className=\"text-xs font-medium text-gray-600 dark:text-gray-400\">\n                      Bester Zug\n                    </span>\n                    <span className=\"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 rounded\">\n                      Tablebase\n                    </span>\n                  </div>\n                  <span className=\"font-mono text-sm font-semibold text-gray-800 dark:text-gray-200\">\n                    {selectedAnalysis.bestMove}\n                  </span>\n                </div>\n              )}\n\n              {/* Principal Variation - PHASE 2.2 Enhancement */}\n              {selectedAnalysis.pv && selectedAnalysis.pv.length > 0 && (\n                <div className=\"bg-gray-50 dark:bg-gray-800 rounded-lg p-3\">\n                  <PrincipalVariation\n                    pv={selectedAnalysis.pv}\n                    pvString={selectedAnalysis.pvString}\n                    evaluation={selectedAnalysis.evaluation}\n                    depth={selectedAnalysis.depth}\n                    interactive={true}\n                    maxMoves={8} // Limit for mobile UI\n                    onMoveClick={() => {\n                      // Board preview functionality not needed for MVP\n                    }}\n                    className=\"w-full\"\n                  />\n                </div>\n              )}\n\n              {/* Move Classification Details */}\n              {selectedAnalysis.classification && (\n                <div className=\"bg-gray-50 dark:bg-gray-800 rounded-lg p-3\">\n                  <h5 className=\"text-xs font-medium text-gray-600 dark:text-gray-400 mb-2\">\n                    Zugbewertung\n                  </h5>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-xs text-gray-600 dark:text-gray-400\">\n                        Kategorie:\n                      </span>\n                      <span\n                        className={`text-xs font-medium capitalize ${\n                          selectedAnalysis.classification === \"excellent\"\n                            ? \"text-green-600 dark:text-green-400\"\n                            : selectedAnalysis.classification === \"good\"\n                              ? \"text-blue-600 dark:text-blue-400\"\n                              : selectedAnalysis.classification === \"inaccuracy\"\n                                ? \"text-yellow-600 dark:text-yellow-400\"\n                                : selectedAnalysis.classification === \"mistake\"\n                                  ? \"text-orange-600 dark:text-orange-400\"\n                                  : \"text-red-600 dark:text-red-400\"\n                        }`}\n                      >\n                        {selectedAnalysis.classification === \"excellent\"\n                          ? \"Ausgezeichnet\"\n                          : selectedAnalysis.classification === \"good\"\n                            ? \"Gut\"\n                            : selectedAnalysis.classification === \"inaccuracy\"\n                              ? \"Ungenauigkeit\"\n                              : selectedAnalysis.classification === \"mistake\"\n                                ? \"Fehler\"\n                                : \"Patzer\"}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* Additional Analysis Info */}\n              <div className=\"bg-gray-50 dark:bg-gray-800 rounded-lg p-3\">\n                <h5 className=\"text-xs font-medium text-gray-600 dark:text-gray-400 mb-2\">\n                  Positionseinschätzung\n                </h5>\n                <div className=\"text-xs text-gray-600 dark:text-gray-400 leading-relaxed\">\n                  {selectedAnalysis.evaluation !== undefined\n                    ? selectedAnalysis.evaluation > 2\n                      ? \"Weiß steht deutlich besser. Die Position sollte gewonnen werden können.\"\n                      : selectedAnalysis.evaluation > 0.5\n                        ? \"Weiß hat einen kleinen Vorteil. Präzises Spiel ist erforderlich.\"\n                        : selectedAnalysis.evaluation > -0.5\n                          ? \"Die Position ist ausgeglichen. Beide Seiten haben gleiche Chancen.\"\n                          : selectedAnalysis.evaluation > -2\n                            ? \"Schwarz hat einen kleinen Vorteil. Vorsichtiges Spiel ist angebracht.\"\n                            : \"Schwarz steht deutlich besser. Die Position ist schwierig zu verteidigen.\"\n                    : \"Keine detaillierte Bewertung verfügbar.\"}\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"text-center py-8\">\n              <div className=\"text-gray-400 dark:text-gray-500 mb-2\">\n                <span className=\"text-3xl\">📊</span>\n              </div>\n              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                Wähle einen Zug aus der Liste um die Analyse zu sehen\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  },\n);\n\nAnalysisDetails.displayName = \"AnalysisDetails\";\n"],"names":["AnalysisDetails","formatEvaluation","evaluation","undefined","toFixed","React","memo","selectedMoveIndex","analysisData","selectedAnalysis","div","className","h4","move","san","span","style","width","getEvaluationBarWidth","bestMove","pv","length","PrincipalVariation","pvString","depth","interactive","maxMoves","onMoveClick","classification","h5","p","displayName"],"mappings":"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"}