8972c93d1bd950b9181ca2e9bec93d31
"use strict";
// Mock the hooks
jest.mock("@shared/store/hooks");
jest.mock("next/navigation");
jest.mock("@shared/hooks/useToast", ()=>({
        useToast: ()=>({
                showToast: jest.fn()
            })
    }));
// Mock the components
jest.mock("@shared/components/training", ()=>({
        TrainingBoard: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "TrainingBoard"
            }),
        MovePanelZustand: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "MovePanelZustand"
            }),
        NavigationControls: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "NavigationControls"
            })
    }));
jest.mock("@shared/components/training/TablebaseAnalysisPanel", ()=>({
        TablebaseAnalysisPanel: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "TablebaseAnalysisPanel"
            })
    }));
jest.mock("@shared/components/navigation/AdvancedEndgameMenu", ()=>({
        AdvancedEndgameMenu: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "AdvancedEndgameMenu"
            })
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _hooks = require("../../../shared/store/hooks");
const _navigation = require("next/navigation");
const _fenPositions = require("../../fixtures/fenPositions");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
describe("EndgameTrainingPage - Lichess URL Generation", ()=>{
    let mockGameState;
    let mockGameActions;
    let mockTrainingState;
    let mockTrainingActions;
    let mockUIState;
    let mockUIActions;
    beforeEach(()=>{
        // Setup default mock states
        mockGameState = {
            currentFen: "8/8/8/4k3/8/8/4P3/4K3 w - - 0 1",
            currentPgn: "",
            moveHistory: [],
            currentMoveIndex: -1,
            isGameFinished: false,
            gameResult: null
        };
        mockGameActions = {
            initializeGame: jest.fn(),
            makeMove: jest.fn(),
            undoMove: jest.fn(),
            goToMove: jest.fn()
        };
        mockTrainingState = {
            isTraining: false,
            trainingMode: "practice",
            playerColor: "white"
        };
        mockTrainingActions = {
            startTraining: jest.fn(),
            stopTraining: jest.fn()
        };
        mockUIState = {
            analysisPanel: {
                isOpen: false
            }
        };
        mockUIActions = {
            updateAnalysisPanel: jest.fn()
        };
        // Setup mock implementations
        _hooks.useGameStore.mockReturnValue([
            mockGameState,
            mockGameActions
        ]);
        _hooks.useTrainingStore.mockReturnValue([
            mockTrainingState,
            mockTrainingActions
        ]);
        _hooks.useUIStore.mockReturnValue([
            mockUIState,
            mockUIActions
        ]);
        _navigation.useRouter.mockReturnValue({
            push: jest.fn()
        });
    });
    describe("getLichessUrl", ()=>{
        it("should generate FEN-based URL when no PGN is available", ()=>{
            // The component should use FEN-only URL when currentPgn is empty
            const expectedUrl = "https://lichess.org/analysis/8/8/8/4k3/8/8/4P3/4K3_w_-_-_0_1";
            // Test that the function would generate the correct URL
            const currentPgn = "";
            const currentFen = "8/8/8/4k3/8/8/4P3/4K3 w - - 0 1";
            const moveHistory = [];
            const url = currentPgn && moveHistory.length > 0 ? `https://lichess.org/analysis/pgn/${encodeURIComponent(currentPgn)}` : `https://lichess.org/analysis/${currentFen.replace(/ /g, "_")}`;
            expect(url).toBe(expectedUrl);
        });
        it("should generate FEN-based URL when no moves have been made", ()=>{
            // Even with PGN present, if no moves, use FEN
            const currentPgn = '[SetUp "1"]\n[FEN "8/8/8/4k3/8/8/4P3/4K3 w - - 0 1"]\n\n*';
            const currentFen = "8/8/8/4k3/8/8/4P3/4K3 w - - 0 1";
            const moveHistory = [];
            const url = currentPgn && moveHistory.length > 0 ? `https://lichess.org/analysis/pgn/${encodeURIComponent(currentPgn)}` : `https://lichess.org/analysis/${currentFen.replace(/ /g, "_")}`;
            const expectedUrl = "https://lichess.org/analysis/8/8/8/4k3/8/8/4P3/4K3_w_-_-_0_1";
            expect(url).toBe(expectedUrl);
        });
        it("should generate PGN-based URL when PGN is available with moves", ()=>{
            // Test with a sample PGN
            const samplePgn = "1. e4 e5 2. Nf3 Nc6";
            const currentFen = "r1bqkbnr/pppp1ppp/2n5/4p3/4P3/5N2/PPPP1PPP/RNBQKB1R w KQkq - 2 3";
            const moveHistory = [
                {
                    from: "e2",
                    to: "e4",
                    san: "e4"
                },
                {
                    from: "e7",
                    to: "e5",
                    san: "e5"
                },
                {
                    from: "g1",
                    to: "f3",
                    san: "Nf3"
                },
                {
                    from: "b8",
                    to: "c6",
                    san: "Nc6"
                }
            ];
            const url = samplePgn && moveHistory.length > 0 ? `https://lichess.org/analysis/pgn/${encodeURIComponent(samplePgn)}` : `https://lichess.org/analysis/${currentFen.replace(/ /g, "_")}`;
            const expectedUrl = `https://lichess.org/analysis/pgn/${encodeURIComponent(samplePgn)}`;
            expect(url).toBe(expectedUrl);
        });
        it("should handle empty move history even with PGN present", ()=>{
            // Edge case: PGN exists but move history is empty (shouldn't normally happen)
            const currentPgn = "1. e4";
            const currentFen = "rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1";
            const moveHistory = [];
            const url = currentPgn && moveHistory.length > 0 ? `https://lichess.org/analysis/pgn/${encodeURIComponent(currentPgn)}` : `https://lichess.org/analysis/${currentFen.replace(/ /g, "_")}`;
            // Should fall back to FEN since moveHistory is empty
            const expectedUrl = `https://lichess.org/analysis/${currentFen.replace(/ /g, "_")}`;
            expect(url).toBe(expectedUrl);
        });
        it("should properly encode PGN with special characters", ()=>{
            // Test PGN with promotions and special notation
            const complexPgn = "1. e4 e5 2. Nf3 Nc6 3. Bb5 a6 4. Ba4 Nf6 5. O-O Be7";
            const moveHistory = new Array(10).fill({
                from: "a1",
                to: "a2",
                san: "a2"
            }); // Dummy moves
            const url = complexPgn && moveHistory.length > 0 ? `https://lichess.org/analysis/pgn/${encodeURIComponent(complexPgn)}` : `https://lichess.org/analysis/8/8/8/8/8/8/8/8_w_-_-_0_1`;
            expect(url).toContain("analysis/pgn/");
            expect(url).toContain(encodeURIComponent(complexPgn));
            // Verify proper encoding
            expect(url).toContain("1.%20e4%20e5%202.%20Nf3");
        });
        it("should handle endgame position with partial game", ()=>{
            // Simulate an endgame where we've made some moves
            const endgamePgn = "[FEN \"8/8/8/4k3/8/8/4P3/4K3 w - - 0 1\"]\n\n1. e3 Kd5 2. Kf2 Ke4";
            const complexEndgame = _fenPositions.IntegrationTestPositions.COMPLEX_ENDGAME;
            const currentFen = complexEndgame.fen;
            const moveHistory = [
                {
                    from: "e2",
                    to: "e3",
                    san: "e3"
                },
                {
                    from: "e5",
                    to: "d5",
                    san: "Kd5"
                },
                {
                    from: "e1",
                    to: "f2",
                    san: "Kf2"
                },
                {
                    from: "d5",
                    to: "e4",
                    san: "Ke4"
                }
            ];
            const url = endgamePgn && moveHistory.length > 0 ? `https://lichess.org/analysis/pgn/${encodeURIComponent(endgamePgn)}` : `https://lichess.org/analysis/${currentFen.replace(/ /g, "_")}`;
            expect(url).toContain("analysis/pgn/");
            expect(url).toContain(encodeURIComponent("[FEN"));
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3RoZWh1L2Nvb2xQcm9qZWN0cy9FbmRnYW1lVHJhaW5lci10cmFpbmluZy1ib2FyZC1jb21wbGV0ZS9zcmMvdGVzdHMvdW5pdC9wYWdlcy9FbmRnYW1lVHJhaW5pbmdQYWdlLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZUdhbWVTdG9yZSwgdXNlVHJhaW5pbmdTdG9yZSwgdXNlVUlTdG9yZSB9IGZyb20gXCJAc2hhcmVkL3N0b3JlL2hvb2tzXCI7XG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tIFwibmV4dC9uYXZpZ2F0aW9uXCI7XG5pbXBvcnQgeyBJbnRlZ3JhdGlvblRlc3RQb3NpdGlvbnMgfSBmcm9tIFwiLi4vLi4vZml4dHVyZXMvZmVuUG9zaXRpb25zXCI7XG5cbi8vIE1vY2sgdGhlIGhvb2tzXG5qZXN0Lm1vY2soXCJAc2hhcmVkL3N0b3JlL2hvb2tzXCIpO1xuamVzdC5tb2NrKFwibmV4dC9uYXZpZ2F0aW9uXCIpO1xuamVzdC5tb2NrKFwiQHNoYXJlZC9ob29rcy91c2VUb2FzdFwiLCAoKSA9PiAoe1xuICB1c2VUb2FzdDogKCkgPT4gKHtcbiAgICBzaG93VG9hc3Q6IGplc3QuZm4oKSxcbiAgfSksXG59KSk7XG5cbi8vIE1vY2sgdGhlIGNvbXBvbmVudHNcbmplc3QubW9jayhcIkBzaGFyZWQvY29tcG9uZW50cy90cmFpbmluZ1wiLCAoKSA9PiAoe1xuICBUcmFpbmluZ0JvYXJkOiAoKSA9PiA8ZGl2PlRyYWluaW5nQm9hcmQ8L2Rpdj4sXG4gIE1vdmVQYW5lbFp1c3RhbmQ6ICgpID0+IDxkaXY+TW92ZVBhbmVsWnVzdGFuZDwvZGl2PixcbiAgTmF2aWdhdGlvbkNvbnRyb2xzOiAoKSA9PiA8ZGl2Pk5hdmlnYXRpb25Db250cm9sczwvZGl2Pixcbn0pKTtcblxuamVzdC5tb2NrKFwiQHNoYXJlZC9jb21wb25lbnRzL3RyYWluaW5nL1RhYmxlYmFzZUFuYWx5c2lzUGFuZWxcIiwgKCkgPT4gKHtcbiAgVGFibGViYXNlQW5hbHlzaXNQYW5lbDogKCkgPT4gPGRpdj5UYWJsZWJhc2VBbmFseXNpc1BhbmVsPC9kaXY+LFxufSkpO1xuXG5qZXN0Lm1vY2soXCJAc2hhcmVkL2NvbXBvbmVudHMvbmF2aWdhdGlvbi9BZHZhbmNlZEVuZGdhbWVNZW51XCIsICgpID0+ICh7XG4gIEFkdmFuY2VkRW5kZ2FtZU1lbnU6ICgpID0+IDxkaXY+QWR2YW5jZWRFbmRnYW1lTWVudTwvZGl2Pixcbn0pKTtcblxuZGVzY3JpYmUoXCJFbmRnYW1lVHJhaW5pbmdQYWdlIC0gTGljaGVzcyBVUkwgR2VuZXJhdGlvblwiLCAoKSA9PiB7XG4gIGxldCBtb2NrR2FtZVN0YXRlOiBhbnk7XG4gIGxldCBtb2NrR2FtZUFjdGlvbnM6IGFueTtcbiAgbGV0IG1vY2tUcmFpbmluZ1N0YXRlOiBhbnk7XG4gIGxldCBtb2NrVHJhaW5pbmdBY3Rpb25zOiBhbnk7XG4gIGxldCBtb2NrVUlTdGF0ZTogYW55O1xuICBsZXQgbW9ja1VJQWN0aW9uczogYW55O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIC8vIFNldHVwIGRlZmF1bHQgbW9jayBzdGF0ZXNcbiAgICBtb2NrR2FtZVN0YXRlID0ge1xuICAgICAgY3VycmVudEZlbjogXCI4LzgvOC80azMvOC84LzRQMy80SzMgdyAtIC0gMCAxXCIsXG4gICAgICBjdXJyZW50UGduOiBcIlwiLFxuICAgICAgbW92ZUhpc3Rvcnk6IFtdLFxuICAgICAgY3VycmVudE1vdmVJbmRleDogLTEsXG4gICAgICBpc0dhbWVGaW5pc2hlZDogZmFsc2UsXG4gICAgICBnYW1lUmVzdWx0OiBudWxsLFxuICAgIH07XG5cbiAgICBtb2NrR2FtZUFjdGlvbnMgPSB7XG4gICAgICBpbml0aWFsaXplR2FtZTogamVzdC5mbigpLFxuICAgICAgbWFrZU1vdmU6IGplc3QuZm4oKSxcbiAgICAgIHVuZG9Nb3ZlOiBqZXN0LmZuKCksXG4gICAgICBnb1RvTW92ZTogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBtb2NrVHJhaW5pbmdTdGF0ZSA9IHtcbiAgICAgIGlzVHJhaW5pbmc6IGZhbHNlLFxuICAgICAgdHJhaW5pbmdNb2RlOiBcInByYWN0aWNlXCIsXG4gICAgICBwbGF5ZXJDb2xvcjogXCJ3aGl0ZVwiLFxuICAgIH07XG5cbiAgICBtb2NrVHJhaW5pbmdBY3Rpb25zID0ge1xuICAgICAgc3RhcnRUcmFpbmluZzogamVzdC5mbigpLFxuICAgICAgc3RvcFRyYWluaW5nOiBqZXN0LmZuKCksXG4gICAgfTtcblxuICAgIG1vY2tVSVN0YXRlID0ge1xuICAgICAgYW5hbHlzaXNQYW5lbDoge1xuICAgICAgICBpc09wZW46IGZhbHNlLFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgbW9ja1VJQWN0aW9ucyA9IHtcbiAgICAgIHVwZGF0ZUFuYWx5c2lzUGFuZWw6IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgLy8gU2V0dXAgbW9jayBpbXBsZW1lbnRhdGlvbnNcbiAgICAodXNlR2FtZVN0b3JlIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKFttb2NrR2FtZVN0YXRlLCBtb2NrR2FtZUFjdGlvbnNdKTtcbiAgICAodXNlVHJhaW5pbmdTdG9yZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShbbW9ja1RyYWluaW5nU3RhdGUsIG1vY2tUcmFpbmluZ0FjdGlvbnNdKTtcbiAgICAodXNlVUlTdG9yZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShbbW9ja1VJU3RhdGUsIG1vY2tVSUFjdGlvbnNdKTtcbiAgICAodXNlUm91dGVyIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIHB1c2g6IGplc3QuZm4oKSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJnZXRMaWNoZXNzVXJsXCIsICgpID0+IHtcbiAgICBpdChcInNob3VsZCBnZW5lcmF0ZSBGRU4tYmFzZWQgVVJMIHdoZW4gbm8gUEdOIGlzIGF2YWlsYWJsZVwiLCAoKSA9PiB7XG4gICAgICAvLyBUaGUgY29tcG9uZW50IHNob3VsZCB1c2UgRkVOLW9ubHkgVVJMIHdoZW4gY3VycmVudFBnbiBpcyBlbXB0eVxuICAgICAgY29uc3QgZXhwZWN0ZWRVcmwgPSBcImh0dHBzOi8vbGljaGVzcy5vcmcvYW5hbHlzaXMvOC84LzgvNGszLzgvOC80UDMvNEszX3dfLV8tXzBfMVwiO1xuICAgICAgXG4gICAgICAvLyBUZXN0IHRoYXQgdGhlIGZ1bmN0aW9uIHdvdWxkIGdlbmVyYXRlIHRoZSBjb3JyZWN0IFVSTFxuICAgICAgY29uc3QgY3VycmVudFBnbiA9IFwiXCI7XG4gICAgICBjb25zdCBjdXJyZW50RmVuID0gXCI4LzgvOC80azMvOC84LzRQMy80SzMgdyAtIC0gMCAxXCI7XG4gICAgICBjb25zdCBtb3ZlSGlzdG9yeTogYW55W10gPSBbXTtcblxuICAgICAgY29uc3QgdXJsID0gY3VycmVudFBnbiAmJiBtb3ZlSGlzdG9yeS5sZW5ndGggPiAwXG4gICAgICAgID8gYGh0dHBzOi8vbGljaGVzcy5vcmcvYW5hbHlzaXMvcGduLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGN1cnJlbnRQZ24pfWBcbiAgICAgICAgOiBgaHR0cHM6Ly9saWNoZXNzLm9yZy9hbmFseXNpcy8ke2N1cnJlbnRGZW4ucmVwbGFjZSgvIC9nLCBcIl9cIil9YDtcblxuICAgICAgZXhwZWN0KHVybCkudG9CZShleHBlY3RlZFVybCk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBnZW5lcmF0ZSBGRU4tYmFzZWQgVVJMIHdoZW4gbm8gbW92ZXMgaGF2ZSBiZWVuIG1hZGVcIiwgKCkgPT4ge1xuICAgICAgLy8gRXZlbiB3aXRoIFBHTiBwcmVzZW50LCBpZiBubyBtb3ZlcywgdXNlIEZFTlxuICAgICAgY29uc3QgY3VycmVudFBnbiA9ICdbU2V0VXAgXCIxXCJdXFxuW0ZFTiBcIjgvOC84LzRrMy84LzgvNFAzLzRLMyB3IC0gLSAwIDFcIl1cXG5cXG4qJztcbiAgICAgIGNvbnN0IGN1cnJlbnRGZW4gPSBcIjgvOC84LzRrMy84LzgvNFAzLzRLMyB3IC0gLSAwIDFcIjtcbiAgICAgIGNvbnN0IG1vdmVIaXN0b3J5OiBhbnlbXSA9IFtdO1xuXG4gICAgICBjb25zdCB1cmwgPSBjdXJyZW50UGduICYmIG1vdmVIaXN0b3J5Lmxlbmd0aCA+IDBcbiAgICAgICAgPyBgaHR0cHM6Ly9saWNoZXNzLm9yZy9hbmFseXNpcy9wZ24vJHtlbmNvZGVVUklDb21wb25lbnQoY3VycmVudFBnbil9YFxuICAgICAgICA6IGBodHRwczovL2xpY2hlc3Mub3JnL2FuYWx5c2lzLyR7Y3VycmVudEZlbi5yZXBsYWNlKC8gL2csIFwiX1wiKX1gO1xuXG4gICAgICBjb25zdCBleHBlY3RlZFVybCA9IFwiaHR0cHM6Ly9saWNoZXNzLm9yZy9hbmFseXNpcy84LzgvOC80azMvOC84LzRQMy80SzNfd18tXy1fMF8xXCI7XG4gICAgICBleHBlY3QodXJsKS50b0JlKGV4cGVjdGVkVXJsKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGdlbmVyYXRlIFBHTi1iYXNlZCBVUkwgd2hlbiBQR04gaXMgYXZhaWxhYmxlIHdpdGggbW92ZXNcIiwgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB3aXRoIGEgc2FtcGxlIFBHTlxuICAgICAgY29uc3Qgc2FtcGxlUGduID0gXCIxLiBlNCBlNSAyLiBOZjMgTmM2XCI7XG4gICAgICBjb25zdCBjdXJyZW50RmVuID0gXCJyMWJxa2Juci9wcHBwMXBwcC8ybjUvNHAzLzRQMy81TjIvUFBQUDFQUFAvUk5CUUtCMVIgdyBLUWtxIC0gMiAzXCI7XG4gICAgICBjb25zdCBtb3ZlSGlzdG9yeSA9IFtcbiAgICAgICAgeyBmcm9tOiBcImUyXCIsIHRvOiBcImU0XCIsIHNhbjogXCJlNFwiIH0sXG4gICAgICAgIHsgZnJvbTogXCJlN1wiLCB0bzogXCJlNVwiLCBzYW46IFwiZTVcIiB9LFxuICAgICAgICB7IGZyb206IFwiZzFcIiwgdG86IFwiZjNcIiwgc2FuOiBcIk5mM1wiIH0sXG4gICAgICAgIHsgZnJvbTogXCJiOFwiLCB0bzogXCJjNlwiLCBzYW46IFwiTmM2XCIgfSxcbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IHVybCA9IHNhbXBsZVBnbiAmJiBtb3ZlSGlzdG9yeS5sZW5ndGggPiAwXG4gICAgICAgID8gYGh0dHBzOi8vbGljaGVzcy5vcmcvYW5hbHlzaXMvcGduLyR7ZW5jb2RlVVJJQ29tcG9uZW50KHNhbXBsZVBnbil9YFxuICAgICAgICA6IGBodHRwczovL2xpY2hlc3Mub3JnL2FuYWx5c2lzLyR7Y3VycmVudEZlbi5yZXBsYWNlKC8gL2csIFwiX1wiKX1gO1xuXG4gICAgICBjb25zdCBleHBlY3RlZFVybCA9IGBodHRwczovL2xpY2hlc3Mub3JnL2FuYWx5c2lzL3Bnbi8ke2VuY29kZVVSSUNvbXBvbmVudChzYW1wbGVQZ24pfWA7XG4gICAgICBleHBlY3QodXJsKS50b0JlKGV4cGVjdGVkVXJsKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGhhbmRsZSBlbXB0eSBtb3ZlIGhpc3RvcnkgZXZlbiB3aXRoIFBHTiBwcmVzZW50XCIsICgpID0+IHtcbiAgICAgIC8vIEVkZ2UgY2FzZTogUEdOIGV4aXN0cyBidXQgbW92ZSBoaXN0b3J5IGlzIGVtcHR5IChzaG91bGRuJ3Qgbm9ybWFsbHkgaGFwcGVuKVxuICAgICAgY29uc3QgY3VycmVudFBnbiA9IFwiMS4gZTRcIjtcbiAgICAgIGNvbnN0IGN1cnJlbnRGZW4gPSBcInJuYnFrYm5yL3BwcHBwcHBwLzgvOC80UDMvOC9QUFBQMVBQUC9STkJRS0JOUiBiIEtRa3EgZTMgMCAxXCI7XG4gICAgICBjb25zdCBtb3ZlSGlzdG9yeTogYW55W10gPSBbXTtcblxuICAgICAgY29uc3QgdXJsID0gY3VycmVudFBnbiAmJiBtb3ZlSGlzdG9yeS5sZW5ndGggPiAwXG4gICAgICAgID8gYGh0dHBzOi8vbGljaGVzcy5vcmcvYW5hbHlzaXMvcGduLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGN1cnJlbnRQZ24pfWBcbiAgICAgICAgOiBgaHR0cHM6Ly9saWNoZXNzLm9yZy9hbmFseXNpcy8ke2N1cnJlbnRGZW4ucmVwbGFjZSgvIC9nLCBcIl9cIil9YDtcblxuICAgICAgLy8gU2hvdWxkIGZhbGwgYmFjayB0byBGRU4gc2luY2UgbW92ZUhpc3RvcnkgaXMgZW1wdHlcbiAgICAgIGNvbnN0IGV4cGVjdGVkVXJsID0gYGh0dHBzOi8vbGljaGVzcy5vcmcvYW5hbHlzaXMvJHtjdXJyZW50RmVuLnJlcGxhY2UoLyAvZywgXCJfXCIpfWA7XG4gICAgICBleHBlY3QodXJsKS50b0JlKGV4cGVjdGVkVXJsKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHByb3Blcmx5IGVuY29kZSBQR04gd2l0aCBzcGVjaWFsIGNoYXJhY3RlcnNcIiwgKCkgPT4ge1xuICAgICAgLy8gVGVzdCBQR04gd2l0aCBwcm9tb3Rpb25zIGFuZCBzcGVjaWFsIG5vdGF0aW9uXG4gICAgICBjb25zdCBjb21wbGV4UGduID0gXCIxLiBlNCBlNSAyLiBOZjMgTmM2IDMuIEJiNSBhNiA0LiBCYTQgTmY2IDUuIE8tTyBCZTdcIjtcbiAgICAgIGNvbnN0IG1vdmVIaXN0b3J5ID0gbmV3IEFycmF5KDEwKS5maWxsKHsgZnJvbTogXCJhMVwiLCB0bzogXCJhMlwiLCBzYW46IFwiYTJcIiB9KTsgLy8gRHVtbXkgbW92ZXNcblxuICAgICAgY29uc3QgdXJsID0gY29tcGxleFBnbiAmJiBtb3ZlSGlzdG9yeS5sZW5ndGggPiAwXG4gICAgICAgID8gYGh0dHBzOi8vbGljaGVzcy5vcmcvYW5hbHlzaXMvcGduLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGNvbXBsZXhQZ24pfWBcbiAgICAgICAgOiBgaHR0cHM6Ly9saWNoZXNzLm9yZy9hbmFseXNpcy84LzgvOC84LzgvOC84Lzhfd18tXy1fMF8xYDtcblxuICAgICAgZXhwZWN0KHVybCkudG9Db250YWluKFwiYW5hbHlzaXMvcGduL1wiKTtcbiAgICAgIGV4cGVjdCh1cmwpLnRvQ29udGFpbihlbmNvZGVVUklDb21wb25lbnQoY29tcGxleFBnbikpO1xuICAgICAgLy8gVmVyaWZ5IHByb3BlciBlbmNvZGluZ1xuICAgICAgZXhwZWN0KHVybCkudG9Db250YWluKFwiMS4lMjBlNCUyMGU1JTIwMi4lMjBOZjNcIik7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBoYW5kbGUgZW5kZ2FtZSBwb3NpdGlvbiB3aXRoIHBhcnRpYWwgZ2FtZVwiLCAoKSA9PiB7XG4gICAgICAvLyBTaW11bGF0ZSBhbiBlbmRnYW1lIHdoZXJlIHdlJ3ZlIG1hZGUgc29tZSBtb3Zlc1xuICAgICAgY29uc3QgZW5kZ2FtZVBnbiA9IFwiW0ZFTiBcXFwiOC84LzgvNGszLzgvOC80UDMvNEszIHcgLSAtIDAgMVxcXCJdXFxuXFxuMS4gZTMgS2Q1IDIuIEtmMiBLZTRcIjtcbiAgICAgIGNvbnN0IGNvbXBsZXhFbmRnYW1lID0gSW50ZWdyYXRpb25UZXN0UG9zaXRpb25zLkNPTVBMRVhfRU5ER0FNRTtcbiAgICAgIGNvbnN0IGN1cnJlbnRGZW4gPSBjb21wbGV4RW5kZ2FtZS5mZW47XG4gICAgICBjb25zdCBtb3ZlSGlzdG9yeSA9IFtcbiAgICAgICAgeyBmcm9tOiBcImUyXCIsIHRvOiBcImUzXCIsIHNhbjogXCJlM1wiIH0sXG4gICAgICAgIHsgZnJvbTogXCJlNVwiLCB0bzogXCJkNVwiLCBzYW46IFwiS2Q1XCIgfSxcbiAgICAgICAgeyBmcm9tOiBcImUxXCIsIHRvOiBcImYyXCIsIHNhbjogXCJLZjJcIiB9LFxuICAgICAgICB7IGZyb206IFwiZDVcIiwgdG86IFwiZTRcIiwgc2FuOiBcIktlNFwiIH0sXG4gICAgICBdO1xuXG4gICAgICBjb25zdCB1cmwgPSBlbmRnYW1lUGduICYmIG1vdmVIaXN0b3J5Lmxlbmd0aCA+IDBcbiAgICAgICAgPyBgaHR0cHM6Ly9saWNoZXNzLm9yZy9hbmFseXNpcy9wZ24vJHtlbmNvZGVVUklDb21wb25lbnQoZW5kZ2FtZVBnbil9YFxuICAgICAgICA6IGBodHRwczovL2xpY2hlc3Mub3JnL2FuYWx5c2lzLyR7Y3VycmVudEZlbi5yZXBsYWNlKC8gL2csIFwiX1wiKX1gO1xuXG4gICAgICBleHBlY3QodXJsKS50b0NvbnRhaW4oXCJhbmFseXNpcy9wZ24vXCIpO1xuICAgICAgZXhwZWN0KHVybCkudG9Db250YWluKGVuY29kZVVSSUNvbXBvbmVudChcIltGRU5cIikpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInVzZVRvYXN0Iiwic2hvd1RvYXN0IiwiZm4iLCJUcmFpbmluZ0JvYXJkIiwiZGl2IiwiTW92ZVBhbmVsWnVzdGFuZCIsIk5hdmlnYXRpb25Db250cm9scyIsIlRhYmxlYmFzZUFuYWx5c2lzUGFuZWwiLCJBZHZhbmNlZEVuZGdhbWVNZW51IiwiZGVzY3JpYmUiLCJtb2NrR2FtZVN0YXRlIiwibW9ja0dhbWVBY3Rpb25zIiwibW9ja1RyYWluaW5nU3RhdGUiLCJtb2NrVHJhaW5pbmdBY3Rpb25zIiwibW9ja1VJU3RhdGUiLCJtb2NrVUlBY3Rpb25zIiwiYmVmb3JlRWFjaCIsImN1cnJlbnRGZW4iLCJjdXJyZW50UGduIiwibW92ZUhpc3RvcnkiLCJjdXJyZW50TW92ZUluZGV4IiwiaXNHYW1lRmluaXNoZWQiLCJnYW1lUmVzdWx0IiwiaW5pdGlhbGl6ZUdhbWUiLCJtYWtlTW92ZSIsInVuZG9Nb3ZlIiwiZ29Ub01vdmUiLCJpc1RyYWluaW5nIiwidHJhaW5pbmdNb2RlIiwicGxheWVyQ29sb3IiLCJzdGFydFRyYWluaW5nIiwic3RvcFRyYWluaW5nIiwiYW5hbHlzaXNQYW5lbCIsImlzT3BlbiIsInVwZGF0ZUFuYWx5c2lzUGFuZWwiLCJ1c2VHYW1lU3RvcmUiLCJtb2NrUmV0dXJuVmFsdWUiLCJ1c2VUcmFpbmluZ1N0b3JlIiwidXNlVUlTdG9yZSIsInVzZVJvdXRlciIsInB1c2giLCJpdCIsImV4cGVjdGVkVXJsIiwidXJsIiwibGVuZ3RoIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicmVwbGFjZSIsImV4cGVjdCIsInRvQmUiLCJzYW1wbGVQZ24iLCJmcm9tIiwidG8iLCJzYW4iLCJjb21wbGV4UGduIiwiQXJyYXkiLCJmaWxsIiwidG9Db250YWluIiwiZW5kZ2FtZVBnbiIsImNvbXBsZXhFbmRnYW1lIiwiSW50ZWdyYXRpb25UZXN0UG9zaXRpb25zIiwiQ09NUExFWF9FTkRHQU1FIiwiZmVuIl0sIm1hcHBpbmdzIjoiO0FBS0EsaUJBQWlCO0FBQ2pCQSxLQUFLQyxJQUFJLENBQUM7QUFDVkQsS0FBS0MsSUFBSSxDQUFDO0FBQ1ZELEtBQUtDLElBQUksQ0FBQywwQkFBMEIsSUFBTyxDQUFBO1FBQ3pDQyxVQUFVLElBQU8sQ0FBQTtnQkFDZkMsV0FBV0gsS0FBS0ksRUFBRTtZQUNwQixDQUFBO0lBQ0YsQ0FBQTtBQUVBLHNCQUFzQjtBQUN0QkosS0FBS0MsSUFBSSxDQUFDLCtCQUErQixJQUFPLENBQUE7UUFDOUNJLGVBQWUsa0JBQU0scUJBQUNDOzBCQUFJOztRQUMxQkMsa0JBQWtCLGtCQUFNLHFCQUFDRDswQkFBSTs7UUFDN0JFLG9CQUFvQixrQkFBTSxxQkFBQ0Y7MEJBQUk7O0lBQ2pDLENBQUE7QUFFQU4sS0FBS0MsSUFBSSxDQUFDLHNEQUFzRCxJQUFPLENBQUE7UUFDckVRLHdCQUF3QixrQkFBTSxxQkFBQ0g7MEJBQUk7O0lBQ3JDLENBQUE7QUFFQU4sS0FBS0MsSUFBSSxDQUFDLHFEQUFxRCxJQUFPLENBQUE7UUFDcEVTLHFCQUFxQixrQkFBTSxxQkFBQ0o7MEJBQUk7O0lBQ2xDLENBQUE7Ozs7OzhEQTNCa0I7dUJBQ3lDOzRCQUNqQzs4QkFDZTs7Ozs7O0FBMEJ6Q0ssU0FBUyxnREFBZ0Q7SUFDdkQsSUFBSUM7SUFDSixJQUFJQztJQUNKLElBQUlDO0lBQ0osSUFBSUM7SUFDSixJQUFJQztJQUNKLElBQUlDO0lBRUpDLFdBQVc7UUFDVCw0QkFBNEI7UUFDNUJOLGdCQUFnQjtZQUNkTyxZQUFZO1lBQ1pDLFlBQVk7WUFDWkMsYUFBYSxFQUFFO1lBQ2ZDLGtCQUFrQixDQUFDO1lBQ25CQyxnQkFBZ0I7WUFDaEJDLFlBQVk7UUFDZDtRQUVBWCxrQkFBa0I7WUFDaEJZLGdCQUFnQnpC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