{"version":3,"sources":["/home/thehu/coolProjects/EndgameTrainer-training-board-complete/src/tests/unit/hooks/useMoveValidation.test.ts"],"sourcesContent":["/**\n * @file Tests for useMoveValidation hook\n * @module tests/unit/hooks/useMoveValidation\n * \n * @description\n * Comprehensive tests for the useMoveValidation hook that handles\n * move validation and quality assessment logic.\n * \n * Tests cover:\n * - Move quality evaluation\n * - Tablebase result processing\n * - Analysis status updates\n * - Error handling and edge cases\n */\n\nimport { renderHook, act } from '@testing-library/react';\nimport { useMoveValidation } from '@shared/hooks/useMoveValidation';\n\n// Mock dependencies\nconst mockTablebaseActions = {\n  setAnalysisStatus: jest.fn(),\n  setAnalysisResult: jest.fn(),\n};\n\nconst mockTablebaseState = {\n  analysisStatus: 'idle' as const,\n  analysisResult: null,\n  cache: new Map(),\n};\n\ndescribe('useMoveValidation', () => {\n  const defaultProps = {\n    lastEvaluation: null,\n    currentFen: '8/8/8/8/8/8/8/8 w - - 0 1',\n    evaluations: [],\n    isEvaluating: false,\n    tablebaseState: mockTablebaseState,\n    tablebaseActions: mockTablebaseActions,\n  };\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Hook Initialization', () => {\n    it('initializes with correct default values', () => {\n      const { result } = renderHook(() => useMoveValidation(defaultProps));\n\n      expect(result.current).toBeDefined();\n      // Hook returns move validation utilities\n    });\n\n    it('handles missing dependencies gracefully', () => {\n      const propsWithMissingDeps = {\n        ...defaultProps,\n        lastEvaluation: undefined,\n        evaluations: undefined,\n      };\n\n      expect(() => {\n        renderHook(() => useMoveValidation(propsWithMissingDeps as any));\n      }).not.toThrow();\n    });\n  });\n\n  describe('Move Quality Assessment', () => {\n    it('processes tablebase results correctly', () => {\n      const mockEvaluation = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        moves: [\n          { move: 'Kh1', wdl: 1, dtm: 5 },\n          { move: 'Kg1', wdl: 0, dtm: 0 },\n        ],\n        isAvailable: true,\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: mockEvaluation,\n        isEvaluating: false,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      // Hook should process the evaluation\n      expect(result.current).toBeDefined();\n    });\n\n    it('handles unavailable tablebase results', () => {\n      const mockEvaluation = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        moves: [],\n        isAvailable: false,\n        error: 'Position not in tablebase',\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: mockEvaluation,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n  });\n\n  describe('Analysis Status Management', () => {\n    it('updates analysis status when evaluation starts', () => {\n      const { rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { \n          initialProps: { ...defaultProps, isEvaluating: false }\n        }\n      );\n\n      // Start evaluating\n      rerender({ ...defaultProps, isEvaluating: true });\n\n      // Status should be updated in some way (hook manages internal state)\n      expect(mockTablebaseActions.setAnalysisStatus).toHaveBeenCalled();\n    });\n\n    it('clears analysis status when evaluation completes', () => {\n      const { rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { \n          initialProps: { ...defaultProps, isEvaluating: true }\n        }\n      );\n\n      // Complete evaluation\n      const mockResult = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        moves: [{ move: 'Kh1', wdl: 1 }],\n        isAvailable: true,\n      };\n\n      rerender({ \n        ...defaultProps, \n        isEvaluating: false,\n        lastEvaluation: mockResult,\n      });\n\n      expect(mockTablebaseActions.setAnalysisStatus).toHaveBeenCalled();\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('handles evaluation errors gracefully', () => {\n      const mockEvaluation = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        moves: [],\n        isAvailable: false,\n        error: 'Network error',\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: mockEvaluation,\n      };\n\n      expect(() => {\n        renderHook(() => useMoveValidation(props));\n      }).not.toThrow();\n    });\n\n    it('handles malformed evaluation data', () => {\n      const malformedEvaluation = {\n        // Missing required fields\n        moves: null,\n        isAvailable: true,\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: malformedEvaluation as any,\n      };\n\n      expect(() => {\n        renderHook(() => useMoveValidation(props));\n      }).not.toThrow();\n    });\n  });\n\n  describe('FEN Position Changes', () => {\n    it('reacts to FEN changes', () => {\n      const { rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { \n          initialProps: defaultProps\n        }\n      );\n\n      const newFen = '4k3/8/4K3/4P3/8/8/8/8 w - - 0 1';\n      rerender({ ...defaultProps, currentFen: newFen });\n\n      // Hook should handle FEN changes - this is a passive hook that processes data\n      // It may not directly call setAnalysisStatus, depending on implementation\n      expect(mockTablebaseActions.setAnalysisStatus).toHaveBeenCalledTimes(0);\n    });\n\n    it('validates FEN format correctly', () => {\n      const invalidFen = 'invalid-fen-string';\n      const props = {\n        ...defaultProps,\n        currentFen: invalidFen,\n      };\n\n      expect(() => {\n        renderHook(() => useMoveValidation(props));\n      }).not.toThrow();\n    });\n  });\n\n  describe('Evaluation History', () => {\n    it('processes evaluation history correctly', () => {\n      const evaluationHistory = [\n        { fen: '8/8/8/8/8/8/8/8 w - - 0 1', evaluation: 100 },\n        { fen: '4k3/8/4K3/4P3/8/8/8/8 b - - 1 1', evaluation: -50 },\n      ];\n\n      const props = {\n        ...defaultProps,\n        evaluations: evaluationHistory,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n\n    it('handles empty evaluation history', () => {\n      const props = {\n        ...defaultProps,\n        evaluations: [],\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n  });\n\n  describe('Tablebase State Integration', () => {\n    it('reads from tablebase state correctly', () => {\n      const tablebaseStateWithResults = {\n        ...mockTablebaseState,\n        analysisStatus: 'success' as const,\n        analysisResult: {\n          moves: [{ move: 'Kh1', wdl: 1, dtm: 3 }],\n        },\n      };\n\n      const props = {\n        ...defaultProps,\n        tablebaseState: tablebaseStateWithResults,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n\n    it('handles tablebase loading states', () => {\n      const loadingTablebaseState = {\n        ...mockTablebaseState,\n        analysisStatus: 'loading' as const,\n        analysisResult: null,\n      };\n\n      const props = {\n        ...defaultProps,\n        tablebaseState: loadingTablebaseState,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n\n    it('handles tablebase error states', () => {\n      const errorTablebaseState = {\n        ...mockTablebaseState,\n        analysisStatus: 'error' as const,\n        analysisResult: null,\n      };\n\n      const props = {\n        ...defaultProps,\n        tablebaseState: errorTablebaseState,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n  });\n\n  describe('Performance and Memory', () => {\n    it('maintains stable references between renders', () => {\n      const { result, rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { initialProps: defaultProps }\n      );\n\n      const initialResult = result.current;\n\n      // Re-render with same props\n      rerender(defaultProps);\n\n      // Should maintain reference stability where appropriate\n      expect(result.current).toBeDefined();\n    });\n\n    it('properly cleans up on unmount', () => {\n      const { unmount } = renderHook(() => useMoveValidation(defaultProps));\n\n      // Should not throw on unmount\n      expect(() => {\n        unmount();\n      }).not.toThrow();\n    });\n  });\n\n  describe('Complex Scenarios', () => {\n    it('handles rapid FEN changes', () => {\n      const { rerender } = renderHook(\n        (props) => useMoveValidation(props),\n        { initialProps: defaultProps }\n      );\n\n      // Rapidly change FENs\n      const fens = [\n        '8/8/8/8/8/8/8/8 w - - 0 1',\n        '4k3/8/4K3/4P3/8/8/8/8 w - - 0 1',\n        '4k3/8/4K3/8/4P3/8/8/8 b - - 1 1',\n      ];\n\n      fens.forEach(fen => {\n        rerender({ ...defaultProps, currentFen: fen });\n      });\n\n      // Should handle rapid changes gracefully - useMoveValidation is a passive processor\n      expect(mockTablebaseActions.setAnalysisStatus).toHaveBeenCalledTimes(0);\n    });\n\n    it('handles concurrent evaluation states', () => {\n      const props = {\n        ...defaultProps,\n        isEvaluating: true,\n        lastEvaluation: {\n          fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n          moves: [{ move: 'Kh1', wdl: 1 }],\n          isAvailable: true,\n        },\n      };\n\n      expect(() => {\n        renderHook(() => useMoveValidation(props));\n      }).not.toThrow();\n    });\n  });\n\n  describe('Integration with Other Hooks', () => {\n    it('works with evaluation data from usePositionAnalysis', () => {\n      const mockPositionAnalysisData = {\n        fen: '8/8/8/8/8/8/8/8 w - - 0 1',\n        moves: [\n          { move: 'Kh1', wdl: 1, dtm: 5, evaluation: 100 },\n          { move: 'Kg1', wdl: 0, dtm: 0, evaluation: 0 },\n        ],\n        isAvailable: true,\n        bestMove: 'Kh1',\n      };\n\n      const props = {\n        ...defaultProps,\n        lastEvaluation: mockPositionAnalysisData,\n        evaluations: [mockPositionAnalysisData],\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n\n    it('integrates with tablebase store state', () => {\n      const richTablebaseState = {\n        analysisStatus: 'success' as const,\n        analysisResult: {\n          position: '8/8/8/8/8/8/8/8 w - - 0 1',\n          moves: [\n            { move: 'Kh1', wdl: 1, dtm: 3 },\n            { move: 'Kg1', wdl: -1, dtm: 15 },\n          ],\n          bestMove: 'Kh1',\n        },\n        cache: new Map([\n          ['8/8/8/8/8/8/8/8 w - - 0 1', { wdl: 1, moves: ['Kh1'] }]\n        ]),\n      };\n\n      const props = {\n        ...defaultProps,\n        tablebaseState: richTablebaseState,\n      };\n\n      const { result } = renderHook(() => useMoveValidation(props));\n\n      expect(result.current).toBeDefined();\n    });\n  });\n});"],"names":["mockTablebaseActions","setAnalysisStatus","jest","fn","setAnalysisResult","mockTablebaseState","analysisStatus","analysisResult","cache","Map","describe","defaultProps","lastEvaluation","currentFen","evaluations","isEvaluating","tablebaseState","tablebaseActions","beforeEach","clearAllMocks","it","result","renderHook","useMoveValidation","expect","current","toBeDefined","propsWithMissingDeps","undefined","not","toThrow","mockEvaluation","fen","moves","move","wdl","dtm","isAvailable","props","error","rerender","initialProps","toHaveBeenCalled","mockResult","malformedEvaluation","newFen","toHaveBeenCalledTimes","invalidFen","evaluationHistory","evaluation","tablebaseStateWithResults","loadingTablebaseState","errorTablebaseState","initialResult","unmount","fens","forEach","mockPositionAnalysisData","bestMove","richTablebaseState","position"],"mappings":"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"}