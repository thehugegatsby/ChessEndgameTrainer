1222c216a6ea0db84edca599b8e99dc0
/**
 * @file Test scenario definitions for chess endgame training
 * @module testing/TestScenarios
 *
 * @description
 * Provides comprehensive test scenarios for chess endgame training with verified
 * positions from the Firebase database. Contains real training positions with
 * correct FEN strings, solutions, hints, and difficulty classifications.
 *
 * @remarks
 * Key features:
 * - Verified FEN positions from actual Firebase data
 * - Complete solutions with move sequences
 * - Progressive difficulty levels (beginner to intermediate)
 * - Bridge building technique scenarios (Zickzack, positioning, deflection)
 * - Opposition fundamentals for pawn endgames
 * - Conversion utilities between TestScenario and EndgamePosition types
 *
 * All positions have been tested and validated for correctness and include
 * realistic move targets and German language hints for training purposes.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get FenToPositionMap () {
        return FenToPositionMap;
    },
    get FenToScenarioMap () {
        return FenToScenarioMap;
    },
    get PositionIdMap () {
        return PositionIdMap;
    },
    get TestPositionUtils () {
        return TestPositionUtils;
    },
    get TestPositions () {
        return TestPositions;
    },
    get getPositionByPositionId () {
        return getPositionByPositionId;
    },
    get getScenarioByPositionId () {
        return getScenarioByPositionId;
    }
});
const TestPositions = {
    // Position 1: "Opposition Grundlagen" from Firebase
    // FEN: "4k3/8/4K3/4P3/8/8/8/8 w - - 0 1"
    // White K+P vs Black K, White to move, goal: win, mate in #11
    POSITION_1_OPPOSITION_BASICS: {
        id: "1",
        title: "Opposition Grundlagen",
        description: "Opposition Grundlagen - Lerne das fundamentale Konzept der Opposition in Bauernendspielen",
        fen: "4k3/8/4K3/4P3/8/8/8/8 w - - 0 1",
        category: "endgame",
        difficulty: "beginner",
        targetMoves: 11,
        sideToMove: "white",
        goal: "win",
        hints: [
            "Verwende die Opposition um den gegnerischen König zu verdrängen",
            "Kf6 oder Kd6 sind gleichwertige Züge",
            "Der Bauer auf e5 entscheidet das Spiel"
        ],
        solution: [
            "Kf6",
            "Kf8",
            "e6",
            "Ke8",
            "e7",
            "Kd7",
            "Kf7",
            "Kd6",
            "e8=Q",
            "Kd5",
            "Qe7",
            "mate"
        ]
    },
    // Position 9: "Zickzack-Technik" Brückenbau-Trainer (was 12)
    // FEN: "2K5/2P2k2/8/8/4R3/8/1r6/8 w - - 0 1"
    // White K+P+R vs Black K+R, White to move, goal: win using bridge technique
    POSITION_9_BRIDGE_ZICKZACK: {
        id: "9",
        title: "Zickzack-Technik",
        description: "König läuft im Zickzack nach vorne, Turm schützt von hinten",
        fen: "2K5/2P2k2/8/8/4R3/8/1r6/8 w - - 0 1",
        category: "endgame",
        difficulty: "beginner",
        targetMoves: 8,
        sideToMove: "white",
        goal: "win",
        hints: [
            "König läuft im Zickzack nach vorne",
            "Turm schützt von hinten",
            "Kd7, Kc6, Kb5 sind die Schlüsselzüge"
        ],
        solution: [
            "Kd7",
            "Kf8",
            "Kc6",
            "Ke7",
            "Kb5",
            "Kd6",
            "Re6+",
            "Kd5",
            "c8=Q"
        ]
    },
    // Position 10: "Turm positionieren" Brückenbau-Trainer (was 13)
    // FEN: "2K2k2/2P5/8/8/8/8/1r6/4R3 w - - 0 1"
    // White K+P+R vs Black K+R, White to move, goal: win by positioning rook first
    POSITION_10_BRIDGE_POSITIONING: {
        id: "10",
        title: "Turm positionieren",
        description: "Turm erst auf die 4. oder 5. Reihe bringen, dann Brücke bauen",
        fen: "2K2k2/2P5/8/8/8/8/1r6/4R3 w - - 0 1",
        category: "endgame",
        difficulty: "beginner",
        targetMoves: 10,
        sideToMove: "white",
        goal: "win",
        hints: [
            "Turm auf die 4. oder 5. Reihe positionieren",
            "Re4 oder Re5 sind gute Züge",
            "Dann normale Brückenbau-Technik anwenden"
        ],
        solution: [
            "Re4",
            "Kd8",
            "Kd7",
            "Kc8",
            "Kc6",
            "Kd8",
            "Kb5",
            "Kc7",
            "Re7+",
            "Kd6",
            "c8=Q"
        ]
    },
    // Position 11: "König abdrängen" Brückenbau-Trainer (was 14)
    // FEN: "2K1k3/2P5/8/8/8/8/1r6/7R w - - 0 1"
    // White K+P+R vs Black K+R, White to move, goal: win by deflecting king first
    POSITION_11_BRIDGE_DEFLECTION: {
        id: "11",
        title: "König abdrängen",
        description: "König steht noch zentral - erst abdrängen, dann Brücke bauen",
        fen: "2K1k3/2P5/8/8/8/8/1r6/7R w - - 0 1",
        category: "endgame",
        difficulty: "intermediate",
        targetMoves: 12,
        sideToMove: "white",
        goal: "win",
        hints: [
            "König mit einem Turmschach abdrängen",
            "Re1+ zwingt den König auf f8",
            "Dann Turm positionieren und Brücke bauen"
        ],
        solution: [
            "Re1+",
            "Kf8",
            "Re4",
            "Kf7",
            "Kd7",
            "Kf8",
            "Kc6",
            "Ke7",
            "Kb5",
            "Kd6",
            "Re6+",
            "Kd5",
            "c8=Q"
        ]
    }
};
/**
 *
 */ const PositionIdMap = new Map([
    [
        1,
        "POSITION_1_OPPOSITION_BASICS"
    ],
    [
        9,
        "POSITION_9_BRIDGE_ZICKZACK"
    ],
    [
        10,
        "POSITION_10_BRIDGE_POSITIONING"
    ],
    [
        11,
        "POSITION_11_BRIDGE_DEFLECTION"
    ]
]);
function getPositionByPositionId(positionId) {
    const positionKey = PositionIdMap.get(positionId);
    if (!positionKey) return null;
    const scenario = TestPositions[positionKey];
    // Convert TestScenario to EndgamePosition
    return {
        id: parseInt(scenario.id),
        title: scenario.title,
        description: scenario.description,
        fen: scenario.fen,
        category: scenario.category,
        difficulty: scenario.difficulty,
        targetMoves: scenario.targetMoves,
        hints: scenario.hints,
        solution: scenario.solution,
        sideToMove: scenario.sideToMove,
        goal: scenario.goal,
        nextPositionId: scenario.nextPositionId
    };
}
function getScenarioByPositionId(positionId) {
    const positionKey = PositionIdMap.get(positionId);
    if (!positionKey) return null;
    const position = TestPositions[positionKey];
    // Return the complete TestScenario (TestPositions already stores TestScenario objects)
    return position;
}
class TestPositionUtils {
    /**
   * Normalize a FEN string by removing move counters
   *
   * @param {string} fen - The FEN string to normalize
   * @returns {string} Normalized FEN string (first 4 parts only)
   *
   * @description
   * Removes halfmove and fullmove counters from FEN string for consistent
   * position comparison. Keeps only piece placement, active color, castling
   * availability, and en passant target square.
   *
   * @example
   * ```typescript
   * const normalized = TestPositionUtils.normalizeFen('rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1');
   * // Returns: 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq -'
   * ```
   */ static normalizeFen(fen) {
        const parts = fen.trim().split(/\s+/);
        if (parts.length >= 4) {
            return parts.slice(0, 4).join(" ");
        }
        return fen;
    }
    /**
   * Get endgame position by test position key
   *
   * @param {keyof typeof TestPositions} id - The test position key
   * @returns {EndgamePosition} The endgame position
   * @throws {Error} If the position is not found
   *
   * @description
   * Retrieves a test position by its key and converts from TestScenario
   * to EndgamePosition format. Throws an error if the position doesn't exist.
   *
   * @example
   * ```typescript
   * const position = TestPositionUtils.getPosition('POSITION_1_OPPOSITION_BASICS');
   * // Returns opposition fundamentals position
   * ```
   */ static getPosition(id) {
        const scenario = TestPositions[id];
        if (!scenario) {
            throw new Error(`Test position not found: ${id}`);
        }
        // Convert TestScenario to EndgamePosition
        return {
            id: parseInt(scenario.id),
            title: scenario.title,
            description: scenario.description,
            fen: scenario.fen,
            category: scenario.category,
            difficulty: scenario.difficulty,
            targetMoves: scenario.targetMoves,
            hints: scenario.hints,
            solution: scenario.solution,
            sideToMove: scenario.sideToMove,
            goal: scenario.goal,
            nextPositionId: scenario.nextPositionId
        };
    }
    /**
   * Get endgame position by FEN string
   *
   * @param {string} fen - The FEN string to match
   * @returns {EndgamePosition | null} The matching position or null if not found
   *
   * @description
   * Searches for a test position matching the given FEN string and returns
   * it as an EndgamePosition. Uses exact FEN matching for position lookup.
   *
   * @example
   * ```typescript
   * const position = TestPositionUtils.getPositionByFen('4k3/8/4K3/4P3/8/8/8/8 w - - 0 1');
   * // Returns opposition fundamentals position
   *
   * const notFound = TestPositionUtils.getPositionByFen('invalid-fen');
   * // Returns null
   * ```
   */ static getPositionByFen(fen) {
        const scenario = Object.values(TestPositions).find((position)=>position.fen === fen);
        if (!scenario) return null;
        // Convert TestScenario to EndgamePosition
        return {
            id: parseInt(scenario.id),
            title: scenario.title,
            description: scenario.description,
            fen: scenario.fen,
            category: scenario.category,
            difficulty: scenario.difficulty,
            targetMoves: scenario.targetMoves,
            hints: scenario.hints,
            solution: scenario.solution,
            sideToMove: scenario.sideToMove,
            goal: scenario.goal,
            nextPositionId: scenario.nextPositionId
        };
    }
}
/**
 *
 */ const FenToPositionMap = new Map(Object.values(TestPositions).map((scenario)=>[
        scenario.fen,
        {
            id: parseInt(scenario.id),
            title: scenario.title,
            description: scenario.description,
            fen: scenario.fen,
            category: scenario.category,
            difficulty: scenario.difficulty,
            targetMoves: scenario.targetMoves,
            hints: scenario.hints,
            solution: scenario.solution,
            sideToMove: scenario.sideToMove,
            goal: scenario.goal,
            nextPositionId: scenario.nextPositionId
        }
    ]));
/**
 *
 */ const FenToScenarioMap = new Map(Object.values(TestPositions).map((position)=>[
        position.fen,
        position
    ]));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3RoZWh1L2Nvb2xQcm9qZWN0cy9FbmRnYW1lVHJhaW5lci10cmFpbmluZy1ib2FyZC1jb21wbGV0ZS9zcmMvc2hhcmVkL3Rlc3RpbmcvVGVzdFNjZW5hcmlvcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIFRlc3Qgc2NlbmFyaW8gZGVmaW5pdGlvbnMgZm9yIGNoZXNzIGVuZGdhbWUgdHJhaW5pbmdcbiAqIEBtb2R1bGUgdGVzdGluZy9UZXN0U2NlbmFyaW9zXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBQcm92aWRlcyBjb21wcmVoZW5zaXZlIHRlc3Qgc2NlbmFyaW9zIGZvciBjaGVzcyBlbmRnYW1lIHRyYWluaW5nIHdpdGggdmVyaWZpZWRcbiAqIHBvc2l0aW9ucyBmcm9tIHRoZSBGaXJlYmFzZSBkYXRhYmFzZS4gQ29udGFpbnMgcmVhbCB0cmFpbmluZyBwb3NpdGlvbnMgd2l0aFxuICogY29ycmVjdCBGRU4gc3RyaW5ncywgc29sdXRpb25zLCBoaW50cywgYW5kIGRpZmZpY3VsdHkgY2xhc3NpZmljYXRpb25zLlxuICpcbiAqIEByZW1hcmtzXG4gKiBLZXkgZmVhdHVyZXM6XG4gKiAtIFZlcmlmaWVkIEZFTiBwb3NpdGlvbnMgZnJvbSBhY3R1YWwgRmlyZWJhc2UgZGF0YVxuICogLSBDb21wbGV0ZSBzb2x1dGlvbnMgd2l0aCBtb3ZlIHNlcXVlbmNlc1xuICogLSBQcm9ncmVzc2l2ZSBkaWZmaWN1bHR5IGxldmVscyAoYmVnaW5uZXIgdG8gaW50ZXJtZWRpYXRlKVxuICogLSBCcmlkZ2UgYnVpbGRpbmcgdGVjaG5pcXVlIHNjZW5hcmlvcyAoWmlja3phY2ssIHBvc2l0aW9uaW5nLCBkZWZsZWN0aW9uKVxuICogLSBPcHBvc2l0aW9uIGZ1bmRhbWVudGFscyBmb3IgcGF3biBlbmRnYW1lc1xuICogLSBDb252ZXJzaW9uIHV0aWxpdGllcyBiZXR3ZWVuIFRlc3RTY2VuYXJpbyBhbmQgRW5kZ2FtZVBvc2l0aW9uIHR5cGVzXG4gKlxuICogQWxsIHBvc2l0aW9ucyBoYXZlIGJlZW4gdGVzdGVkIGFuZCB2YWxpZGF0ZWQgZm9yIGNvcnJlY3RuZXNzIGFuZCBpbmNsdWRlXG4gKiByZWFsaXN0aWMgbW92ZSB0YXJnZXRzIGFuZCBHZXJtYW4gbGFuZ3VhZ2UgaGludHMgZm9yIHRyYWluaW5nIHB1cnBvc2VzLlxuICovXG5cbmltcG9ydCB7IEVuZGdhbWVQb3NpdGlvbiB9IGZyb20gXCJAc2hhcmVkL3R5cGVzL2VuZGdhbWVcIjtcblxuLy8gUkVNT1ZFRDogRW5naW5lTW92ZSBhbmQgVGVzdEludGVyYWN0aW9uIGludGVyZmFjZXNcbi8vIFRoZXNlIHdlcmUgdW51c2VkIGxlZ2FjeSBjb2RlLiBVc2UgVGFibGViYXNlTW92ZSBmcm9tIFRhYmxlYmFzZVNlcnZpY2UgaW5zdGVhZC5cblxuLy8gREVMRVRFRDogVGVzdFNjZW5hcmlvIGludGVyZmFjZSAtIHVzZSBFbmRnYW1lUG9zaXRpb24gaW5zdGVhZFxuLy8gSWYgeW91IG5lZWQgVGVzdFNjZW5hcmlvIGNvbXBhdGliaWxpdHksIHVzZSB0aGUgY29udmVyc2lvbiBmdW5jdGlvbnMgYmVsb3dcblxuLyoqXG4gKiBSZWFsIHRlc3QgcG9zaXRpb25zIGZyb20gRmlyZWJhc2UgZGF0YWJhc2VcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIENvbGxlY3Rpb24gb2YgdmVyaWZpZWQgY2hlc3MgZW5kZ2FtZSBwb3NpdGlvbnMgd2l0aCBjb21wbGV0ZSB0cmFpbmluZyBkYXRhLlxuICogRWFjaCBwb3NpdGlvbiBpbmNsdWRlcyBGRU4gc3RyaW5nLCBzb2x1dGlvbiBtb3ZlcywgaGludHMsIGFuZCBtZXRhZGF0YVxuICogcmVxdWlyZWQgZm9yIGNvbXByZWhlbnNpdmUgZW5kZ2FtZSB0cmFpbmluZyBzY2VuYXJpb3MuXG4gKlxuICogQHJlbWFya3NcbiAqIFBvc2l0aW9uIGNhdGVnb3JpZXM6XG4gKiAtIE9wcG9zaXRpb24gZnVuZGFtZW50YWxzIChraW5nIGFuZCBwYXduIGVuZGdhbWVzKVxuICogLSBCcmlkZ2UgYnVpbGRpbmcgdGVjaG5pcXVlcyAocm9vayBhbmQgcGF3biBlbmRnYW1lcylcbiAqIC0gWmlja3phY2sgdGVjaG5pcXVlIGZvciBraW5nIGFkdmFuY2VtZW50XG4gKiAtIFJvb2sgcG9zaXRpb25pbmcgYW5kIGRlZmxlY3Rpb24gc3RyYXRlZ2llc1xuICpcbiAqIEFsbCBwb3NpdGlvbnMgdXNlIHRoZSBUZXN0U2NlbmFyaW8gaW50ZXJmYWNlIHdoaWNoIGV4dGVuZHMgRW5kZ2FtZVBvc2l0aW9uXG4gKiB3aXRoIHN0cmluZyBJRHMgZm9yIHRlc3Qtc3BlY2lmaWMgY29tcGF0aWJpbGl0eS5cbiAqL1xuZXhwb3J0IGNvbnN0IFRlc3RQb3NpdGlvbnM6IFJlY29yZDxzdHJpbmcsIFRlc3RTY2VuYXJpbz4gPSB7XG4gIC8vIFBvc2l0aW9uIDE6IFwiT3Bwb3NpdGlvbiBHcnVuZGxhZ2VuXCIgZnJvbSBGaXJlYmFzZVxuICAvLyBGRU46IFwiNGszLzgvNEszLzRQMy84LzgvOC84IHcgLSAtIDAgMVwiXG4gIC8vIFdoaXRlIEsrUCB2cyBCbGFjayBLLCBXaGl0ZSB0byBtb3ZlLCBnb2FsOiB3aW4sIG1hdGUgaW4gIzExXG4gIFBPU0lUSU9OXzFfT1BQT1NJVElPTl9CQVNJQ1M6IHtcbiAgICBpZDogXCIxXCIsIC8vIFRlc3RTY2VuYXJpbyB1c2VzIHN0cmluZyBJRHNcbiAgICB0aXRsZTogXCJPcHBvc2l0aW9uIEdydW5kbGFnZW5cIixcbiAgICBkZXNjcmlwdGlvbjpcbiAgICAgIFwiT3Bwb3NpdGlvbiBHcnVuZGxhZ2VuIC0gTGVybmUgZGFzIGZ1bmRhbWVudGFsZSBLb256ZXB0IGRlciBPcHBvc2l0aW9uIGluIEJhdWVybmVuZHNwaWVsZW5cIixcbiAgICBmZW46IFwiNGszLzgvNEszLzRQMy84LzgvOC84IHcgLSAtIDAgMVwiLCAvLyBSRUFMIEZFTiBmcm9tIEZpcmViYXNlXG4gICAgY2F0ZWdvcnk6IFwiZW5kZ2FtZVwiLFxuICAgIGRpZmZpY3VsdHk6IFwiYmVnaW5uZXJcIixcbiAgICB0YXJnZXRNb3ZlczogMTEsIC8vIE1hdGUgaW4gMTEgbW92ZXNcbiAgICBzaWRlVG9Nb3ZlOiBcIndoaXRlXCIsXG4gICAgZ29hbDogXCJ3aW5cIixcbiAgICBoaW50czogW1xuICAgICAgXCJWZXJ3ZW5kZSBkaWUgT3Bwb3NpdGlvbiB1bSBkZW4gZ2VnbmVyaXNjaGVuIEvDtm5pZyB6dSB2ZXJkcsOkbmdlblwiLFxuICAgICAgXCJLZjYgb2RlciBLZDYgc2luZCBnbGVpY2h3ZXJ0aWdlIFrDvGdlXCIsXG4gICAgICBcIkRlciBCYXVlciBhdWYgZTUgZW50c2NoZWlkZXQgZGFzIFNwaWVsXCIsXG4gICAgXSxcbiAgICBzb2x1dGlvbjogW1xuICAgICAgXCJLZjZcIixcbiAgICAgIFwiS2Y4XCIsXG4gICAgICBcImU2XCIsXG4gICAgICBcIktlOFwiLFxuICAgICAgXCJlN1wiLFxuICAgICAgXCJLZDdcIixcbiAgICAgIFwiS2Y3XCIsXG4gICAgICBcIktkNlwiLFxuICAgICAgXCJlOD1RXCIsXG4gICAgICBcIktkNVwiLFxuICAgICAgXCJRZTdcIixcbiAgICAgIFwibWF0ZVwiLFxuICAgIF0sXG4gICAgLy8gbmV4dFBvc2l0aW9uSWQgaXMgb21pdHRlZCAodW5kZWZpbmVkKSBmb3IgSlNPTiBzZXJpYWxpemF0aW9uIGNvbXBhdGliaWxpdHlcbiAgfSxcblxuICAvLyBQb3NpdGlvbiA5OiBcIlppY2t6YWNrLVRlY2huaWtcIiBCcsO8Y2tlbmJhdS1UcmFpbmVyICh3YXMgMTIpXG4gIC8vIEZFTjogXCIySzUvMlAyazIvOC84LzRSMy84LzFyNi84IHcgLSAtIDAgMVwiXG4gIC8vIFdoaXRlIEsrUCtSIHZzIEJsYWNrIEsrUiwgV2hpdGUgdG8gbW92ZSwgZ29hbDogd2luIHVzaW5nIGJyaWRnZSB0ZWNobmlxdWVcbiAgUE9TSVRJT05fOV9CUklER0VfWklDS1pBQ0s6IHtcbiAgICBpZDogXCI5XCIsIC8vIFRlc3RTY2VuYXJpbyB1c2VzIHN0cmluZyBJRHNcbiAgICB0aXRsZTogXCJaaWNremFjay1UZWNobmlrXCIsXG4gICAgZGVzY3JpcHRpb246IFwiS8O2bmlnIGzDpHVmdCBpbSBaaWNremFjayBuYWNoIHZvcm5lLCBUdXJtIHNjaMO8dHp0IHZvbiBoaW50ZW5cIixcbiAgICBmZW46IFwiMks1LzJQMmsyLzgvOC80UjMvOC8xcjYvOCB3IC0gLSAwIDFcIiwgLy8gRnJvbSBob21lcGFnZSBicmlkZ2VUcmFpbmVyTGVzc29uc1xuICAgIGNhdGVnb3J5OiBcImVuZGdhbWVcIixcbiAgICBkaWZmaWN1bHR5OiBcImJlZ2lubmVyXCIsXG4gICAgdGFyZ2V0TW92ZXM6IDgsIC8vIEVzdGltYXRlZCBtb3ZlcyB0byB3aW5cbiAgICBzaWRlVG9Nb3ZlOiBcIndoaXRlXCIsXG4gICAgZ29hbDogXCJ3aW5cIixcbiAgICBoaW50czogW1xuICAgICAgXCJLw7ZuaWcgbMOkdWZ0IGltIFppY2t6YWNrIG5hY2ggdm9ybmVcIixcbiAgICAgIFwiVHVybSBzY2jDvHR6dCB2b24gaGludGVuXCIsXG4gICAgICBcIktkNywgS2M2LCBLYjUgc2luZCBkaWUgU2NobMO8c3NlbHrDvGdlXCIsXG4gICAgXSxcbiAgICBzb2x1dGlvbjogW1wiS2Q3XCIsIFwiS2Y4XCIsIFwiS2M2XCIsIFwiS2U3XCIsIFwiS2I1XCIsIFwiS2Q2XCIsIFwiUmU2K1wiLCBcIktkNVwiLCBcImM4PVFcIl0sXG4gIH0sXG5cbiAgLy8gUG9zaXRpb24gMTA6IFwiVHVybSBwb3NpdGlvbmllcmVuXCIgQnLDvGNrZW5iYXUtVHJhaW5lciAod2FzIDEzKVxuICAvLyBGRU46IFwiMksyazIvMlA1LzgvOC84LzgvMXI2LzRSMyB3IC0gLSAwIDFcIlxuICAvLyBXaGl0ZSBLK1ArUiB2cyBCbGFjayBLK1IsIFdoaXRlIHRvIG1vdmUsIGdvYWw6IHdpbiBieSBwb3NpdGlvbmluZyByb29rIGZpcnN0XG4gIFBPU0lUSU9OXzEwX0JSSURHRV9QT1NJVElPTklORzoge1xuICAgIGlkOiBcIjEwXCIsIC8vIFRlc3RTY2VuYXJpbyB1c2VzIHN0cmluZyBJRHNcbiAgICB0aXRsZTogXCJUdXJtIHBvc2l0aW9uaWVyZW5cIixcbiAgICBkZXNjcmlwdGlvbjpcbiAgICAgIFwiVHVybSBlcnN0IGF1ZiBkaWUgNC4gb2RlciA1LiBSZWloZSBicmluZ2VuLCBkYW5uIEJyw7xja2UgYmF1ZW5cIixcbiAgICBmZW46IFwiMksyazIvMlA1LzgvOC84LzgvMXI2LzRSMyB3IC0gLSAwIDFcIiwgLy8gRnJvbSBob21lcGFnZSBicmlkZ2VUcmFpbmVyTGVzc29uc1xuICAgIGNhdGVnb3J5OiBcImVuZGdhbWVcIixcbiAgICBkaWZmaWN1bHR5OiBcImJlZ2lubmVyXCIsXG4gICAgdGFyZ2V0TW92ZXM6IDEwLCAvLyBFc3RpbWF0ZWQgbW92ZXMgdG8gd2luXG4gICAgc2lkZVRvTW92ZTogXCJ3aGl0ZVwiLFxuICAgIGdvYWw6IFwid2luXCIsXG4gICAgaGludHM6IFtcbiAgICAgIFwiVHVybSBhdWYgZGllIDQuIG9kZXIgNS4gUmVpaGUgcG9zaXRpb25pZXJlblwiLFxuICAgICAgXCJSZTQgb2RlciBSZTUgc2luZCBndXRlIFrDvGdlXCIsXG4gICAgICBcIkRhbm4gbm9ybWFsZSBCcsO8Y2tlbmJhdS1UZWNobmlrIGFud2VuZGVuXCIsXG4gICAgXSxcbiAgICBzb2x1dGlvbjogW1xuICAgICAgXCJSZTRcIixcbiAgICAgIFwiS2Q4XCIsXG4gICAgICBcIktkN1wiLFxuICAgICAgXCJLYzhcIixcbiAgICAgIFwiS2M2XCIsXG4gICAgICBcIktkOFwiLFxuICAgICAgXCJLYjVcIixcbiAgICAgIFwiS2M3XCIsXG4gICAgICBcIlJlNytcIixcbiAgICAgIFwiS2Q2XCIsXG4gICAgICBcImM4PVFcIixcbiAgICBdLFxuICB9LFxuXG4gIC8vIFBvc2l0aW9uIDExOiBcIkvDtm5pZyBhYmRyw6RuZ2VuXCIgQnLDvGNrZW5iYXUtVHJhaW5lciAod2FzIDE0KVxuICAvLyBGRU46IFwiMksxazMvMlA1LzgvOC84LzgvMXI2LzdSIHcgLSAtIDAgMVwiXG4gIC8vIFdoaXRlIEsrUCtSIHZzIEJsYWNrIEsrUiwgV2hpdGUgdG8gbW92ZSwgZ29hbDogd2luIGJ5IGRlZmxlY3Rpbmcga2luZyBmaXJzdFxuICBQT1NJVElPTl8xMV9CUklER0VfREVGTEVDVElPTjoge1xuICAgIGlkOiBcIjExXCIsIC8vIFRlc3RTY2VuYXJpbyB1c2VzIHN0cmluZyBJRHNcbiAgICB0aXRsZTogXCJLw7ZuaWcgYWJkcsOkbmdlblwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkvDtm5pZyBzdGVodCBub2NoIHplbnRyYWwgLSBlcnN0IGFiZHLDpG5nZW4sIGRhbm4gQnLDvGNrZSBiYXVlblwiLFxuICAgIGZlbjogXCIySzFrMy8yUDUvOC84LzgvOC8xcjYvN1IgdyAtIC0gMCAxXCIsIC8vIEZyb20gaG9tZXBhZ2UgYnJpZGdlVHJhaW5lckxlc3NvbnNcbiAgICBjYXRlZ29yeTogXCJlbmRnYW1lXCIsXG4gICAgZGlmZmljdWx0eTogXCJpbnRlcm1lZGlhdGVcIixcbiAgICB0YXJnZXRNb3ZlczogMTIsIC8vIEVzdGltYXRlZCBtb3ZlcyB0byB3aW5cbiAgICBzaWRlVG9Nb3ZlOiBcIndoaXRlXCIsXG4gICAgZ29hbDogXCJ3aW5cIixcbiAgICBoaW50czogW1xuICAgICAgXCJLw7ZuaWcgbWl0IGVpbmVtIFR1cm1zY2hhY2ggYWJkcsOkbmdlblwiLFxuICAgICAgXCJSZTErIHp3aW5ndCBkZW4gS8O2bmlnIGF1ZiBmOFwiLFxuICAgICAgXCJEYW5uIFR1cm0gcG9zaXRpb25pZXJlbiB1bmQgQnLDvGNrZSBiYXVlblwiLFxuICAgIF0sXG4gICAgc29sdXRpb246IFtcbiAgICAgIFwiUmUxK1wiLFxuICAgICAgXCJLZjhcIixcbiAgICAgIFwiUmU0XCIsXG4gICAgICBcIktmN1wiLFxuICAgICAgXCJLZDdcIixcbiAgICAgIFwiS2Y4XCIsXG4gICAgICBcIktjNlwiLFxuICAgICAgXCJLZTdcIixcbiAgICAgIFwiS2I1XCIsXG4gICAgICBcIktkNlwiLFxuICAgICAgXCJSZTYrXCIsXG4gICAgICBcIktkNVwiLFxuICAgICAgXCJjOD1RXCIsXG4gICAgXSxcbiAgfSxcbn07XG5cbi8qKlxuICogTGVnYWN5IHBvc2l0aW9uIElEIG1hcHBpbmdcbiAqL1xuZXhwb3J0IC8qKlxuICpcbiAqL1xuY29uc3QgUG9zaXRpb25JZE1hcCA9IG5ldyBNYXA8bnVtYmVyLCBrZXlvZiB0eXBlb2YgVGVzdFBvc2l0aW9ucz4oW1xuICBbMSwgXCJQT1NJVElPTl8xX09QUE9TSVRJT05fQkFTSUNTXCJdLFxuICBbOSwgXCJQT1NJVElPTl85X0JSSURHRV9aSUNLWkFDS1wiXSwgLy8gV2FzIDEyXG4gIFsxMCwgXCJQT1NJVElPTl8xMF9CUklER0VfUE9TSVRJT05JTkdcIl0sIC8vIFdhcyAxM1xuICBbMTEsIFwiUE9TSVRJT05fMTFfQlJJREdFX0RFRkxFQ1RJT05cIl0sIC8vIFdhcyAxNFxuXSk7XG5cbi8qKlxuICogR2V0IHRlc3QgcG9zaXRpb24gYnkgbGVnYWN5IHBvc2l0aW9uIElEXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IHBvc2l0aW9uSWQgLSBUaGUgbnVtZXJpYyBwb3NpdGlvbiBJRCB0byBsb29rIHVwXG4gKiBAcmV0dXJucyB7RW5kZ2FtZVBvc2l0aW9uIHwgbnVsbH0gVGhlIGVuZGdhbWUgcG9zaXRpb24gb3IgbnVsbCBpZiBub3QgZm91bmRcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIENvbnZlcnRzIFRlc3RTY2VuYXJpbyB0byBFbmRnYW1lUG9zaXRpb24gYnkgcmVtb3ZpbmcgdGVzdC1zcGVjaWZpYyBmaWVsZHNcbiAqIGFuZCB0cmFuc2Zvcm1pbmcgc3RyaW5nIElEIHRvIG51bWVyaWMgSUQuIFByb3ZpZGVzIGNvbXBhdGliaWxpdHkgd2l0aFxuICogbGVnYWN5IHBvc2l0aW9uIElEIG1hcHBpbmcgc3lzdGVtLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBwb3NpdGlvbiA9IGdldFBvc2l0aW9uQnlQb3NpdGlvbklkKDEpO1xuICogLy8gUmV0dXJucyBwb3NpdGlvbiB3aXRoIG9wcG9zaXRpb24gZnVuZGFtZW50YWxzXG4gKlxuICogY29uc3QgdW5rbm93biA9IGdldFBvc2l0aW9uQnlQb3NpdGlvbklkKDk5OSk7XG4gKiAvLyBSZXR1cm5zIG51bGxcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UG9zaXRpb25CeVBvc2l0aW9uSWQoXG4gIHBvc2l0aW9uSWQ6IG51bWJlcixcbik6IEVuZGdhbWVQb3NpdGlvbiB8IG51bGwge1xuICBjb25zdCBwb3NpdGlvbktleSA9IFBvc2l0aW9uSWRNYXAuZ2V0KHBvc2l0aW9uSWQpO1xuICBpZiAoIXBvc2l0aW9uS2V5KSByZXR1cm4gbnVsbDtcblxuICBjb25zdCBzY2VuYXJpbyA9IFRlc3RQb3NpdGlvbnNbcG9zaXRpb25LZXldO1xuICAvLyBDb252ZXJ0IFRlc3RTY2VuYXJpbyB0byBFbmRnYW1lUG9zaXRpb25cbiAgcmV0dXJuIHtcbiAgICBpZDogcGFyc2VJbnQoc2NlbmFyaW8uaWQpLFxuICAgIHRpdGxlOiBzY2VuYXJpby50aXRsZSxcbiAgICBkZXNjcmlwdGlvbjogc2NlbmFyaW8uZGVzY3JpcHRpb24sXG4gICAgZmVuOiBzY2VuYXJpby5mZW4sXG4gICAgY2F0ZWdvcnk6IHNjZW5hcmlvLmNhdGVnb3J5LFxuICAgIGRpZmZpY3VsdHk6IHNjZW5hcmlvLmRpZmZpY3VsdHksXG4gICAgdGFyZ2V0TW92ZXM6IHNjZW5hcmlvLnRhcmdldE1vdmVzLFxuICAgIGhpbnRzOiBzY2VuYXJpby5oaW50cyxcbiAgICBzb2x1dGlvbjogc2NlbmFyaW8uc29sdXRpb24sXG4gICAgc2lkZVRvTW92ZTogc2NlbmFyaW8uc2lkZVRvTW92ZSxcbiAgICBnb2FsOiBzY2VuYXJpby5nb2FsLFxuICAgIG5leHRQb3NpdGlvbklkOiBzY2VuYXJpby5uZXh0UG9zaXRpb25JZCxcbiAgfTtcbn1cblxuLyoqXG4gKiBUZXN0LXNwZWNpZmljIHNjZW5hcmlvIGludGVyZmFjZVxuICpcbiAqIEBpbnRlcmZhY2UgVGVzdFNjZW5hcmlvXG4gKiBAZXh0ZW5kcyB7T21pdDxFbmRnYW1lUG9zaXRpb24sIFwiaWRcIj59XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBFeHRlbmRlZCB2ZXJzaW9uIG9mIEVuZGdhbWVQb3NpdGlvbiB0aGF0IHVzZXMgc3RyaW5nIElEcyBpbnN0ZWFkIG9mIG51bWVyaWMgSURzXG4gKiBmb3IgdGVzdCBzY2VuYXJpbyBjb21wYXRpYmlsaXR5LiBQcm92aWRlcyBzYW1lIGZ1bmN0aW9uYWxpdHkgYXMgRW5kZ2FtZVBvc2l0aW9uXG4gKiBidXQgd2l0aCB0ZXN0LWZyaWVuZGx5IHN0cmluZyBpZGVudGlmaWVycy5cbiAqXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBTdHJpbmcgaWRlbnRpZmllciBmb3IgdGVzdCBzY2VuYXJpb3MgKG92ZXJyaWRlcyBudW1lcmljIElEKVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFRlc3RTY2VuYXJpbyBleHRlbmRzIE9taXQ8RW5kZ2FtZVBvc2l0aW9uLCBcImlkXCI+IHtcbiAgaWQ6IHN0cmluZzsgLy8gT3ZlcnJpZGUgdG8gYmUgc3RyaW5nIGZvciB0ZXN0IHNjZW5hcmlvc1xufVxuXG4vKipcbiAqIEdldCB0ZXN0IHNjZW5hcmlvIGJ5IGxlZ2FjeSBwb3NpdGlvbiBJRCAoREVQUkVDQVRFRCAtIHVzZSBnZXRQb3NpdGlvbkJ5UG9zaXRpb25JZClcbiAqIEBwYXJhbSBwb3NpdGlvbklkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTY2VuYXJpb0J5UG9zaXRpb25JZChcbiAgcG9zaXRpb25JZDogbnVtYmVyLFxuKTogVGVzdFNjZW5hcmlvIHwgbnVsbCB7XG4gIGNvbnN0IHBvc2l0aW9uS2V5ID0gUG9zaXRpb25JZE1hcC5nZXQocG9zaXRpb25JZCk7XG4gIGlmICghcG9zaXRpb25LZXkpIHJldHVybiBudWxsO1xuICBjb25zdCBwb3NpdGlvbiA9IFRlc3RQb3NpdGlvbnNbcG9zaXRpb25LZXldO1xuXG4gIC8vIFJldHVybiB0aGUgY29tcGxldGUgVGVzdFNjZW5hcmlvIChUZXN0UG9zaXRpb25zIGFscmVhZHkgc3RvcmVzIFRlc3RTY2VuYXJpbyBvYmplY3RzKVxuICByZXR1cm4gcG9zaXRpb247XG59XG5cbi8qKlxuICogVXRpbGl0eSBmdW5jdGlvbnMgZm9yIHRlc3QgcG9zaXRpb24gbWFuYWdlbWVudFxuICpcbiAqIEBjbGFzcyBUZXN0UG9zaXRpb25VdGlsc1xuICogQGRlc2NyaXB0aW9uXG4gKiBQcm92aWRlcyBzdGF0aWMgdXRpbGl0eSBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGVzdCBwb3NpdGlvbnMgYW5kIHNjZW5hcmlvcy5cbiAqIEluY2x1ZGVzIEZFTiBub3JtYWxpemF0aW9uLCBwb3NpdGlvbiBsb29rdXAgYnkgSUQgb3IgRkVOLCBhbmQgY29udmVyc2lvblxuICogYmV0d2VlbiBUZXN0U2NlbmFyaW8gYW5kIEVuZGdhbWVQb3NpdGlvbiBmb3JtYXRzLlxuICovXG5leHBvcnQgY2xhc3MgVGVzdFBvc2l0aW9uVXRpbHMge1xuICAvKipcbiAgICogTm9ybWFsaXplIGEgRkVOIHN0cmluZyBieSByZW1vdmluZyBtb3ZlIGNvdW50ZXJzXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBmZW4gLSBUaGUgRkVOIHN0cmluZyB0byBub3JtYWxpemVcbiAgICogQHJldHVybnMge3N0cmluZ30gTm9ybWFsaXplZCBGRU4gc3RyaW5nIChmaXJzdCA0IHBhcnRzIG9ubHkpXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBSZW1vdmVzIGhhbGZtb3ZlIGFuZCBmdWxsbW92ZSBjb3VudGVycyBmcm9tIEZFTiBzdHJpbmcgZm9yIGNvbnNpc3RlbnRcbiAgICogcG9zaXRpb24gY29tcGFyaXNvbi4gS2VlcHMgb25seSBwaWVjZSBwbGFjZW1lbnQsIGFjdGl2ZSBjb2xvciwgY2FzdGxpbmdcbiAgICogYXZhaWxhYmlsaXR5LCBhbmQgZW4gcGFzc2FudCB0YXJnZXQgc3F1YXJlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IG5vcm1hbGl6ZWQgPSBUZXN0UG9zaXRpb25VdGlscy5ub3JtYWxpemVGZW4oJ3JuYnFrYm5yL3BwcHBwcHBwLzgvOC84LzgvUFBQUFBQUFAvUk5CUUtCTlIgdyBLUWtxIC0gMCAxJyk7XG4gICAqIC8vIFJldHVybnM6ICdybmJxa2Juci9wcHBwcHBwcC84LzgvOC84L1BQUFBQUFBQL1JOQlFLQk5SIHcgS1FrcSAtJ1xuICAgKiBgYGBcbiAgICovXG4gIHN0YXRpYyBub3JtYWxpemVGZW4oZmVuOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHBhcnRzID0gZmVuLnRyaW0oKS5zcGxpdCgvXFxzKy8pO1xuICAgIGlmIChwYXJ0cy5sZW5ndGggPj0gNCkge1xuICAgICAgcmV0dXJuIHBhcnRzLnNsaWNlKDAsIDQpLmpvaW4oXCIgXCIpO1xuICAgIH1cbiAgICByZXR1cm4gZmVuO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBlbmRnYW1lIHBvc2l0aW9uIGJ5IHRlc3QgcG9zaXRpb24ga2V5XG4gICAqXG4gICAqIEBwYXJhbSB7a2V5b2YgdHlwZW9mIFRlc3RQb3NpdGlvbnN9IGlkIC0gVGhlIHRlc3QgcG9zaXRpb24ga2V5XG4gICAqIEByZXR1cm5zIHtFbmRnYW1lUG9zaXRpb259IFRoZSBlbmRnYW1lIHBvc2l0aW9uXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgcG9zaXRpb24gaXMgbm90IGZvdW5kXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBSZXRyaWV2ZXMgYSB0ZXN0IHBvc2l0aW9uIGJ5IGl0cyBrZXkgYW5kIGNvbnZlcnRzIGZyb20gVGVzdFNjZW5hcmlvXG4gICAqIHRvIEVuZGdhbWVQb3NpdGlvbiBmb3JtYXQuIFRocm93cyBhbiBlcnJvciBpZiB0aGUgcG9zaXRpb24gZG9lc24ndCBleGlzdC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBjb25zdCBwb3NpdGlvbiA9IFRlc3RQb3NpdGlvblV0aWxzLmdldFBvc2l0aW9uKCdQT1NJVElPTl8xX09QUE9TSVRJT05fQkFTSUNTJyk7XG4gICAqIC8vIFJldHVybnMgb3Bwb3NpdGlvbiBmdW5kYW1lbnRhbHMgcG9zaXRpb25cbiAgICogYGBgXG4gICAqL1xuICBzdGF0aWMgZ2V0UG9zaXRpb24oaWQ6IGtleW9mIHR5cGVvZiBUZXN0UG9zaXRpb25zKTogRW5kZ2FtZVBvc2l0aW9uIHtcbiAgICBjb25zdCBzY2VuYXJpbyA9IFRlc3RQb3NpdGlvbnNbaWRdO1xuICAgIGlmICghc2NlbmFyaW8pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGVzdCBwb3NpdGlvbiBub3QgZm91bmQ6ICR7aWR9YCk7XG4gICAgfVxuXG4gICAgLy8gQ29udmVydCBUZXN0U2NlbmFyaW8gdG8gRW5kZ2FtZVBvc2l0aW9uXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBwYXJzZUludChzY2VuYXJpby5pZCksXG4gICAgICB0aXRsZTogc2NlbmFyaW8udGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbjogc2NlbmFyaW8uZGVzY3JpcHRpb24sXG4gICAgICBmZW46IHNjZW5hcmlvLmZlbixcbiAgICAgIGNhdGVnb3J5OiBzY2VuYXJpby5jYXRlZ29yeSxcbiAgICAgIGRpZmZpY3VsdHk6IHNjZW5hcmlvLmRpZmZpY3VsdHksXG4gICAgICB0YXJnZXRNb3Zlczogc2NlbmFyaW8udGFyZ2V0TW92ZXMsXG4gICAgICBoaW50czogc2NlbmFyaW8uaGludHMsXG4gICAgICBzb2x1dGlvbjogc2NlbmFyaW8uc29sdXRpb24sXG4gICAgICBzaWRlVG9Nb3ZlOiBzY2VuYXJpby5zaWRlVG9Nb3ZlLFxuICAgICAgZ29hbDogc2NlbmFyaW8uZ29hbCxcbiAgICAgIG5leHRQb3NpdGlvbklkOiBzY2VuYXJpby5uZXh0UG9zaXRpb25JZCxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBlbmRnYW1lIHBvc2l0aW9uIGJ5IEZFTiBzdHJpbmdcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZlbiAtIFRoZSBGRU4gc3RyaW5nIHRvIG1hdGNoXG4gICAqIEByZXR1cm5zIHtFbmRnYW1lUG9zaXRpb24gfCBudWxsfSBUaGUgbWF0Y2hpbmcgcG9zaXRpb24gb3IgbnVsbCBpZiBub3QgZm91bmRcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFNlYXJjaGVzIGZvciBhIHRlc3QgcG9zaXRpb24gbWF0Y2hpbmcgdGhlIGdpdmVuIEZFTiBzdHJpbmcgYW5kIHJldHVybnNcbiAgICogaXQgYXMgYW4gRW5kZ2FtZVBvc2l0aW9uLiBVc2VzIGV4YWN0IEZFTiBtYXRjaGluZyBmb3IgcG9zaXRpb24gbG9va3VwLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IHBvc2l0aW9uID0gVGVzdFBvc2l0aW9uVXRpbHMuZ2V0UG9zaXRpb25CeUZlbignNGszLzgvNEszLzRQMy84LzgvOC84IHcgLSAtIDAgMScpO1xuICAgKiAvLyBSZXR1cm5zIG9wcG9zaXRpb24gZnVuZGFtZW50YWxzIHBvc2l0aW9uXG4gICAqXG4gICAqIGNvbnN0IG5vdEZvdW5kID0gVGVzdFBvc2l0aW9uVXRpbHMuZ2V0UG9zaXRpb25CeUZlbignaW52YWxpZC1mZW4nKTtcbiAgICogLy8gUmV0dXJucyBudWxsXG4gICAqIGBgYFxuICAgKi9cbiAgc3RhdGljIGdldFBvc2l0aW9uQnlGZW4oZmVuOiBzdHJpbmcpOiBFbmRnYW1lUG9zaXRpb24gfCBudWxsIHtcbiAgICBjb25zdCBzY2VuYXJpbyA9IE9iamVjdC52YWx1ZXMoVGVzdFBvc2l0aW9ucykuZmluZChcbiAgICAgIChwb3NpdGlvbikgPT4gcG9zaXRpb24uZmVuID09PSBmZW4sXG4gICAgKTtcbiAgICBpZiAoIXNjZW5hcmlvKSByZXR1cm4gbnVsbDtcblxuICAgIC8vIENvbnZlcnQgVGVzdFNjZW5hcmlvIHRvIEVuZGdhbWVQb3NpdGlvblxuICAgIHJldHVybiB7XG4gICAgICBpZDogcGFyc2VJbnQoc2NlbmFyaW8uaWQpLFxuICAgICAgdGl0bGU6IHNjZW5hcmlvLnRpdGxlLFxuICAgICAgZGVzY3JpcHRpb246IHNjZW5hcmlvLmRlc2NyaXB0aW9uLFxuICAgICAgZmVuOiBzY2VuYXJpby5mZW4sXG4gICAgICBjYXRlZ29yeTogc2NlbmFyaW8uY2F0ZWdvcnksXG4gICAgICBkaWZmaWN1bHR5OiBzY2VuYXJpby5kaWZmaWN1bHR5LFxuICAgICAgdGFyZ2V0TW92ZXM6IHNjZW5hcmlvLnRhcmdldE1vdmVzLFxuICAgICAgaGludHM6IHNjZW5hcmlvLmhpbnRzLFxuICAgICAgc29sdXRpb246IHNjZW5hcmlvLnNvbHV0aW9uLFxuICAgICAgc2lkZVRvTW92ZTogc2NlbmFyaW8uc2lkZVRvTW92ZSxcbiAgICAgIGdvYWw6IHNjZW5hcmlvLmdvYWwsXG4gICAgICBuZXh0UG9zaXRpb25JZDogc2NlbmFyaW8ubmV4dFBvc2l0aW9uSWQsXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFJldmVyc2UgbG9va3VwIG1hcCBmb3IgZmFzdCBGRU4tdG8tcG9zaXRpb24gbWFwcGluZ1xuICovXG5leHBvcnQgLyoqXG4gKlxuICovXG5jb25zdCBGZW5Ub1Bvc2l0aW9uTWFwID0gbmV3IE1hcDxzdHJpbmcsIEVuZGdhbWVQb3NpdGlvbj4oXG4gIE9iamVjdC52YWx1ZXMoVGVzdFBvc2l0aW9ucykubWFwKChzY2VuYXJpbykgPT4gW1xuICAgIHNjZW5hcmlvLmZlbixcbiAgICB7XG4gICAgICBpZDogcGFyc2VJbnQoc2NlbmFyaW8uaWQpLFxuICAgICAgdGl0bGU6IHNjZW5hcmlvLnRpdGxlLFxuICAgICAgZGVzY3JpcHRpb246IHNjZW5hcmlvLmRlc2NyaXB0aW9uLFxuICAgICAgZmVuOiBzY2VuYXJpby5mZW4sXG4gICAgICBjYXRlZ29yeTogc2NlbmFyaW8uY2F0ZWdvcnksXG4gICAgICBkaWZmaWN1bHR5OiBzY2VuYXJpby5kaWZmaWN1bHR5LFxuICAgICAgdGFyZ2V0TW92ZXM6IHNjZW5hcmlvLnRhcmdldE1vdmVzLFxuICAgICAgaGludHM6IHNjZW5hcmlvLmhpbnRzLFxuICAgICAgc29sdXRpb246IHNjZW5hcmlvLnNvbHV0aW9uLFxuICAgICAgc2lkZVRvTW92ZTogc2NlbmFyaW8uc2lkZVRvTW92ZSxcbiAgICAgIGdvYWw6IHNjZW5hcmlvLmdvYWwsXG4gICAgICBuZXh0UG9zaXRpb25JZDogc2NlbmFyaW8ubmV4dFBvc2l0aW9uSWQsXG4gICAgfSxcbiAgXSksXG4pO1xuXG4vKipcbiAqIFJldmVyc2UgbG9va3VwIG1hcCBmb3IgZmFzdCBGRU4tdG8tc2NlbmFyaW8gbWFwcGluZyAoREVQUkVDQVRFRCAtIHVzZSBGZW5Ub1Bvc2l0aW9uTWFwKVxuICovXG5leHBvcnQgLyoqXG4gKlxuICovXG5jb25zdCBGZW5Ub1NjZW5hcmlvTWFwID0gbmV3IE1hcDxzdHJpbmcsIFRlc3RTY2VuYXJpbz4oXG4gIE9iamVjdC52YWx1ZXMoVGVzdFBvc2l0aW9ucykubWFwKChwb3NpdGlvbikgPT4gW3Bvc2l0aW9uLmZlbiwgcG9zaXRpb25dKSxcbik7XG4iXSwibmFtZXMiOlsiRmVuVG9Qb3NpdGlvbk1hcCIsIkZlblRvU2NlbmFyaW9NYXAiLCJQb3NpdGlvbklkTWFwIiwiVGVzdFBvc2l0aW9uVXRpbHMiLCJUZXN0UG9zaXRpb25zIiwiZ2V0UG9zaXRpb25CeVBvc2l0aW9uSWQiLCJnZXRTY2VuYXJpb0J5UG9zaXRpb25JZCIsIlBPU0lUSU9OXzFfT1BQT1NJVElPTl9CQVNJQ1MiLCJpZCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJmZW4iLCJjYXRlZ29yeSIsImRpZmZpY3VsdHkiLCJ0YXJnZXRNb3ZlcyIsInNpZGVUb01vdmUiLCJnb2FsIiwiaGludHMiLCJzb2x1dGlvbiIsIlBPU0lUSU9OXzlfQlJJREdFX1pJQ0taQUNLIiwiUE9TSVRJT05fMTBfQlJJREdFX1BPU0lUSU9OSU5HIiwiUE9TSVRJT05fMTFfQlJJREdFX0RFRkxFQ1RJT04iLCJNYXAiLCJwb3NpdGlvbklkIiwicG9zaXRpb25LZXkiLCJnZXQiLCJzY2VuYXJpbyIsInBhcnNlSW50IiwibmV4dFBvc2l0aW9uSWQiLCJwb3NpdGlvbiIsIm5vcm1hbGl6ZUZlbiIsInBhcnRzIiwidHJpbSIsInNwbGl0IiwibGVuZ3RoIiwic2xpY2UiLCJqb2luIiwiZ2V0UG9zaXRpb24iLCJFcnJvciIsImdldFBvc2l0aW9uQnlGZW4iLCJPYmplY3QiLCJ2YWx1ZXMiLCJmaW5kIiwibWFwIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Q0FvQkM7Ozs7Ozs7Ozs7O1FBaVhLQTtlQUFBQTs7UUEwQkFDO2VBQUFBOztRQXpPQUM7ZUFBQUE7O1FBNEZPQztlQUFBQTs7UUFsT0FDO2VBQUFBOztRQWlLR0M7ZUFBQUE7O1FBNkNBQztlQUFBQTs7O0FBOU1ULE1BQU1GLGdCQUE4QztJQUN6RCxvREFBb0Q7SUFDcEQseUNBQXlDO0lBQ3pDLDhEQUE4RDtJQUM5REcsOEJBQThCO1FBQzVCQyxJQUFJO1FBQ0pDLE9BQU87UUFDUEMsYUFDRTtRQUNGQyxLQUFLO1FBQ0xDLFVBQVU7UUFDVkMsWUFBWTtRQUNaQyxhQUFhO1FBQ2JDLFlBQVk7UUFDWkMsTUFBTTtRQUNOQyxPQUFPO1lBQ0w7WUFDQTtZQUNBO1NBQ0Q7UUFDREMsVUFBVTtZQUNSO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtTQUNEO0lBRUg7SUFFQSw2REFBNkQ7SUFDN0QsNkNBQTZDO0lBQzdDLDRFQUE0RTtJQUM1RUMsNEJBQTRCO1FBQzFCWCxJQUFJO1FBQ0pDLE9BQU87UUFDUEMsYUFBYTtRQUNiQyxLQUFLO1FBQ0xDLFVBQVU7UUFDVkMsWUFBWTtRQUNaQyxhQUFhO1FBQ2JDLFlBQVk7UUFDWkMsTUFBTTtRQUNOQyxPQUFPO1lBQ0w7WUFDQTtZQUNBO1NBQ0Q7UUFDREMsVUFBVTtZQUFDO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQVE7WUFBTztTQUFPO0lBQzdFO0lBRUEsZ0VBQWdFO0lBQ2hFLDZDQUE2QztJQUM3QywrRUFBK0U7SUFDL0VFLGdDQUFnQztRQUM5QlosSUFBSTtRQUNKQyxPQUFPO1FBQ1BDLGFBQ0U7UUFDRkMsS0FBSztRQUNMQyxVQUFVO1FBQ1ZDLFlBQVk7UUFDWkMsYUFBYTtRQUNiQyxZQUFZO1FBQ1pDLE1BQU07UUFDTkMsT0FBTztZQUNMO1lBQ0E7WUFDQTtTQUNEO1FBQ0RDLFVBQVU7WUFDUjtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1NBQ0Q7SUFDSDtJQUVBLDZEQUE2RDtJQUM3RCw0Q0FBNEM7SUFDNUMsOEVBQThFO0lBQzlFRywrQkFBK0I7UUFDN0JiLElBQUk7UUFDSkMsT0FBTztRQUNQQyxhQUFhO1FBQ2JDLEtBQUs7UUFDTEMsVUFBVTtRQUNWQyxZQUFZO1FBQ1pDLGFBQWE7UUFDYkMsWUFBWTtRQUNaQyxNQUFNO1FBQ05DLE9BQU87WUFDTDtZQUNBO1lBQ0E7U0FDRDtRQUNEQyxVQUFVO1lBQ1I7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7U0FDRDtJQUNIO0FBQ0Y7QUFLTzs7Q0FFTixHQUNELE1BQU1oQixnQkFBZ0IsSUFBSW9CLElBQXdDO0lBQ2hFO1FBQUM7UUFBRztLQUErQjtJQUNuQztRQUFDO1FBQUc7S0FBNkI7SUFDakM7UUFBQztRQUFJO0tBQWlDO0lBQ3RDO1FBQUM7UUFBSTtLQUFnQztDQUN0QztBQXNCTSxTQUFTakIsd0JBQ2RrQixVQUFrQjtJQUVsQixNQUFNQyxjQUFjdEIsY0FBY3VCLEdBQUcsQ0FBQ0Y7SUFDdEMsSUFBSSxDQUFDQyxhQUFhLE9BQU87SUFFekIsTUFBTUUsV0FBV3RCLGFBQWEsQ0FBQ29CLFlBQVk7SUFDM0MsMENBQTBDO0lBQzFDLE9BQU87UUFDTGhCLElBQUltQixTQUFTRCxTQUFTbEIsRUFBRTtRQUN4QkMsT0FBT2lCLFNBQVNqQixLQUFLO1FBQ3JCQyxhQUFhZ0IsU0FBU2hCLFdBQVc7UUFDakNDLEtBQUtlLFNBQVNmLEdBQUc7UUFDakJDLFVBQVVjLFNBQVNkLFFBQVE7UUFDM0JDLFlBQVlhLFNBQVNiLFVBQVU7UUFDL0JDLGFBQWFZLFNBQVNaLFdBQVc7UUFDakNHLE9BQU9TLFNBQVNULEtBQUs7UUFDckJDLFVBQVVRLFNBQVNSLFFBQVE7UUFDM0JILFlBQVlXLFNBQVNYLFVBQVU7UUFDL0JDLE1BQU1VLFNBQVNWLElBQUk7UUFDbkJZLGdCQUFnQkYsU0FBU0UsY0FBYztJQUN6QztBQUNGO0FBdUJPLFNBQVN0Qix3QkFDZGlCLFVBQWtCO0lBRWxCLE1BQU1DLGNBQWN0QixjQUFjdUIsR0FBRyxDQUFDRjtJQUN0QyxJQUFJLENBQUNDLGFBQWEsT0FBTztJQUN6QixNQUFNSyxXQUFXekIsYUFBYSxDQUFDb0IsWUFBWTtJQUUzQyx1RkFBdUY7SUFDdkYsT0FBT0s7QUFDVDtBQVdPLE1BQU0xQjtJQUNYOzs7Ozs7Ozs7Ozs7Ozs7O0dBZ0JDLEdBQ0QsT0FBTzJCLGFBQWFuQixHQUFXLEVBQVU7UUFDdkMsTUFBTW9CLFFBQVFwQixJQUFJcUIsSUFBSSxHQUFHQyxLQUFLLENBQUM7UUFDL0IsSUFBSUYsTUFBTUcsTUFBTSxJQUFJLEdBQUc7WUFDckIsT0FBT0gsTUFBTUksS0FBSyxDQUFDLEdBQUcsR0FBR0MsSUFBSSxDQUFDO1FBQ2hDO1FBQ0EsT0FBT3pCO0lBQ1Q7SUFFQTs7Ozs7Ozs7Ozs7Ozs7OztHQWdCQyxHQUNELE9BQU8wQixZQUFZN0IsRUFBOEIsRUFBbUI7UUFDbEUsTUFBTWtCLFdBQVd0QixhQUFhLENBQUNJLEdBQUc7UUFDbEMsSUFBSSxDQUFDa0IsVUFBVTtZQUNiLE1BQU0sSUFBSVksTUFBTSxDQUFDLHlCQUF5QixFQUFFOUIsSUFBSTtRQUNsRDtRQUVBLDBDQUEwQztRQUMxQyxPQUFPO1lBQ0xBLElBQUltQixTQUFTRCxTQUFTbEIsRUFBRTtZQUN4QkMsT0FBT2lCLFNBQVNqQixLQUFLO1lBQ3JCQyxhQUFhZ0IsU0FBU2hCLFdBQVc7WUFDakNDLEtBQUtlLFNBQVNmLEdBQUc7WUFDakJDLFVBQVVjLFNBQVNkLFFBQVE7WUFDM0JDLFlBQVlhLFNBQVNiLFVBQVU7WUFDL0JDLGFBQWFZLFNBQVNaLFdBQVc7WUFDakNHLE9BQU9TLFNBQVNULEtBQUs7WUFDckJDLFVBQVVRLFNBQVNSLFFBQVE7WUFDM0JILFlBQVlXLFNBQVNYLFVBQVU7WUFDL0JDLE1BQU1VLFNBQVNWLElBQUk7WUFDbkJZLGdCQUFnQkYsU0FBU0UsY0FBYztRQUN6QztJQUNGO0lBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQWtCQyxHQUNELE9BQU9XLGlCQUFpQjVCLEdBQVcsRUFBMEI7UUFDM0QsTUFBTWUsV0FBV2MsT0FBT0MsTUFBTSxDQUFDckMsZUFBZXNDLElBQUksQ0FDaEQsQ0FBQ2IsV0FBYUEsU0FBU2xCLEdBQUcsS0FBS0E7UUFFakMsSUFBSSxDQUFDZSxVQUFVLE9BQU87UUFFdEIsMENBQTBDO1FBQzFDLE9BQU87WUFDTGxCLElBQUltQixTQUFTRCxTQUFTbEIsRUFBRTtZQUN4QkMsT0FBT2lCLFNBQVNqQixLQUFLO1lBQ3JCQyxhQUFhZ0IsU0FBU2hCLFdBQVc7WUFDakNDLEtBQUtlLFNBQVNmLEdBQUc7WUFDakJDLFVBQVVjLFNBQVNkLFFBQVE7WUFDM0JDLFlBQVlhLFNBQVNiLFVBQVU7WUFDL0JDLGFBQWFZLFNBQVNaLFdBQVc7WUFDakNHLE9BQU9TLFNBQVNULEtBQUs7WUFDckJDLFVBQVVRLFNBQVNSLFFBQVE7WUFDM0JILFlBQVlXLFNBQVNYLFVBQVU7WUFDL0JDLE1BQU1VLFNBQVNWLElBQUk7WUFDbkJZLGdCQUFnQkYsU0FBU0UsY0FBYztRQUN6QztJQUNGO0FBQ0Y7QUFLTzs7Q0FFTixHQUNELE1BQU01QixtQkFBbUIsSUFBSXNCLElBQzNCa0IsT0FBT0MsTUFBTSxDQUFDckMsZUFBZXVDLEdBQUcsQ0FBQyxDQUFDakIsV0FBYTtRQUM3Q0EsU0FBU2YsR0FBRztRQUNaO1lBQ0VILElBQUltQixTQUFTRCxTQUFTbEIsRUFBRTtZQUN4QkMsT0FBT2lCLFNBQVNqQixLQUFLO1lBQ3JCQyxhQUFhZ0IsU0FBU2hCLFdBQVc7WUFDakNDLEtBQUtlLFNBQVNmLEdBQUc7WUFDakJDLFVBQVVjLFNBQVNkLFFBQVE7WUFDM0JDLFlBQVlhLFNBQVNiLFVBQVU7WUFDL0JDLGFBQWFZLFNBQVNaLFdBQVc7WUFDakNHLE9BQU9TLFNBQVNULEtBQUs7WUFDckJDLFVBQVVRLFNBQVNSLFFBQVE7WUFDM0JILFlBQVlXLFNBQVNYLFVBQVU7WUFDL0JDLE1BQU1VLFNBQVNWLElBQUk7WUFDbkJZLGdCQUFnQkYsU0FBU0UsY0FBYztRQUN6QztLQUNEO0FBTUk7O0NBRU4sR0FDRCxNQUFNM0IsbUJBQW1CLElBQUlxQixJQUMzQmtCLE9BQU9DLE1BQU0sQ0FBQ3JDLGVBQWV1QyxHQUFHLENBQUMsQ0FBQ2QsV0FBYTtRQUFDQSxTQUFTbEIsR0FBRztRQUFFa0I7S0FBUyJ9