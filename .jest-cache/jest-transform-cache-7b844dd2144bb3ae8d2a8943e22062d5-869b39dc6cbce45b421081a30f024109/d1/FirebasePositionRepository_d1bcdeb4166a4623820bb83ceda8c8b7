4286bc6064becc0a65110dccb1a36c4c
/**
 * Firebase implementation of IPositionRepository
 * Encapsulates all Firebase-specific logic
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "FirebasePositionRepository", {
    enumerable: true,
    get: function() {
        return FirebasePositionRepository;
    }
});
const _firestore = require("firebase/firestore");
const _fenValidator = require("../../utils/fenValidator");
const _logging = require("../../services/logging");
function _define_property(obj, key, value) {
    if (key in obj) {
        Object.defineProperty(obj, key, {
            value: value,
            enumerable: true,
            configurable: true,
            writable: true
        });
    } else {
        obj[key] = value;
    }
    return obj;
}
const logger = (0, _logging.getLogger)().setContext("FirebasePositionRepository");
class FirebasePositionRepository {
    async getPosition(id) {
        try {
            const docRef = (0, _firestore.doc)(this.db, "positions", id.toString());
            const docSnap = await (0, _firestore.getDoc)(docRef);
            if (docSnap.exists()) {
                var _this_config_events_onDataFetched, _this_config_events;
                const data = docSnap.data();
                const position = {
                    ...data,
                    id
                };
                // Validate FEN
                if (position.fen) {
                    const validation = (0, _fenValidator.validateAndSanitizeFen)(position.fen);
                    if (!validation.isValid) {
                        logger.error(`Invalid FEN from Firestore for position ${id}: ${validation.errors.join(", ")}`);
                        throw new Error("Invalid position data");
                    }
                    position.fen = validation.sanitized;
                }
                (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getPosition", 1);
                return position;
            }
            logger.warn(`Position ${id} not found`);
            return null;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get position", error, {
                id
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getPosition", error);
            throw error;
        }
    }
    async createPosition(data) {
        try {
            var _this_config_events_onDataModified, _this_config_events;
            // Generate unique ID using crypto.randomUUID for collision-free identifiers
            const uniqueId = crypto.randomUUID();
            // Convert to number for compatibility with existing EndgamePosition.id type
            // Using hash code of the UUID string
            const id = Math.abs(uniqueId.split("").reduce((a, b)=>{
                a = (a << 5) - a + b.charCodeAt(0);
                return a & a;
            }, 0));
            const position = {
                ...data,
                id
            };
            // Validate FEN before saving
            if (position.fen) {
                const validation = (0, _fenValidator.validateAndSanitizeFen)(position.fen);
                if (!validation.isValid) {
                    throw new Error(`Invalid FEN: ${validation.errors.join(", ")}`);
                }
                position.fen = validation.sanitized;
            }
            const docRef = (0, _firestore.doc)(this.db, "positions", id.toString());
            await (0, _firestore.setDoc)(docRef, position);
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataModified = _this_config_events.onDataModified) === null || _this_config_events_onDataModified === void 0 ? void 0 : _this_config_events_onDataModified.call(_this_config_events, "createPosition", [
                id
            ]);
            return position;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to create position", error);
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "createPosition", error);
            throw error;
        }
    }
    async updatePosition(id, updates) {
        try {
            var _this_config_events_onDataModified, _this_config_events;
            // Validate FEN if provided
            if (updates.fen) {
                const validation = (0, _fenValidator.validateAndSanitizeFen)(updates.fen);
                if (!validation.isValid) {
                    throw new Error(`Invalid FEN: ${validation.errors.join(", ")}`);
                }
                updates.fen = validation.sanitized;
            }
            const docRef = (0, _firestore.doc)(this.db, "positions", id.toString());
            await (0, _firestore.updateDoc)(docRef, updates);
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataModified = _this_config_events.onDataModified) === null || _this_config_events_onDataModified === void 0 ? void 0 : _this_config_events_onDataModified.call(_this_config_events, "updatePosition", [
                id
            ]);
            return this.getPosition(id);
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to update position", error, {
                id
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "updatePosition", error);
            throw error;
        }
    }
    async deletePosition(id) {
        try {
            var _this_config_events_onDataModified, _this_config_events;
            const docRef = (0, _firestore.doc)(this.db, "positions", id.toString());
            await (0, _firestore.deleteDoc)(docRef);
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataModified = _this_config_events.onDataModified) === null || _this_config_events_onDataModified === void 0 ? void 0 : _this_config_events_onDataModified.call(_this_config_events, "deletePosition", [
                id
            ]);
            return true;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to delete position", error, {
                id
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "deletePosition", error);
            return false;
        }
    }
    async getAllPositions() {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const positionsRef = (0, _firestore.collection)(this.db, "positions");
            const snapshot = await (0, _firestore.getDocs)(positionsRef);
            const positions = [];
            snapshot.forEach((doc)=>{
                const data = doc.data();
                const position = {
                    ...data,
                    id: parseInt(doc.id)
                };
                // Validate FEN
                if (position.fen) {
                    const validation = (0, _fenValidator.validateAndSanitizeFen)(position.fen);
                    if (validation.isValid) {
                        position.fen = validation.sanitized;
                        positions.push(position);
                    } else {
                        logger.error(`Invalid FEN for position ${position.id}: ${validation.errors.join(", ")}`);
                    }
                } else {
                    positions.push(position);
                }
            });
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getAllPositions", positions.length);
            return positions;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get all positions", error);
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getAllPositions", error);
            return [];
        }
    }
    async getPositionsByCategory(category) {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const positionsRef = (0, _firestore.collection)(this.db, "positions");
            const q = (0, _firestore.query)(positionsRef, (0, _firestore.where)("category", "==", category));
            const snapshot = await (0, _firestore.getDocs)(q);
            const positions = [];
            snapshot.forEach((doc)=>{
                const data = doc.data();
                const position = {
                    ...data,
                    id: parseInt(doc.id)
                };
                // Validate FEN
                if (position.fen) {
                    const validation = (0, _fenValidator.validateAndSanitizeFen)(position.fen);
                    if (validation.isValid) {
                        position.fen = validation.sanitized;
                        positions.push(position);
                    } else {
                        logger.error(`Invalid FEN for position ${position.id}: ${validation.errors.join(", ")}`);
                    }
                } else {
                    positions.push(position);
                }
            });
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getPositionsByCategory", positions.length);
            return positions;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get positions by category", error, {
                category
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getPositionsByCategory", error);
            return [];
        }
    }
    async getPositionsByDifficulty(difficulty) {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const positionsRef = (0, _firestore.collection)(this.db, "positions");
            const q = (0, _firestore.query)(positionsRef, (0, _firestore.where)("difficulty", "==", difficulty));
            const snapshot = await (0, _firestore.getDocs)(q);
            const positions = [];
            snapshot.forEach((doc)=>{
                const data = doc.data();
                const position = {
                    ...data,
                    id: parseInt(doc.id)
                };
                // Validate FEN
                if (position.fen) {
                    const validation = (0, _fenValidator.validateAndSanitizeFen)(position.fen);
                    if (validation.isValid) {
                        position.fen = validation.sanitized;
                        positions.push(position);
                    } else {
                        logger.error(`Invalid FEN for position ${position.id}: ${validation.errors.join(", ")}`);
                    }
                } else {
                    positions.push(position);
                }
            });
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getPositionsByDifficulty", positions.length);
            return positions;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get positions by difficulty", error, {
                difficulty
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getPositionsByDifficulty", error);
            return [];
        }
    }
    async getPositionsByIds(ids) {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const positions = await Promise.all(ids.map((id)=>this.getPosition(id)));
            const validPositions = positions.filter((p)=>p !== null);
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getPositionsByIds", validPositions.length);
            return validPositions;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get positions by ids", error, {
                ids
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getPositionsByIds", error);
            return [];
        }
    }
    async searchPositions(searchTerm) {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            // Firestore doesn't support full-text search natively
            // For production, consider Algolia or Elasticsearch
            const positions = await this.getAllPositions();
            const lowerSearch = searchTerm.toLowerCase();
            const results = positions.filter((p)=>p.title.toLowerCase().includes(lowerSearch) || p.description.toLowerCase().includes(lowerSearch));
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "searchPositions", results.length);
            return results;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to search positions", error, {
                searchTerm
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "searchPositions", error);
            return [];
        }
    }
    async getPositionsByTags(_tags) {
        var _this_config_events_onDataFetched, _this_config_events;
        // Tags are not yet implemented in EndgamePosition type
        // Return empty array for now
        logger.warn("getPositionsByTags: tags property not yet implemented in EndgamePosition");
        (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getPositionsByTags", 0);
        return [];
    }
    async getNextPosition(currentId, categoryId) {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const positionsRef = (0, _firestore.collection)(this.db, "positions");
            let q;
            if (categoryId) {
                q = (0, _firestore.query)(positionsRef, (0, _firestore.where)("category", "==", categoryId), (0, _firestore.where)("id", ">", currentId), (0, _firestore.orderBy)("id"), (0, _firestore.limit)(1));
            } else {
                q = (0, _firestore.query)(positionsRef, (0, _firestore.where)("id", ">", currentId), (0, _firestore.orderBy)("id"), (0, _firestore.limit)(1));
            }
            const snapshot = await (0, _firestore.getDocs)(q);
            if (snapshot.empty) {
                return null;
            }
            const data = snapshot.docs[0].data();
            const position = {
                ...data,
                id: parseInt(snapshot.docs[0].id)
            };
            // Validate FEN
            if (position.fen) {
                const validation = (0, _fenValidator.validateAndSanitizeFen)(position.fen);
                if (!validation.isValid) {
                    logger.error(`Invalid FEN for position ${position.id}: ${validation.errors.join(", ")}`);
                    return null;
                }
                position.fen = validation.sanitized;
            }
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getNextPosition", 1);
            return position;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get next position", error, {
                currentId,
                categoryId
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getNextPosition", error);
            return null;
        }
    }
    async getPreviousPosition(currentId, categoryId) {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const positionsRef = (0, _firestore.collection)(this.db, "positions");
            let q;
            if (categoryId) {
                q = (0, _firestore.query)(positionsRef, (0, _firestore.where)("category", "==", categoryId), (0, _firestore.where)("id", "<", currentId), (0, _firestore.orderBy)("id", "desc"), (0, _firestore.limit)(1));
            } else {
                q = (0, _firestore.query)(positionsRef, (0, _firestore.where)("id", "<", currentId), (0, _firestore.orderBy)("id", "desc"), (0, _firestore.limit)(1));
            }
            const snapshot = await (0, _firestore.getDocs)(q);
            if (snapshot.empty) {
                return null;
            }
            const data = snapshot.docs[0].data();
            const position = {
                ...data,
                id: parseInt(snapshot.docs[0].id)
            };
            // Validate FEN
            if (position.fen) {
                const validation = (0, _fenValidator.validateAndSanitizeFen)(position.fen);
                if (!validation.isValid) {
                    logger.error(`Invalid FEN for position ${position.id}: ${validation.errors.join(", ")}`);
                    return null;
                }
                position.fen = validation.sanitized;
            }
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getPreviousPosition", 1);
            return position;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get previous position", error, {
                currentId,
                categoryId
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getPreviousPosition", error);
            return null;
        }
    }
    async getCategories() {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const categoriesRef = (0, _firestore.collection)(this.db, "categories");
            const snapshot = await (0, _firestore.getDocs)(categoriesRef);
            const categories = [];
            snapshot.forEach((doc)=>{
                categories.push(doc.data());
            });
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getCategories", categories.length);
            return categories;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get categories", error);
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getCategories", error);
            return [];
        }
    }
    async getCategory(id) {
        try {
            const docRef = (0, _firestore.doc)(this.db, "categories", id);
            const docSnap = await (0, _firestore.getDoc)(docRef);
            if (docSnap.exists()) {
                var _this_config_events_onDataFetched, _this_config_events;
                (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getCategory", 1);
                return docSnap.data();
            }
            return null;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get category", error, {
                id
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getCategory", error);
            return null;
        }
    }
    async getChapters() {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const chaptersRef = (0, _firestore.collection)(this.db, "chapters");
            const snapshot = await (0, _firestore.getDocs)(chaptersRef);
            const chapters = [];
            snapshot.forEach((doc)=>{
                chapters.push(doc.data());
            });
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getChapters", chapters.length);
            return chapters;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get chapters", error);
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getChapters", error);
            return [];
        }
    }
    async getChaptersByCategory(categoryId) {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const chaptersRef = (0, _firestore.collection)(this.db, "chapters");
            const q = (0, _firestore.query)(chaptersRef, (0, _firestore.where)("category", "==", categoryId));
            const snapshot = await (0, _firestore.getDocs)(q);
            const chapters = [];
            snapshot.forEach((doc)=>{
                chapters.push(doc.data());
            });
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getChaptersByCategory", chapters.length);
            return chapters;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get chapters by category", error, {
                categoryId
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getChaptersByCategory", error);
            return [];
        }
    }
    async getTotalPositionCount() {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const positionsRef = (0, _firestore.collection)(this.db, "positions");
            const snapshot = await (0, _firestore.getDocs)(positionsRef);
            const count = snapshot.size;
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getTotalPositionCount", count);
            return count;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get total position count", error);
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getTotalPositionCount", error);
            return 0;
        }
    }
    async getPositionCountByCategory(categoryId) {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const positionsRef = (0, _firestore.collection)(this.db, "positions");
            const q = (0, _firestore.query)(positionsRef, (0, _firestore.where)("category", "==", categoryId));
            const snapshot = await (0, _firestore.getDocs)(q);
            const count = snapshot.size;
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getPositionCountByCategory", count);
            return count;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get position count by category", error, {
                categoryId
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getPositionCountByCategory", error);
            return 0;
        }
    }
    async getPositionCountByDifficulty(difficulty) {
        try {
            var _this_config_events_onDataFetched, _this_config_events;
            const positionsRef = (0, _firestore.collection)(this.db, "positions");
            const q = (0, _firestore.query)(positionsRef, (0, _firestore.where)("difficulty", "==", difficulty));
            const snapshot = await (0, _firestore.getDocs)(q);
            const count = snapshot.size;
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataFetched = _this_config_events.onDataFetched) === null || _this_config_events_onDataFetched === void 0 ? void 0 : _this_config_events_onDataFetched.call(_this_config_events, "getPositionCountByDifficulty", count);
            return count;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to get position count by difficulty", error, {
                difficulty
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "getPositionCountByDifficulty", error);
            return 0;
        }
    }
    async batchCreatePositions(positions) {
        try {
            var _this_config_events_onDataModified, _this_config_events;
            const batch = (0, _firestore.writeBatch)(this.db);
            const createdPositions = [];
            for (const data of positions){
                // Generate unique ID using crypto.randomUUID for each position
                const uniqueId = crypto.randomUUID();
                const id = Math.abs(uniqueId.split("").reduce((a, b)=>{
                    a = (a << 5) - a + b.charCodeAt(0);
                    return a & a;
                }, 0));
                const position = {
                    ...data,
                    id
                };
                // Validate FEN
                if (position.fen) {
                    const validation = (0, _fenValidator.validateAndSanitizeFen)(position.fen);
                    if (!validation.isValid) {
                        throw new Error(`Invalid FEN for position: ${validation.errors.join(", ")}`);
                    }
                    position.fen = validation.sanitized;
                }
                const docRef = (0, _firestore.doc)(this.db, "positions", id.toString());
                batch.set(docRef, position);
                createdPositions.push(position);
            }
            await batch.commit();
            const ids = createdPositions.map((p)=>p.id);
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataModified = _this_config_events.onDataModified) === null || _this_config_events_onDataModified === void 0 ? void 0 : _this_config_events_onDataModified.call(_this_config_events, "batchCreatePositions", ids);
            return createdPositions;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to batch create positions", error);
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "batchCreatePositions", error);
            throw error;
        }
    }
    async batchUpdatePositions(updates) {
        try {
            var _this_config_events_onDataModified, _this_config_events;
            const batch = (0, _firestore.writeBatch)(this.db);
            const ids = [];
            for (const { id, updates: updateData } of updates){
                // Validate FEN if provided
                if (updateData.fen) {
                    const validation = (0, _fenValidator.validateAndSanitizeFen)(updateData.fen);
                    if (!validation.isValid) {
                        throw new Error(`Invalid FEN for position ${id}: ${validation.errors.join(", ")}`);
                    }
                    updateData.fen = validation.sanitized;
                }
                const docRef = (0, _firestore.doc)(this.db, "positions", id.toString());
                batch.update(docRef, updateData);
                ids.push(id);
            }
            await batch.commit();
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataModified = _this_config_events.onDataModified) === null || _this_config_events_onDataModified === void 0 ? void 0 : _this_config_events_onDataModified.call(_this_config_events, "batchUpdatePositions", ids);
            return this.getPositionsByIds(ids);
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to batch update positions", error);
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "batchUpdatePositions", error);
            throw error;
        }
    }
    async batchDeletePositions(ids) {
        try {
            var _this_config_events_onDataModified, _this_config_events;
            const batch = (0, _firestore.writeBatch)(this.db);
            for (const id of ids){
                const docRef = (0, _firestore.doc)(this.db, "positions", id.toString());
                batch.delete(docRef);
            }
            await batch.commit();
            (_this_config_events = this.config.events) === null || _this_config_events === void 0 ? void 0 : (_this_config_events_onDataModified = _this_config_events.onDataModified) === null || _this_config_events_onDataModified === void 0 ? void 0 : _this_config_events_onDataModified.call(_this_config_events, "batchDeletePositions", ids);
            return true;
        } catch (error) {
            var _this_config_events_onError, _this_config_events1;
            logger.error("Failed to batch delete positions", error, {
                ids
            });
            (_this_config_events1 = this.config.events) === null || _this_config_events1 === void 0 ? void 0 : (_this_config_events_onError = _this_config_events1.onError) === null || _this_config_events_onError === void 0 ? void 0 : _this_config_events_onError.call(_this_config_events1, "batchDeletePositions", error);
            return false;
        }
    }
    constructor(firestore, config = {}){
        _define_property(this, "db", void 0);
        _define_property(this, "config", void 0);
        this.db = firestore;
        this.config = config;
        logger.info("FirebasePositionRepository initialized", {
            config
        });
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3RoZWh1L2Nvb2xQcm9qZWN0cy9FbmRnYW1lVHJhaW5lci10cmFpbmluZy1ib2FyZC1jb21wbGV0ZS9zcmMvc2hhcmVkL3JlcG9zaXRvcmllcy9pbXBsZW1lbnRhdGlvbnMvRmlyZWJhc2VQb3NpdGlvblJlcG9zaXRvcnkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBGaXJlYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBJUG9zaXRpb25SZXBvc2l0b3J5XG4gKiBFbmNhcHN1bGF0ZXMgYWxsIEZpcmViYXNlLXNwZWNpZmljIGxvZ2ljXG4gKi9cblxuaW1wb3J0IHtcbiAgZG9jLFxuICBnZXREb2MsXG4gIHNldERvYyxcbiAgdXBkYXRlRG9jLFxuICBkZWxldGVEb2MsXG4gIGNvbGxlY3Rpb24sXG4gIGdldERvY3MsXG4gIHF1ZXJ5LFxuICB3aGVyZSxcbiAgb3JkZXJCeSxcbiAgbGltaXQsXG4gIERvY3VtZW50RGF0YSxcbiAgRmlyZXN0b3JlLFxuICB3cml0ZUJhdGNoLFxuICBRdWVyeSxcbn0gZnJvbSBcImZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuXG5pbXBvcnQge1xuICBJUG9zaXRpb25SZXBvc2l0b3J5LFxuICBJUG9zaXRpb25SZXBvc2l0b3J5Q29uZmlnLFxufSBmcm9tIFwiLi4vSVBvc2l0aW9uUmVwb3NpdG9yeVwiO1xuaW1wb3J0IHtcbiAgRW5kZ2FtZVBvc2l0aW9uLFxuICBFbmRnYW1lQ2F0ZWdvcnksXG4gIEVuZGdhbWVDaGFwdGVyLFxufSBmcm9tIFwiQHNoYXJlZC90eXBlc1wiO1xuaW1wb3J0IHsgdmFsaWRhdGVBbmRTYW5pdGl6ZUZlbiB9IGZyb20gXCJAc2hhcmVkL3V0aWxzL2ZlblZhbGlkYXRvclwiO1xuaW1wb3J0IHsgZ2V0TG9nZ2VyIH0gZnJvbSBcIkBzaGFyZWQvc2VydmljZXMvbG9nZ2luZ1wiO1xuXG5jb25zdCBsb2dnZXIgPSBnZXRMb2dnZXIoKS5zZXRDb250ZXh0KFwiRmlyZWJhc2VQb3NpdGlvblJlcG9zaXRvcnlcIik7XG5cbmV4cG9ydCBjbGFzcyBGaXJlYmFzZVBvc2l0aW9uUmVwb3NpdG9yeSBpbXBsZW1lbnRzIElQb3NpdGlvblJlcG9zaXRvcnkge1xuICBwcml2YXRlIGRiOiBGaXJlc3RvcmU7XG4gIHByaXZhdGUgY29uZmlnOiBJUG9zaXRpb25SZXBvc2l0b3J5Q29uZmlnO1xuXG4gIGNvbnN0cnVjdG9yKGZpcmVzdG9yZTogRmlyZXN0b3JlLCBjb25maWc6IElQb3NpdGlvblJlcG9zaXRvcnlDb25maWcgPSB7fSkge1xuICAgIHRoaXMuZGIgPSBmaXJlc3RvcmU7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgbG9nZ2VyLmluZm8oXCJGaXJlYmFzZVBvc2l0aW9uUmVwb3NpdG9yeSBpbml0aWFsaXplZFwiLCB7IGNvbmZpZyB9KTtcbiAgfVxuXG4gIGFzeW5jIGdldFBvc2l0aW9uKGlkOiBudW1iZXIpOiBQcm9taXNlPEVuZGdhbWVQb3NpdGlvbiB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZG9jUmVmID0gZG9jKHRoaXMuZGIsIFwicG9zaXRpb25zXCIsIGlkLnRvU3RyaW5nKCkpO1xuICAgICAgY29uc3QgZG9jU25hcCA9IGF3YWl0IGdldERvYyhkb2NSZWYpO1xuXG4gICAgICBpZiAoZG9jU25hcC5leGlzdHMoKSkge1xuICAgICAgICBjb25zdCBkYXRhID0gZG9jU25hcC5kYXRhKCk7XG4gICAgICAgIGNvbnN0IHBvc2l0aW9uOiBFbmRnYW1lUG9zaXRpb24gPSB7IC4uLmRhdGEsIGlkIH0gYXMgRW5kZ2FtZVBvc2l0aW9uO1xuICAgICAgICAvLyBWYWxpZGF0ZSBGRU5cbiAgICAgICAgaWYgKHBvc2l0aW9uLmZlbikge1xuICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZUFuZFNhbml0aXplRmVuKHBvc2l0aW9uLmZlbik7XG4gICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICAgICAgYEludmFsaWQgRkVOIGZyb20gRmlyZXN0b3JlIGZvciBwb3NpdGlvbiAke2lkfTogJHt2YWxpZGF0aW9uLmVycm9ycy5qb2luKFwiLCBcIil9YCxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHBvc2l0aW9uIGRhdGFcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBvc2l0aW9uLmZlbiA9IHZhbGlkYXRpb24uc2FuaXRpemVkO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25EYXRhRmV0Y2hlZD8uKFwiZ2V0UG9zaXRpb25cIiwgMSk7XG4gICAgICAgIHJldHVybiBwb3NpdGlvbjtcbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLndhcm4oYFBvc2l0aW9uICR7aWR9IG5vdCBmb3VuZGApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgcG9zaXRpb25cIiwgZXJyb3IgYXMgRXJyb3IsIHsgaWQgfSk7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRXJyb3I/LihcImdldFBvc2l0aW9uXCIsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVBvc2l0aW9uKFxuICAgIGRhdGE6IE9taXQ8RW5kZ2FtZVBvc2l0aW9uLCBcImlkXCI+LFxuICApOiBQcm9taXNlPEVuZGdhbWVQb3NpdGlvbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBHZW5lcmF0ZSB1bmlxdWUgSUQgdXNpbmcgY3J5cHRvLnJhbmRvbVVVSUQgZm9yIGNvbGxpc2lvbi1mcmVlIGlkZW50aWZpZXJzXG4gICAgICBjb25zdCB1bmlxdWVJZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG4gICAgICAvLyBDb252ZXJ0IHRvIG51bWJlciBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIGV4aXN0aW5nIEVuZGdhbWVQb3NpdGlvbi5pZCB0eXBlXG4gICAgICAvLyBVc2luZyBoYXNoIGNvZGUgb2YgdGhlIFVVSUQgc3RyaW5nXG4gICAgICBjb25zdCBpZCA9IE1hdGguYWJzKFxuICAgICAgICB1bmlxdWVJZC5zcGxpdChcIlwiKS5yZWR1Y2UoKGEsIGIpID0+IHtcbiAgICAgICAgICBhID0gKGEgPDwgNSkgLSBhICsgYi5jaGFyQ29kZUF0KDApO1xuICAgICAgICAgIHJldHVybiBhICYgYTtcbiAgICAgICAgfSwgMCksXG4gICAgICApO1xuICAgICAgY29uc3QgcG9zaXRpb246IEVuZGdhbWVQb3NpdGlvbiA9IHsgLi4uZGF0YSwgaWQgfTtcblxuICAgICAgLy8gVmFsaWRhdGUgRkVOIGJlZm9yZSBzYXZpbmdcbiAgICAgIGlmIChwb3NpdGlvbi5mZW4pIHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHZhbGlkYXRlQW5kU2FuaXRpemVGZW4ocG9zaXRpb24uZmVuKTtcbiAgICAgICAgaWYgKCF2YWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgRkVOOiAke3ZhbGlkYXRpb24uZXJyb3JzLmpvaW4oXCIsIFwiKX1gKTtcbiAgICAgICAgfVxuICAgICAgICBwb3NpdGlvbi5mZW4gPSB2YWxpZGF0aW9uLnNhbml0aXplZDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZG9jUmVmID0gZG9jKHRoaXMuZGIsIFwicG9zaXRpb25zXCIsIGlkLnRvU3RyaW5nKCkpO1xuICAgICAgYXdhaXQgc2V0RG9jKGRvY1JlZiwgcG9zaXRpb24pO1xuXG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRGF0YU1vZGlmaWVkPy4oXCJjcmVhdGVQb3NpdGlvblwiLCBbaWRdKTtcbiAgICAgIHJldHVybiBwb3NpdGlvbjtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBwb3NpdGlvblwiLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRXJyb3I/LihcImNyZWF0ZVBvc2l0aW9uXCIsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVBvc2l0aW9uKFxuICAgIGlkOiBudW1iZXIsXG4gICAgdXBkYXRlczogUGFydGlhbDxFbmRnYW1lUG9zaXRpb24+LFxuICApOiBQcm9taXNlPEVuZGdhbWVQb3NpdGlvbiB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVmFsaWRhdGUgRkVOIGlmIHByb3ZpZGVkXG4gICAgICBpZiAodXBkYXRlcy5mZW4pIHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHZhbGlkYXRlQW5kU2FuaXRpemVGZW4odXBkYXRlcy5mZW4pO1xuICAgICAgICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBGRU46ICR7dmFsaWRhdGlvbi5lcnJvcnMuam9pbihcIiwgXCIpfWApO1xuICAgICAgICB9XG4gICAgICAgIHVwZGF0ZXMuZmVuID0gdmFsaWRhdGlvbi5zYW5pdGl6ZWQ7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRvY1JlZiA9IGRvYyh0aGlzLmRiLCBcInBvc2l0aW9uc1wiLCBpZC50b1N0cmluZygpKTtcbiAgICAgIGF3YWl0IHVwZGF0ZURvYyhkb2NSZWYsIHVwZGF0ZXMgYXMgRG9jdW1lbnREYXRhKTtcblxuICAgICAgdGhpcy5jb25maWcuZXZlbnRzPy5vbkRhdGFNb2RpZmllZD8uKFwidXBkYXRlUG9zaXRpb25cIiwgW2lkXSk7XG4gICAgICByZXR1cm4gdGhpcy5nZXRQb3NpdGlvbihpZCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgcG9zaXRpb25cIiwgZXJyb3IgYXMgRXJyb3IsIHsgaWQgfSk7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRXJyb3I/LihcInVwZGF0ZVBvc2l0aW9uXCIsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVBvc2l0aW9uKGlkOiBudW1iZXIpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZG9jUmVmID0gZG9jKHRoaXMuZGIsIFwicG9zaXRpb25zXCIsIGlkLnRvU3RyaW5nKCkpO1xuICAgICAgYXdhaXQgZGVsZXRlRG9jKGRvY1JlZik7XG5cbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25EYXRhTW9kaWZpZWQ/LihcImRlbGV0ZVBvc2l0aW9uXCIsIFtpZF0pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBkZWxldGUgcG9zaXRpb25cIiwgZXJyb3IgYXMgRXJyb3IsIHsgaWQgfSk7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRXJyb3I/LihcImRlbGV0ZVBvc2l0aW9uXCIsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRBbGxQb3NpdGlvbnMoKTogUHJvbWlzZTxFbmRnYW1lUG9zaXRpb25bXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwb3NpdGlvbnNSZWYgPSBjb2xsZWN0aW9uKHRoaXMuZGIsIFwicG9zaXRpb25zXCIpO1xuICAgICAgY29uc3Qgc25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHBvc2l0aW9uc1JlZik7XG5cbiAgICAgIGNvbnN0IHBvc2l0aW9uczogRW5kZ2FtZVBvc2l0aW9uW10gPSBbXTtcbiAgICAgIHNuYXBzaG90LmZvckVhY2goKGRvYykgPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gZG9jLmRhdGEoKTtcbiAgICAgICAgY29uc3QgcG9zaXRpb246IEVuZGdhbWVQb3NpdGlvbiA9IHtcbiAgICAgICAgICAuLi5kYXRhLFxuICAgICAgICAgIGlkOiBwYXJzZUludChkb2MuaWQpLFxuICAgICAgICB9IGFzIEVuZGdhbWVQb3NpdGlvbjtcbiAgICAgICAgLy8gVmFsaWRhdGUgRkVOXG4gICAgICAgIGlmIChwb3NpdGlvbi5mZW4pIHtcbiAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdmFsaWRhdGVBbmRTYW5pdGl6ZUZlbihwb3NpdGlvbi5mZW4pO1xuICAgICAgICAgIGlmICh2YWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgICAgICAgIHBvc2l0aW9uLmZlbiA9IHZhbGlkYXRpb24uc2FuaXRpemVkO1xuICAgICAgICAgICAgcG9zaXRpb25zLnB1c2gocG9zaXRpb24pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICAgIGBJbnZhbGlkIEZFTiBmb3IgcG9zaXRpb24gJHtwb3NpdGlvbi5pZH06ICR7dmFsaWRhdGlvbi5lcnJvcnMuam9pbihcIiwgXCIpfWAsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwb3NpdGlvbnMucHVzaChwb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRGF0YUZldGNoZWQ/LihcImdldEFsbFBvc2l0aW9uc1wiLCBwb3NpdGlvbnMubGVuZ3RoKTtcbiAgICAgIHJldHVybiBwb3NpdGlvbnM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgYWxsIHBvc2l0aW9uc1wiLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRXJyb3I/LihcImdldEFsbFBvc2l0aW9uc1wiLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0UG9zaXRpb25zQnlDYXRlZ29yeShjYXRlZ29yeTogc3RyaW5nKTogUHJvbWlzZTxFbmRnYW1lUG9zaXRpb25bXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwb3NpdGlvbnNSZWYgPSBjb2xsZWN0aW9uKHRoaXMuZGIsIFwicG9zaXRpb25zXCIpO1xuICAgICAgY29uc3QgcSA9IHF1ZXJ5KHBvc2l0aW9uc1JlZiwgd2hlcmUoXCJjYXRlZ29yeVwiLCBcIj09XCIsIGNhdGVnb3J5KSk7XG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XG5cbiAgICAgIGNvbnN0IHBvc2l0aW9uczogRW5kZ2FtZVBvc2l0aW9uW10gPSBbXTtcbiAgICAgIHNuYXBzaG90LmZvckVhY2goKGRvYykgPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gZG9jLmRhdGEoKTtcbiAgICAgICAgY29uc3QgcG9zaXRpb246IEVuZGdhbWVQb3NpdGlvbiA9IHtcbiAgICAgICAgICAuLi5kYXRhLFxuICAgICAgICAgIGlkOiBwYXJzZUludChkb2MuaWQpLFxuICAgICAgICB9IGFzIEVuZGdhbWVQb3NpdGlvbjtcbiAgICAgICAgLy8gVmFsaWRhdGUgRkVOXG4gICAgICAgIGlmIChwb3NpdGlvbi5mZW4pIHtcbiAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdmFsaWRhdGVBbmRTYW5pdGl6ZUZlbihwb3NpdGlvbi5mZW4pO1xuICAgICAgICAgIGlmICh2YWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgICAgICAgIHBvc2l0aW9uLmZlbiA9IHZhbGlkYXRpb24uc2FuaXRpemVkO1xuICAgICAgICAgICAgcG9zaXRpb25zLnB1c2gocG9zaXRpb24pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICAgIGBJbnZhbGlkIEZFTiBmb3IgcG9zaXRpb24gJHtwb3NpdGlvbi5pZH06ICR7dmFsaWRhdGlvbi5lcnJvcnMuam9pbihcIiwgXCIpfWAsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwb3NpdGlvbnMucHVzaChwb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRGF0YUZldGNoZWQ/LihcbiAgICAgICAgXCJnZXRQb3NpdGlvbnNCeUNhdGVnb3J5XCIsXG4gICAgICAgIHBvc2l0aW9ucy5sZW5ndGgsXG4gICAgICApO1xuICAgICAgcmV0dXJuIHBvc2l0aW9ucztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGdldCBwb3NpdGlvbnMgYnkgY2F0ZWdvcnlcIiwgZXJyb3IgYXMgRXJyb3IsIHtcbiAgICAgICAgY2F0ZWdvcnksXG4gICAgICB9KTtcbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25FcnJvcj8uKFwiZ2V0UG9zaXRpb25zQnlDYXRlZ29yeVwiLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0UG9zaXRpb25zQnlEaWZmaWN1bHR5KFxuICAgIGRpZmZpY3VsdHk6IEVuZGdhbWVQb3NpdGlvbltcImRpZmZpY3VsdHlcIl0sXG4gICk6IFByb21pc2U8RW5kZ2FtZVBvc2l0aW9uW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcG9zaXRpb25zUmVmID0gY29sbGVjdGlvbih0aGlzLmRiLCBcInBvc2l0aW9uc1wiKTtcbiAgICAgIGNvbnN0IHEgPSBxdWVyeShwb3NpdGlvbnNSZWYsIHdoZXJlKFwiZGlmZmljdWx0eVwiLCBcIj09XCIsIGRpZmZpY3VsdHkpKTtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcblxuICAgICAgY29uc3QgcG9zaXRpb25zOiBFbmRnYW1lUG9zaXRpb25bXSA9IFtdO1xuICAgICAgc25hcHNob3QuZm9yRWFjaCgoZG9jKSA9PiB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBkb2MuZGF0YSgpO1xuICAgICAgICBjb25zdCBwb3NpdGlvbjogRW5kZ2FtZVBvc2l0aW9uID0ge1xuICAgICAgICAgIC4uLmRhdGEsXG4gICAgICAgICAgaWQ6IHBhcnNlSW50KGRvYy5pZCksXG4gICAgICAgIH0gYXMgRW5kZ2FtZVBvc2l0aW9uO1xuICAgICAgICAvLyBWYWxpZGF0ZSBGRU5cbiAgICAgICAgaWYgKHBvc2l0aW9uLmZlbikge1xuICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZUFuZFNhbml0aXplRmVuKHBvc2l0aW9uLmZlbik7XG4gICAgICAgICAgaWYgKHZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICAgICAgcG9zaXRpb24uZmVuID0gdmFsaWRhdGlvbi5zYW5pdGl6ZWQ7XG4gICAgICAgICAgICBwb3NpdGlvbnMucHVzaChwb3NpdGlvbik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICAgICAgYEludmFsaWQgRkVOIGZvciBwb3NpdGlvbiAke3Bvc2l0aW9uLmlkfTogJHt2YWxpZGF0aW9uLmVycm9ycy5qb2luKFwiLCBcIil9YCxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBvc2l0aW9ucy5wdXNoKHBvc2l0aW9uKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25EYXRhRmV0Y2hlZD8uKFxuICAgICAgICBcImdldFBvc2l0aW9uc0J5RGlmZmljdWx0eVwiLFxuICAgICAgICBwb3NpdGlvbnMubGVuZ3RoLFxuICAgICAgKTtcbiAgICAgIHJldHVybiBwb3NpdGlvbnM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgcG9zaXRpb25zIGJ5IGRpZmZpY3VsdHlcIiwgZXJyb3IgYXMgRXJyb3IsIHtcbiAgICAgICAgZGlmZmljdWx0eSxcbiAgICAgIH0pO1xuICAgICAgdGhpcy5jb25maWcuZXZlbnRzPy5vbkVycm9yPy4oXCJnZXRQb3NpdGlvbnNCeURpZmZpY3VsdHlcIiwgZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFBvc2l0aW9uc0J5SWRzKGlkczogbnVtYmVyW10pOiBQcm9taXNlPEVuZGdhbWVQb3NpdGlvbltdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBvc2l0aW9ucyA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICBpZHMubWFwKChpZCkgPT4gdGhpcy5nZXRQb3NpdGlvbihpZCkpLFxuICAgICAgKTtcblxuICAgICAgY29uc3QgdmFsaWRQb3NpdGlvbnMgPSBwb3NpdGlvbnMuZmlsdGVyKFxuICAgICAgICAocCk6IHAgaXMgRW5kZ2FtZVBvc2l0aW9uID0+IHAgIT09IG51bGwsXG4gICAgICApO1xuICAgICAgdGhpcy5jb25maWcuZXZlbnRzPy5vbkRhdGFGZXRjaGVkPy4oXG4gICAgICAgIFwiZ2V0UG9zaXRpb25zQnlJZHNcIixcbiAgICAgICAgdmFsaWRQb3NpdGlvbnMubGVuZ3RoLFxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHZhbGlkUG9zaXRpb25zO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZ2V0IHBvc2l0aW9ucyBieSBpZHNcIiwgZXJyb3IgYXMgRXJyb3IsIHsgaWRzIH0pO1xuICAgICAgdGhpcy5jb25maWcuZXZlbnRzPy5vbkVycm9yPy4oXCJnZXRQb3NpdGlvbnNCeUlkc1wiLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2VhcmNoUG9zaXRpb25zKHNlYXJjaFRlcm06IHN0cmluZyk6IFByb21pc2U8RW5kZ2FtZVBvc2l0aW9uW10+IHtcbiAgICB0cnkge1xuICAgICAgLy8gRmlyZXN0b3JlIGRvZXNuJ3Qgc3VwcG9ydCBmdWxsLXRleHQgc2VhcmNoIG5hdGl2ZWx5XG4gICAgICAvLyBGb3IgcHJvZHVjdGlvbiwgY29uc2lkZXIgQWxnb2xpYSBvciBFbGFzdGljc2VhcmNoXG4gICAgICBjb25zdCBwb3NpdGlvbnMgPSBhd2FpdCB0aGlzLmdldEFsbFBvc2l0aW9ucygpO1xuICAgICAgY29uc3QgbG93ZXJTZWFyY2ggPSBzZWFyY2hUZXJtLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBwb3NpdGlvbnMuZmlsdGVyKFxuICAgICAgICAocCkgPT5cbiAgICAgICAgICBwLnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJTZWFyY2gpIHx8XG4gICAgICAgICAgcC5kZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyU2VhcmNoKSxcbiAgICAgICk7XG5cbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25EYXRhRmV0Y2hlZD8uKFwic2VhcmNoUG9zaXRpb25zXCIsIHJlc3VsdHMubGVuZ3RoKTtcbiAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gc2VhcmNoIHBvc2l0aW9uc1wiLCBlcnJvciBhcyBFcnJvciwge1xuICAgICAgICBzZWFyY2hUZXJtLFxuICAgICAgfSk7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRXJyb3I/LihcInNlYXJjaFBvc2l0aW9uc1wiLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0UG9zaXRpb25zQnlUYWdzKF90YWdzOiBzdHJpbmdbXSk6IFByb21pc2U8RW5kZ2FtZVBvc2l0aW9uW10+IHtcbiAgICAvLyBUYWdzIGFyZSBub3QgeWV0IGltcGxlbWVudGVkIGluIEVuZGdhbWVQb3NpdGlvbiB0eXBlXG4gICAgLy8gUmV0dXJuIGVtcHR5IGFycmF5IGZvciBub3dcbiAgICBsb2dnZXIud2FybihcbiAgICAgIFwiZ2V0UG9zaXRpb25zQnlUYWdzOiB0YWdzIHByb3BlcnR5IG5vdCB5ZXQgaW1wbGVtZW50ZWQgaW4gRW5kZ2FtZVBvc2l0aW9uXCIsXG4gICAgKTtcbiAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRGF0YUZldGNoZWQ/LihcImdldFBvc2l0aW9uc0J5VGFnc1wiLCAwKTtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBhc3luYyBnZXROZXh0UG9zaXRpb24oXG4gICAgY3VycmVudElkOiBudW1iZXIsXG4gICAgY2F0ZWdvcnlJZD86IHN0cmluZyxcbiAgKTogUHJvbWlzZTxFbmRnYW1lUG9zaXRpb24gfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBvc2l0aW9uc1JlZiA9IGNvbGxlY3Rpb24odGhpcy5kYiwgXCJwb3NpdGlvbnNcIik7XG4gICAgICBsZXQgcTogUXVlcnk8RG9jdW1lbnREYXRhPjtcblxuICAgICAgaWYgKGNhdGVnb3J5SWQpIHtcbiAgICAgICAgcSA9IHF1ZXJ5KFxuICAgICAgICAgIHBvc2l0aW9uc1JlZixcbiAgICAgICAgICB3aGVyZShcImNhdGVnb3J5XCIsIFwiPT1cIiwgY2F0ZWdvcnlJZCksXG4gICAgICAgICAgd2hlcmUoXCJpZFwiLCBcIj5cIiwgY3VycmVudElkKSxcbiAgICAgICAgICBvcmRlckJ5KFwiaWRcIiksXG4gICAgICAgICAgbGltaXQoMSksXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBxID0gcXVlcnkoXG4gICAgICAgICAgcG9zaXRpb25zUmVmLFxuICAgICAgICAgIHdoZXJlKFwiaWRcIiwgXCI+XCIsIGN1cnJlbnRJZCksXG4gICAgICAgICAgb3JkZXJCeShcImlkXCIpLFxuICAgICAgICAgIGxpbWl0KDEpLFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XG5cbiAgICAgIGlmIChzbmFwc2hvdC5lbXB0eSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IHNuYXBzaG90LmRvY3NbMF0uZGF0YSgpO1xuICAgICAgY29uc3QgcG9zaXRpb246IEVuZGdhbWVQb3NpdGlvbiA9IHtcbiAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgaWQ6IHBhcnNlSW50KHNuYXBzaG90LmRvY3NbMF0uaWQpLFxuICAgICAgfSBhcyBFbmRnYW1lUG9zaXRpb247XG5cbiAgICAgIC8vIFZhbGlkYXRlIEZFTlxuICAgICAgaWYgKHBvc2l0aW9uLmZlbikge1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdmFsaWRhdGVBbmRTYW5pdGl6ZUZlbihwb3NpdGlvbi5mZW4pO1xuICAgICAgICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICAgIGBJbnZhbGlkIEZFTiBmb3IgcG9zaXRpb24gJHtwb3NpdGlvbi5pZH06ICR7dmFsaWRhdGlvbi5lcnJvcnMuam9pbihcIiwgXCIpfWAsXG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBwb3NpdGlvbi5mZW4gPSB2YWxpZGF0aW9uLnNhbml0aXplZDtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jb25maWcuZXZlbnRzPy5vbkRhdGFGZXRjaGVkPy4oXCJnZXROZXh0UG9zaXRpb25cIiwgMSk7XG4gICAgICByZXR1cm4gcG9zaXRpb247XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgbmV4dCBwb3NpdGlvblwiLCBlcnJvciBhcyBFcnJvciwge1xuICAgICAgICBjdXJyZW50SWQsXG4gICAgICAgIGNhdGVnb3J5SWQsXG4gICAgICB9KTtcbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25FcnJvcj8uKFwiZ2V0TmV4dFBvc2l0aW9uXCIsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFByZXZpb3VzUG9zaXRpb24oXG4gICAgY3VycmVudElkOiBudW1iZXIsXG4gICAgY2F0ZWdvcnlJZD86IHN0cmluZyxcbiAgKTogUHJvbWlzZTxFbmRnYW1lUG9zaXRpb24gfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBvc2l0aW9uc1JlZiA9IGNvbGxlY3Rpb24odGhpcy5kYiwgXCJwb3NpdGlvbnNcIik7XG4gICAgICBsZXQgcTogUXVlcnk8RG9jdW1lbnREYXRhPjtcblxuICAgICAgaWYgKGNhdGVnb3J5SWQpIHtcbiAgICAgICAgcSA9IHF1ZXJ5KFxuICAgICAgICAgIHBvc2l0aW9uc1JlZixcbiAgICAgICAgICB3aGVyZShcImNhdGVnb3J5XCIsIFwiPT1cIiwgY2F0ZWdvcnlJZCksXG4gICAgICAgICAgd2hlcmUoXCJpZFwiLCBcIjxcIiwgY3VycmVudElkKSxcbiAgICAgICAgICBvcmRlckJ5KFwiaWRcIiwgXCJkZXNjXCIpLFxuICAgICAgICAgIGxpbWl0KDEpLFxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcSA9IHF1ZXJ5KFxuICAgICAgICAgIHBvc2l0aW9uc1JlZixcbiAgICAgICAgICB3aGVyZShcImlkXCIsIFwiPFwiLCBjdXJyZW50SWQpLFxuICAgICAgICAgIG9yZGVyQnkoXCJpZFwiLCBcImRlc2NcIiksXG4gICAgICAgICAgbGltaXQoMSksXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcblxuICAgICAgaWYgKHNuYXBzaG90LmVtcHR5KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gc25hcHNob3QuZG9jc1swXS5kYXRhKCk7XG4gICAgICBjb25zdCBwb3NpdGlvbjogRW5kZ2FtZVBvc2l0aW9uID0ge1xuICAgICAgICAuLi5kYXRhLFxuICAgICAgICBpZDogcGFyc2VJbnQoc25hcHNob3QuZG9jc1swXS5pZCksXG4gICAgICB9IGFzIEVuZGdhbWVQb3NpdGlvbjtcblxuICAgICAgLy8gVmFsaWRhdGUgRkVOXG4gICAgICBpZiAocG9zaXRpb24uZmVuKSB7XG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZUFuZFNhbml0aXplRmVuKHBvc2l0aW9uLmZlbik7XG4gICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgICAgYEludmFsaWQgRkVOIGZvciBwb3NpdGlvbiAke3Bvc2l0aW9uLmlkfTogJHt2YWxpZGF0aW9uLmVycm9ycy5qb2luKFwiLCBcIil9YCxcbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHBvc2l0aW9uLmZlbiA9IHZhbGlkYXRpb24uc2FuaXRpemVkO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRGF0YUZldGNoZWQ/LihcImdldFByZXZpb3VzUG9zaXRpb25cIiwgMSk7XG4gICAgICByZXR1cm4gcG9zaXRpb247XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgcHJldmlvdXMgcG9zaXRpb25cIiwgZXJyb3IgYXMgRXJyb3IsIHtcbiAgICAgICAgY3VycmVudElkLFxuICAgICAgICBjYXRlZ29yeUlkLFxuICAgICAgfSk7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRXJyb3I/LihcImdldFByZXZpb3VzUG9zaXRpb25cIiwgZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0Q2F0ZWdvcmllcygpOiBQcm9taXNlPEVuZGdhbWVDYXRlZ29yeVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNhdGVnb3JpZXNSZWYgPSBjb2xsZWN0aW9uKHRoaXMuZGIsIFwiY2F0ZWdvcmllc1wiKTtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhjYXRlZ29yaWVzUmVmKTtcblxuICAgICAgY29uc3QgY2F0ZWdvcmllczogRW5kZ2FtZUNhdGVnb3J5W10gPSBbXTtcbiAgICAgIHNuYXBzaG90LmZvckVhY2goKGRvYykgPT4ge1xuICAgICAgICBjYXRlZ29yaWVzLnB1c2goZG9jLmRhdGEoKSBhcyBFbmRnYW1lQ2F0ZWdvcnkpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25EYXRhRmV0Y2hlZD8uKFwiZ2V0Q2F0ZWdvcmllc1wiLCBjYXRlZ29yaWVzLmxlbmd0aCk7XG4gICAgICByZXR1cm4gY2F0ZWdvcmllcztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGdldCBjYXRlZ29yaWVzXCIsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25FcnJvcj8uKFwiZ2V0Q2F0ZWdvcmllc1wiLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0Q2F0ZWdvcnkoaWQ6IHN0cmluZyk6IFByb21pc2U8RW5kZ2FtZUNhdGVnb3J5IHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBkb2NSZWYgPSBkb2ModGhpcy5kYiwgXCJjYXRlZ29yaWVzXCIsIGlkKTtcbiAgICAgIGNvbnN0IGRvY1NuYXAgPSBhd2FpdCBnZXREb2MoZG9jUmVmKTtcblxuICAgICAgaWYgKGRvY1NuYXAuZXhpc3RzKCkpIHtcbiAgICAgICAgdGhpcy5jb25maWcuZXZlbnRzPy5vbkRhdGFGZXRjaGVkPy4oXCJnZXRDYXRlZ29yeVwiLCAxKTtcbiAgICAgICAgcmV0dXJuIGRvY1NuYXAuZGF0YSgpIGFzIEVuZGdhbWVDYXRlZ29yeTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgY2F0ZWdvcnlcIiwgZXJyb3IgYXMgRXJyb3IsIHsgaWQgfSk7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRXJyb3I/LihcImdldENhdGVnb3J5XCIsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldENoYXB0ZXJzKCk6IFByb21pc2U8RW5kZ2FtZUNoYXB0ZXJbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjaGFwdGVyc1JlZiA9IGNvbGxlY3Rpb24odGhpcy5kYiwgXCJjaGFwdGVyc1wiKTtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhjaGFwdGVyc1JlZik7XG5cbiAgICAgIGNvbnN0IGNoYXB0ZXJzOiBFbmRnYW1lQ2hhcHRlcltdID0gW107XG4gICAgICBzbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHtcbiAgICAgICAgY2hhcHRlcnMucHVzaChkb2MuZGF0YSgpIGFzIEVuZGdhbWVDaGFwdGVyKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRGF0YUZldGNoZWQ/LihcImdldENoYXB0ZXJzXCIsIGNoYXB0ZXJzLmxlbmd0aCk7XG4gICAgICByZXR1cm4gY2hhcHRlcnM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgY2hhcHRlcnNcIiwgZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgdGhpcy5jb25maWcuZXZlbnRzPy5vbkVycm9yPy4oXCJnZXRDaGFwdGVyc1wiLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0Q2hhcHRlcnNCeUNhdGVnb3J5KGNhdGVnb3J5SWQ6IHN0cmluZyk6IFByb21pc2U8RW5kZ2FtZUNoYXB0ZXJbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjaGFwdGVyc1JlZiA9IGNvbGxlY3Rpb24odGhpcy5kYiwgXCJjaGFwdGVyc1wiKTtcbiAgICAgIGNvbnN0IHEgPSBxdWVyeShjaGFwdGVyc1JlZiwgd2hlcmUoXCJjYXRlZ29yeVwiLCBcIj09XCIsIGNhdGVnb3J5SWQpKTtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcblxuICAgICAgY29uc3QgY2hhcHRlcnM6IEVuZGdhbWVDaGFwdGVyW10gPSBbXTtcbiAgICAgIHNuYXBzaG90LmZvckVhY2goKGRvYykgPT4ge1xuICAgICAgICBjaGFwdGVycy5wdXNoKGRvYy5kYXRhKCkgYXMgRW5kZ2FtZUNoYXB0ZXIpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25EYXRhRmV0Y2hlZD8uKFxuICAgICAgICBcImdldENoYXB0ZXJzQnlDYXRlZ29yeVwiLFxuICAgICAgICBjaGFwdGVycy5sZW5ndGgsXG4gICAgICApO1xuICAgICAgcmV0dXJuIGNoYXB0ZXJzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZ2V0IGNoYXB0ZXJzIGJ5IGNhdGVnb3J5XCIsIGVycm9yIGFzIEVycm9yLCB7XG4gICAgICAgIGNhdGVnb3J5SWQsXG4gICAgICB9KTtcbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25FcnJvcj8uKFwiZ2V0Q2hhcHRlcnNCeUNhdGVnb3J5XCIsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRUb3RhbFBvc2l0aW9uQ291bnQoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcG9zaXRpb25zUmVmID0gY29sbGVjdGlvbih0aGlzLmRiLCBcInBvc2l0aW9uc1wiKTtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhwb3NpdGlvbnNSZWYpO1xuXG4gICAgICBjb25zdCBjb3VudCA9IHNuYXBzaG90LnNpemU7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRGF0YUZldGNoZWQ/LihcImdldFRvdGFsUG9zaXRpb25Db3VudFwiLCBjb3VudCk7XG5cbiAgICAgIHJldHVybiBjb3VudDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGdldCB0b3RhbCBwb3NpdGlvbiBjb3VudFwiLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRXJyb3I/LihcImdldFRvdGFsUG9zaXRpb25Db3VudFwiLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRQb3NpdGlvbkNvdW50QnlDYXRlZ29yeShjYXRlZ29yeUlkOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwb3NpdGlvbnNSZWYgPSBjb2xsZWN0aW9uKHRoaXMuZGIsIFwicG9zaXRpb25zXCIpO1xuICAgICAgY29uc3QgcSA9IHF1ZXJ5KHBvc2l0aW9uc1JlZiwgd2hlcmUoXCJjYXRlZ29yeVwiLCBcIj09XCIsIGNhdGVnb3J5SWQpKTtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcblxuICAgICAgY29uc3QgY291bnQgPSBzbmFwc2hvdC5zaXplO1xuICAgICAgdGhpcy5jb25maWcuZXZlbnRzPy5vbkRhdGFGZXRjaGVkPy4oXCJnZXRQb3NpdGlvbkNvdW50QnlDYXRlZ29yeVwiLCBjb3VudCk7XG5cbiAgICAgIHJldHVybiBjb3VudDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGdldCBwb3NpdGlvbiBjb3VudCBieSBjYXRlZ29yeVwiLCBlcnJvciBhcyBFcnJvciwge1xuICAgICAgICBjYXRlZ29yeUlkLFxuICAgICAgfSk7XG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRXJyb3I/LihcbiAgICAgICAgXCJnZXRQb3NpdGlvbkNvdW50QnlDYXRlZ29yeVwiLFxuICAgICAgICBlcnJvciBhcyBFcnJvcixcbiAgICAgICk7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRQb3NpdGlvbkNvdW50QnlEaWZmaWN1bHR5KFxuICAgIGRpZmZpY3VsdHk6IEVuZGdhbWVQb3NpdGlvbltcImRpZmZpY3VsdHlcIl0sXG4gICk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBvc2l0aW9uc1JlZiA9IGNvbGxlY3Rpb24odGhpcy5kYiwgXCJwb3NpdGlvbnNcIik7XG4gICAgICBjb25zdCBxID0gcXVlcnkocG9zaXRpb25zUmVmLCB3aGVyZShcImRpZmZpY3VsdHlcIiwgXCI9PVwiLCBkaWZmaWN1bHR5KSk7XG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XG5cbiAgICAgIGNvbnN0IGNvdW50ID0gc25hcHNob3Quc2l6ZTtcbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25EYXRhRmV0Y2hlZD8uKFxuICAgICAgICBcImdldFBvc2l0aW9uQ291bnRCeURpZmZpY3VsdHlcIixcbiAgICAgICAgY291bnQsXG4gICAgICApO1xuXG4gICAgICByZXR1cm4gY291bnQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJGYWlsZWQgdG8gZ2V0IHBvc2l0aW9uIGNvdW50IGJ5IGRpZmZpY3VsdHlcIixcbiAgICAgICAgZXJyb3IgYXMgRXJyb3IsXG4gICAgICAgIHsgZGlmZmljdWx0eSB9LFxuICAgICAgKTtcbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25FcnJvcj8uKFxuICAgICAgICBcImdldFBvc2l0aW9uQ291bnRCeURpZmZpY3VsdHlcIixcbiAgICAgICAgZXJyb3IgYXMgRXJyb3IsXG4gICAgICApO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYmF0Y2hDcmVhdGVQb3NpdGlvbnMoXG4gICAgcG9zaXRpb25zOiBPbWl0PEVuZGdhbWVQb3NpdGlvbiwgXCJpZFwiPltdLFxuICApOiBQcm9taXNlPEVuZGdhbWVQb3NpdGlvbltdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGJhdGNoID0gd3JpdGVCYXRjaCh0aGlzLmRiKTtcbiAgICAgIGNvbnN0IGNyZWF0ZWRQb3NpdGlvbnM6IEVuZGdhbWVQb3NpdGlvbltdID0gW107XG5cbiAgICAgIGZvciAoY29uc3QgZGF0YSBvZiBwb3NpdGlvbnMpIHtcbiAgICAgICAgLy8gR2VuZXJhdGUgdW5pcXVlIElEIHVzaW5nIGNyeXB0by5yYW5kb21VVUlEIGZvciBlYWNoIHBvc2l0aW9uXG4gICAgICAgIGNvbnN0IHVuaXF1ZUlkID0gY3J5cHRvLnJhbmRvbVVVSUQoKTtcbiAgICAgICAgY29uc3QgaWQgPSBNYXRoLmFicyhcbiAgICAgICAgICB1bmlxdWVJZC5zcGxpdChcIlwiKS5yZWR1Y2UoKGEsIGIpID0+IHtcbiAgICAgICAgICAgIGEgPSAoYSA8PCA1KSAtIGEgKyBiLmNoYXJDb2RlQXQoMCk7XG4gICAgICAgICAgICByZXR1cm4gYSAmIGE7XG4gICAgICAgICAgfSwgMCksXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHBvc2l0aW9uOiBFbmRnYW1lUG9zaXRpb24gPSB7IC4uLmRhdGEsIGlkIH07XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgRkVOXG4gICAgICAgIGlmIChwb3NpdGlvbi5mZW4pIHtcbiAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdmFsaWRhdGVBbmRTYW5pdGl6ZUZlbihwb3NpdGlvbi5mZW4pO1xuICAgICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgIGBJbnZhbGlkIEZFTiBmb3IgcG9zaXRpb246ICR7dmFsaWRhdGlvbi5lcnJvcnMuam9pbihcIiwgXCIpfWAsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwb3NpdGlvbi5mZW4gPSB2YWxpZGF0aW9uLnNhbml0aXplZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRvY1JlZiA9IGRvYyh0aGlzLmRiLCBcInBvc2l0aW9uc1wiLCBpZC50b1N0cmluZygpKTtcbiAgICAgICAgYmF0Y2guc2V0KGRvY1JlZiwgcG9zaXRpb24pO1xuICAgICAgICBjcmVhdGVkUG9zaXRpb25zLnB1c2gocG9zaXRpb24pO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCBiYXRjaC5jb21taXQoKTtcblxuICAgICAgY29uc3QgaWRzID0gY3JlYXRlZFBvc2l0aW9ucy5tYXAoKHApID0+IHAuaWQpO1xuICAgICAgdGhpcy5jb25maWcuZXZlbnRzPy5vbkRhdGFNb2RpZmllZD8uKFwiYmF0Y2hDcmVhdGVQb3NpdGlvbnNcIiwgaWRzKTtcblxuICAgICAgcmV0dXJuIGNyZWF0ZWRQb3NpdGlvbnM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBiYXRjaCBjcmVhdGUgcG9zaXRpb25zXCIsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25FcnJvcj8uKFwiYmF0Y2hDcmVhdGVQb3NpdGlvbnNcIiwgZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYmF0Y2hVcGRhdGVQb3NpdGlvbnMoXG4gICAgdXBkYXRlczogQXJyYXk8eyBpZDogbnVtYmVyOyB1cGRhdGVzOiBQYXJ0aWFsPEVuZGdhbWVQb3NpdGlvbj4gfT4sXG4gICk6IFByb21pc2U8RW5kZ2FtZVBvc2l0aW9uW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYmF0Y2ggPSB3cml0ZUJhdGNoKHRoaXMuZGIpO1xuICAgICAgY29uc3QgaWRzOiBudW1iZXJbXSA9IFtdO1xuXG4gICAgICBmb3IgKGNvbnN0IHsgaWQsIHVwZGF0ZXM6IHVwZGF0ZURhdGEgfSBvZiB1cGRhdGVzKSB7XG4gICAgICAgIC8vIFZhbGlkYXRlIEZFTiBpZiBwcm92aWRlZFxuICAgICAgICBpZiAodXBkYXRlRGF0YS5mZW4pIHtcbiAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdmFsaWRhdGVBbmRTYW5pdGl6ZUZlbih1cGRhdGVEYXRhLmZlbik7XG4gICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgYEludmFsaWQgRkVOIGZvciBwb3NpdGlvbiAke2lkfTogJHt2YWxpZGF0aW9uLmVycm9ycy5qb2luKFwiLCBcIil9YCxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHVwZGF0ZURhdGEuZmVuID0gdmFsaWRhdGlvbi5zYW5pdGl6ZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkb2NSZWYgPSBkb2ModGhpcy5kYiwgXCJwb3NpdGlvbnNcIiwgaWQudG9TdHJpbmcoKSk7XG4gICAgICAgIGJhdGNoLnVwZGF0ZShkb2NSZWYsIHVwZGF0ZURhdGEgYXMgRG9jdW1lbnREYXRhKTtcbiAgICAgICAgaWRzLnB1c2goaWQpO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCBiYXRjaC5jb21taXQoKTtcblxuICAgICAgdGhpcy5jb25maWcuZXZlbnRzPy5vbkRhdGFNb2RpZmllZD8uKFwiYmF0Y2hVcGRhdGVQb3NpdGlvbnNcIiwgaWRzKTtcbiAgICAgIHJldHVybiB0aGlzLmdldFBvc2l0aW9uc0J5SWRzKGlkcyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBiYXRjaCB1cGRhdGUgcG9zaXRpb25zXCIsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25FcnJvcj8uKFwiYmF0Y2hVcGRhdGVQb3NpdGlvbnNcIiwgZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYmF0Y2hEZWxldGVQb3NpdGlvbnMoaWRzOiBudW1iZXJbXSk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBiYXRjaCA9IHdyaXRlQmF0Y2godGhpcy5kYik7XG5cbiAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XG4gICAgICAgIGNvbnN0IGRvY1JlZiA9IGRvYyh0aGlzLmRiLCBcInBvc2l0aW9uc1wiLCBpZC50b1N0cmluZygpKTtcbiAgICAgICAgYmF0Y2guZGVsZXRlKGRvY1JlZik7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IGJhdGNoLmNvbW1pdCgpO1xuXG4gICAgICB0aGlzLmNvbmZpZy5ldmVudHM/Lm9uRGF0YU1vZGlmaWVkPy4oXCJiYXRjaERlbGV0ZVBvc2l0aW9uc1wiLCBpZHMpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBiYXRjaCBkZWxldGUgcG9zaXRpb25zXCIsIGVycm9yIGFzIEVycm9yLCB7IGlkcyB9KTtcbiAgICAgIHRoaXMuY29uZmlnLmV2ZW50cz8ub25FcnJvcj8uKFwiYmF0Y2hEZWxldGVQb3NpdGlvbnNcIiwgZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbIkZpcmViYXNlUG9zaXRpb25SZXBvc2l0b3J5IiwibG9nZ2VyIiwiZ2V0TG9nZ2VyIiwic2V0Q29udGV4dCIsImdldFBvc2l0aW9uIiwiaWQiLCJkb2NSZWYiLCJkb2MiLCJkYiIsInRvU3RyaW5nIiwiZG9jU25hcCIsImdldERvYyIsImV4aXN0cyIsImRhdGEiLCJwb3NpdGlvbiIsImZlbiIsInZhbGlkYXRpb24iLCJ2YWxpZGF0ZUFuZFNhbml0aXplRmVuIiwiaXNWYWxpZCIsImVycm9yIiwiZXJyb3JzIiwiam9pbiIsIkVycm9yIiwic2FuaXRpemVkIiwiY29uZmlnIiwiZXZlbnRzIiwib25EYXRhRmV0Y2hlZCIsIndhcm4iLCJvbkVycm9yIiwiY3JlYXRlUG9zaXRpb24iLCJ1bmlxdWVJZCIsImNyeXB0byIsInJhbmRvbVVVSUQiLCJNYXRoIiwiYWJzIiwic3BsaXQiLCJyZWR1Y2UiLCJhIiwiYiIsImNoYXJDb2RlQXQiLCJzZXREb2MiLCJvbkRhdGFNb2RpZmllZCIsInVwZGF0ZVBvc2l0aW9uIiwidXBkYXRlcyIsInVwZGF0ZURvYyIsImRlbGV0ZVBvc2l0aW9uIiwiZGVsZXRlRG9jIiwiZ2V0QWxsUG9zaXRpb25zIiwicG9zaXRpb25zUmVmIiwiY29sbGVjdGlvbiIsInNuYXBzaG90IiwiZ2V0RG9jcyIsInBvc2l0aW9ucyIsImZvckVhY2giLCJwYXJzZUludCIsInB1c2giLCJsZW5ndGgiLCJnZXRQb3NpdGlvbnNCeUNhdGVnb3J5IiwiY2F0ZWdvcnkiLCJxIiwicXVlcnkiLCJ3aGVyZSIsImdldFBvc2l0aW9uc0J5RGlmZmljdWx0eSIsImRpZmZpY3VsdHkiLCJnZXRQb3NpdGlvbnNCeUlkcyIsImlkcyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJ2YWxpZFBvc2l0aW9ucyIsImZpbHRlciIsInAiLCJzZWFyY2hQb3NpdGlvbnMiLCJzZWFyY2hUZXJtIiwibG93ZXJTZWFyY2giLCJ0b0xvd2VyQ2FzZSIsInJlc3VsdHMiLCJ0aXRsZSIsImluY2x1ZGVzIiwiZGVzY3JpcHRpb24iLCJnZXRQb3NpdGlvbnNCeVRhZ3MiLCJfdGFncyIsImdldE5leHRQb3NpdGlvbiIsImN1cnJlbnRJZCIsImNhdGVnb3J5SWQiLCJvcmRlckJ5IiwibGltaXQiLCJlbXB0eSIsImRvY3MiLCJnZXRQcmV2aW91c1Bvc2l0aW9uIiwiZ2V0Q2F0ZWdvcmllcyIsImNhdGVnb3JpZXNSZWYiLCJjYXRlZ29yaWVzIiwiZ2V0Q2F0ZWdvcnkiLCJnZXRDaGFwdGVycyIsImNoYXB0ZXJzUmVmIiwiY2hhcHRlcnMiLCJnZXRDaGFwdGVyc0J5Q2F0ZWdvcnkiLCJnZXRUb3RhbFBvc2l0aW9uQ291bnQiLCJjb3VudCIsInNpemUiLCJnZXRQb3NpdGlvbkNvdW50QnlDYXRlZ29yeSIsImdldFBvc2l0aW9uQ291bnRCeURpZmZpY3VsdHkiLCJiYXRjaENyZWF0ZVBvc2l0aW9ucyIsImJhdGNoIiwid3JpdGVCYXRjaCIsImNyZWF0ZWRQb3NpdGlvbnMiLCJzZXQiLCJjb21taXQiLCJiYXRjaFVwZGF0ZVBvc2l0aW9ucyIsInVwZGF0ZURhdGEiLCJ1cGRhdGUiLCJiYXRjaERlbGV0ZVBvc2l0aW9ucyIsImRlbGV0ZSIsImZpcmVzdG9yZSIsImluZm8iXSwibWFwcGluZ3MiOiJBQUFBOzs7Q0FHQzs7OzsrQkFrQ1lBOzs7ZUFBQUE7OzsyQkFoQk47OEJBV2dDO3lCQUNiOzs7Ozs7Ozs7Ozs7OztBQUUxQixNQUFNQyxTQUFTQyxJQUFBQSxrQkFBUyxJQUFHQyxVQUFVLENBQUM7QUFFL0IsTUFBTUg7SUFVWCxNQUFNSSxZQUFZQyxFQUFVLEVBQW1DO1FBQzdELElBQUk7WUFDRixNQUFNQyxTQUFTQyxJQUFBQSxjQUFHLEVBQUMsSUFBSSxDQUFDQyxFQUFFLEVBQUUsYUFBYUgsR0FBR0ksUUFBUTtZQUNwRCxNQUFNQyxVQUFVLE1BQU1DLElBQUFBLGlCQUFNLEVBQUNMO1lBRTdCLElBQUlJLFFBQVFFLE1BQU0sSUFBSTtvQkFjcEIsbUNBQUE7Z0JBYkEsTUFBTUMsT0FBT0gsUUFBUUcsSUFBSTtnQkFDekIsTUFBTUMsV0FBNEI7b0JBQUUsR0FBR0QsSUFBSTtvQkFBRVI7Z0JBQUc7Z0JBQ2hELGVBQWU7Z0JBQ2YsSUFBSVMsU0FBU0MsR0FBRyxFQUFFO29CQUNoQixNQUFNQyxhQUFhQyxJQUFBQSxvQ0FB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