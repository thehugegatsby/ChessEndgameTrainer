1c7e00014f553fd4d7854be09ddac6a6
/**
 * @file Unit tests for MoveStrategyService
 * @module tests/unit/services/MoveStrategyService.test
 * 
 * @description
 * Comprehensive test suite for MoveStrategyService which provides
 * different chess move selection strategies for opponent play.
 * Tests all three strategies: longest resistance, best move, and human-like.
 * 
 * @see {@link MoveStrategyService} - Service being tested
 * @see {@link TablebaseService} - Mocked dependency
 */ "use strict";
// Mock dependencies BEFORE importing the service
jest.mock('@shared/services/logging', ()=>{
    const mockLoggerInstance = {
        error: jest.fn(),
        warn: jest.fn(),
        debug: jest.fn(),
        setContext: jest.fn(function() {
            return this;
        })
    };
    mockLoggerInstance.setContext.mockReturnValue(mockLoggerInstance);
    return {
        getLogger: jest.fn(()=>mockLoggerInstance),
        /**
     * Helper to access mock logger instance in tests
     * @returns Mock logger instance
     */ __getMockLogger: ()=>mockLoggerInstance
    };
});
jest.mock('@shared/services/TablebaseService');
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _MoveStrategyService = require("../../../shared/services/MoveStrategyService");
const _TablebaseService = require("../../../shared/services/TablebaseService");
// Get the mock logger instance
const { __getMockLogger } = require('@shared/services/logging');
const mockLogger = __getMockLogger();
const mockTablebaseService = _TablebaseService.tablebaseService;
/**
 * Create a mock TablebaseMove object for testing
 * 
 * @param overrides - Partial move properties to override defaults
 * @returns Complete TablebaseMove object
 */ const createMockMove = (overrides)=>({
        uci: 'e2e4',
        san: 'e4',
        wdl: 0,
        dtz: 0,
        dtm: null,
        category: 'draw',
        ...overrides
    });
/**
 * Create a successful tablebase response with moves
 * 
 * @param moves - Array of moves to include in response
 * @returns Mocked tablebase response object
 */ const createMockResponse = (moves)=>({
        isAvailable: true,
        moves
    });
describe('MoveStrategyService', ()=>{
    const testFen = 'K7/P7/k7/8/8/8/8/8 w - - 0 1';
    beforeEach(()=>{
        jest.clearAllMocks();
        mockLogger.error.mockClear();
        mockLogger.warn.mockClear();
        mockLogger.debug.mockClear();
    });
    describe('getLongestResistanceMove', ()=>{
        it('returns longest resistance move for losing position', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'a7a8q',
                    san: 'a8=Q',
                    wdl: -2,
                    dtm: -15,
                    dtz: -12
                }),
                createMockMove({
                    uci: 'a7a8r',
                    san: 'a8=R',
                    wdl: -2,
                    dtm: -8,
                    dtz: -10
                }),
                createMockMove({
                    uci: 'a8b7',
                    san: 'Kb7',
                    wdl: -2,
                    dtm: -20,
                    dtz: -15
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const result = await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect(result).toBe('a8b7'); // Highest DTM (20) for longest resistance
            expect(mockTablebaseService.getTopMoves).toHaveBeenCalledWith(testFen, 100);
        });
        it('returns fastest win for winning position', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'a7b6',
                    san: 'Kb6',
                    wdl: 2,
                    dtm: 5,
                    dtz: 3
                }),
                createMockMove({
                    uci: 'a7b7',
                    san: 'Kb7',
                    wdl: 2,
                    dtm: 8,
                    dtz: 5
                }),
                createMockMove({
                    uci: 'a7a6',
                    san: 'Ka6',
                    wdl: 2,
                    dtm: 3,
                    dtz: 2
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const result = await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect(result).toBe('a7a6'); // Lowest DTZ (2) for fastest win
        });
        it('returns any drawing move for drawn position', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'a7b6',
                    san: 'Kb6',
                    wdl: 0,
                    dtm: null,
                    dtz: 0
                }),
                createMockMove({
                    uci: 'a7b7',
                    san: 'Kb7',
                    wdl: 0,
                    dtm: null,
                    dtz: 0
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const result = await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect([
                'a7b6',
                'a7b7'
            ]).toContain(result);
        });
        it('prefers DTM over DTZ for losing positions when available', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'move1',
                    san: 'Move1',
                    wdl: -2,
                    dtm: -10,
                    dtz: -20
                }),
                createMockMove({
                    uci: 'move2',
                    san: 'Move2',
                    wdl: -2,
                    dtm: -15,
                    dtz: -5
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const result = await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect(result).toBe('move2'); // Higher DTM (15) despite lower DTZ
        });
        it('falls back to DTZ when DTM is not available', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'move1',
                    san: 'Move1',
                    wdl: -2,
                    dtm: null,
                    dtz: -10
                }),
                createMockMove({
                    uci: 'move2',
                    san: 'Move2',
                    wdl: -2,
                    dtm: null,
                    dtz: -20
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const result = await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect(result).toBe('move2'); // Higher DTZ (20) when DTM unavailable
        });
        it('handles empty moves array', async ()=>{
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse([]));
            const result = await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect(result).toBeNull();
            expect(mockLogger.warn).toHaveBeenCalledWith('No tablebase moves available for position', {
                fen: testFen
            });
        });
        it('handles tablebase not available', async ()=>{
            mockTablebaseService.getTopMoves.mockResolvedValue({
                isAvailable: false
            });
            const result = await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect(result).toBeNull();
        });
        it('handles tablebase service error gracefully', async ()=>{
            const error = new Error('Tablebase API error');
            mockTablebaseService.getTopMoves.mockRejectedValue(error);
            const result = await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect(result).toBeNull();
            expect(mockLogger.error).toHaveBeenCalledWith('Failed to get longest resistance move', error, {
                fen: testFen
            });
        });
        it('uses secondary criterion DTZ when DTM is equal', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'move1',
                    san: 'Move1',
                    wdl: -2,
                    dtm: -10,
                    dtz: -5
                }),
                createMockMove({
                    uci: 'move2',
                    san: 'Move2',
                    wdl: -2,
                    dtm: -10,
                    dtz: -8
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const result = await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect(result).toBe('move2'); // Same DTM, higher DTZ wins
        });
    });
    describe('getBestMove', ()=>{
        it('returns objectively best move', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'a7a8q',
                    san: 'a8=Q',
                    wdl: 2,
                    dtm: 5,
                    dtz: 3
                }),
                createMockMove({
                    uci: 'a7a8r',
                    san: 'a8=R',
                    wdl: 2,
                    dtm: 8,
                    dtz: 5
                }),
                createMockMove({
                    uci: 'a7b6',
                    san: 'Kb6',
                    wdl: 1,
                    dtm: 12,
                    dtz: 8
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const result = await _MoveStrategyService.moveStrategyService.getBestMove(testFen);
            expect(result).toBe('a7a8q'); // First move (API returns sorted)
            expect(mockTablebaseService.getTopMoves).toHaveBeenCalledWith(testFen, 1);
        });
        it('handles empty moves array', async ()=>{
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse([]));
            const result = await _MoveStrategyService.moveStrategyService.getBestMove(testFen);
            expect(result).toBeNull();
        });
        it('handles tablebase service error', async ()=>{
            const error = new Error('Tablebase API error');
            mockTablebaseService.getTopMoves.mockRejectedValue(error);
            const result = await _MoveStrategyService.moveStrategyService.getBestMove(testFen);
            expect(result).toBeNull();
            expect(mockLogger.error).toHaveBeenCalledWith('Failed to get best move', error, {
                fen: testFen
            });
        });
        it('handles tablebase not available', async ()=>{
            mockTablebaseService.getTopMoves.mockResolvedValue({
                isAvailable: false
            });
            const result = await _MoveStrategyService.moveStrategyService.getBestMove(testFen);
            expect(result).toBeNull();
        });
    });
    describe('getHumanLikeMove', ()=>{
        it('returns best move with default strength most of the time', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'best',
                    san: 'Best',
                    wdl: 2,
                    dtm: 5,
                    dtz: 3
                }),
                createMockMove({
                    uci: 'good',
                    san: 'Good',
                    wdl: 2,
                    dtm: 8,
                    dtz: 5
                }),
                createMockMove({
                    uci: 'okay',
                    san: 'Okay',
                    wdl: 1,
                    dtm: 12,
                    dtz: 8
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            // Mock Math.random to return value below strength threshold (0.8)
            const originalRandom = Math.random;
            Math.random = jest.fn().mockReturnValue(0.5);
            const result = await _MoveStrategyService.moveStrategyService.getHumanLikeMove(testFen);
            expect(result).toBe('best');
            Math.random = originalRandom;
        });
        it('occasionally returns suboptimal move', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'best',
                    san: 'Best',
                    wdl: 2,
                    dtm: 5,
                    dtz: 3
                }),
                createMockMove({
                    uci: 'good',
                    san: 'Good',
                    wdl: 2,
                    dtm: 8,
                    dtz: 5
                }),
                createMockMove({
                    uci: 'okay',
                    san: 'Okay',
                    wdl: 1,
                    dtm: 12,
                    dtz: 8
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            // Mock Math.random to return value above strength threshold
            const originalRandom = Math.random;
            Math.random = jest.fn().mockReturnValueOnce(0.85) // Above 0.8 threshold
            .mockReturnValueOnce(0.6); // For move selection
            const result = await _MoveStrategyService.moveStrategyService.getHumanLikeMove(testFen);
            expect([
                'best',
                'good',
                'okay'
            ]).toContain(result);
            Math.random = originalRandom;
        });
        it('always returns best move with strength 1', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'best',
                    san: 'Best',
                    wdl: 2,
                    dtm: 5,
                    dtz: 3
                }),
                createMockMove({
                    uci: 'good',
                    san: 'Good',
                    wdl: 2,
                    dtm: 8,
                    dtz: 5
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const result = await _MoveStrategyService.moveStrategyService.getHumanLikeMove(testFen, 1);
            expect(result).toBe('best');
        });
        it('handles single move gracefully', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'only',
                    san: 'Only',
                    wdl: 2,
                    dtm: 5,
                    dtz: 3
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const result = await _MoveStrategyService.moveStrategyService.getHumanLikeMove(testFen);
            expect(result).toBe('only');
        });
        it('handles empty moves array', async ()=>{
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse([]));
            const result = await _MoveStrategyService.moveStrategyService.getHumanLikeMove(testFen);
            expect(result).toBeNull();
        });
        it('handles tablebase service error', async ()=>{
            const error = new Error('Tablebase API error');
            mockTablebaseService.getTopMoves.mockRejectedValue(error);
            const result = await _MoveStrategyService.moveStrategyService.getHumanLikeMove(testFen);
            expect(result).toBeNull();
            expect(mockLogger.error).toHaveBeenCalledWith('Failed to get human-like move', error, {
                fen: testFen
            });
        });
        it('respects custom strength parameter', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'best',
                    san: 'Best',
                    wdl: 2,
                    dtm: 5,
                    dtz: 3
                }),
                createMockMove({
                    uci: 'good',
                    san: 'Good',
                    wdl: 2,
                    dtm: 8,
                    dtz: 5
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const originalRandom = Math.random;
            Math.random = jest.fn().mockReturnValue(0.3); // Below 0.5 strength
            const result = await _MoveStrategyService.moveStrategyService.getHumanLikeMove(testFen, 0.5);
            expect(result).toBe('best');
            Math.random = originalRandom;
        });
    });
    describe('Integration scenarios', ()=>{
        it('handles all service methods consistently for same position', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'a7a8q',
                    san: 'a8=Q',
                    wdl: 2,
                    dtm: 5,
                    dtz: 3
                }),
                createMockMove({
                    uci: 'a7a8r',
                    san: 'a8=R',
                    wdl: 2,
                    dtm: 8,
                    dtz: 5
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const [longest, best, humanLike] = await Promise.all([
                _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen),
                _MoveStrategyService.moveStrategyService.getBestMove(testFen),
                _MoveStrategyService.moveStrategyService.getHumanLikeMove(testFen)
            ]);
            expect(longest).toBeDefined();
            expect(best).toBeDefined();
            expect(humanLike).toBeDefined();
            expect(mockTablebaseService.getTopMoves).toHaveBeenCalledTimes(3);
        });
        it('logs debug information for move selection', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'a7a8q',
                    san: 'a8=Q',
                    wdl: 2,
                    dtm: 5,
                    dtz: 3
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect(mockLogger.debug).toHaveBeenCalledWith(expect.stringContaining('Selected'), expect.objectContaining({
                move: 'a8=Q'
            }));
        });
        it('handles positions with undefined/null DTM and DTZ gracefully', async ()=>{
            const mockMoves = [
                createMockMove({
                    uci: 'move1',
                    san: 'Move1',
                    wdl: 0,
                    dtm: undefined,
                    dtz: null
                }),
                createMockMove({
                    uci: 'move2',
                    san: 'Move2',
                    wdl: 0,
                    dtm: null,
                    dtz: undefined
                })
            ];
            mockTablebaseService.getTopMoves.mockResolvedValue(createMockResponse(mockMoves));
            const result = await _MoveStrategyService.moveStrategyService.getLongestResistanceMove(testFen);
            expect(result).toBeDefined();
            expect([
                'move1',
                'move2'
            ]).toContain(result);
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3RoZWh1L2Nvb2xQcm9qZWN0cy9FbmRnYW1lVHJhaW5lci10cmFpbmluZy1ib2FyZC1jb21wbGV0ZS9zcmMvdGVzdHMvdW5pdC9zZXJ2aWNlcy9Nb3ZlU3RyYXRlZ3lTZXJ2aWNlLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAZmlsZSBVbml0IHRlc3RzIGZvciBNb3ZlU3RyYXRlZ3lTZXJ2aWNlXG4gKiBAbW9kdWxlIHRlc3RzL3VuaXQvc2VydmljZXMvTW92ZVN0cmF0ZWd5U2VydmljZS50ZXN0XG4gKiBcbiAqIEBkZXNjcmlwdGlvblxuICogQ29tcHJlaGVuc2l2ZSB0ZXN0IHN1aXRlIGZvciBNb3ZlU3RyYXRlZ3lTZXJ2aWNlIHdoaWNoIHByb3ZpZGVzXG4gKiBkaWZmZXJlbnQgY2hlc3MgbW92ZSBzZWxlY3Rpb24gc3RyYXRlZ2llcyBmb3Igb3Bwb25lbnQgcGxheS5cbiAqIFRlc3RzIGFsbCB0aHJlZSBzdHJhdGVnaWVzOiBsb25nZXN0IHJlc2lzdGFuY2UsIGJlc3QgbW92ZSwgYW5kIGh1bWFuLWxpa2UuXG4gKiBcbiAqIEBzZWUge0BsaW5rIE1vdmVTdHJhdGVneVNlcnZpY2V9IC0gU2VydmljZSBiZWluZyB0ZXN0ZWRcbiAqIEBzZWUge0BsaW5rIFRhYmxlYmFzZVNlcnZpY2V9IC0gTW9ja2VkIGRlcGVuZGVuY3lcbiAqL1xuXG5pbXBvcnQgdHlwZSB7IFRhYmxlYmFzZU1vdmUgfSBmcm9tICdAc2hhcmVkL3R5cGVzL3RhYmxlYmFzZSc7XG5cbi8vIE1vY2sgZGVwZW5kZW5jaWVzIEJFRk9SRSBpbXBvcnRpbmcgdGhlIHNlcnZpY2Vcbmplc3QubW9jaygnQHNoYXJlZC9zZXJ2aWNlcy9sb2dnaW5nJywgKCkgPT4ge1xuICBjb25zdCBtb2NrTG9nZ2VySW5zdGFuY2UgPSB7XG4gICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgICB3YXJuOiBqZXN0LmZuKCksIFxuICAgIGRlYnVnOiBqZXN0LmZuKCksXG4gICAgc2V0Q29udGV4dDogamVzdC5mbihmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLFxuICB9O1xuICBtb2NrTG9nZ2VySW5zdGFuY2Uuc2V0Q29udGV4dC5tb2NrUmV0dXJuVmFsdWUobW9ja0xvZ2dlckluc3RhbmNlKTtcbiAgXG4gIHJldHVybiB7XG4gICAgZ2V0TG9nZ2VyOiBqZXN0LmZuKCgpID0+IG1vY2tMb2dnZXJJbnN0YW5jZSksXG4gICAgLyoqXG4gICAgICogSGVscGVyIHRvIGFjY2VzcyBtb2NrIGxvZ2dlciBpbnN0YW5jZSBpbiB0ZXN0c1xuICAgICAqIEByZXR1cm5zIE1vY2sgbG9nZ2VyIGluc3RhbmNlXG4gICAgICovXG4gICAgX19nZXRNb2NrTG9nZ2VyOiAoKSA9PiBtb2NrTG9nZ2VySW5zdGFuY2UsXG4gIH07XG59KTtcblxuamVzdC5tb2NrKCdAc2hhcmVkL3NlcnZpY2VzL1RhYmxlYmFzZVNlcnZpY2UnKTtcblxuLy8gTm93IGltcG9ydCB0aGUgc2VydmljZSBhbmQgZGVwZW5kZW5jaWVzXG5pbXBvcnQgeyBtb3ZlU3RyYXRlZ3lTZXJ2aWNlIH0gZnJvbSAnQHNoYXJlZC9zZXJ2aWNlcy9Nb3ZlU3RyYXRlZ3lTZXJ2aWNlJztcbmltcG9ydCB7IHRhYmxlYmFzZVNlcnZpY2UgfSBmcm9tICdAc2hhcmVkL3NlcnZpY2VzL1RhYmxlYmFzZVNlcnZpY2UnO1xuXG4vLyBHZXQgdGhlIG1vY2sgbG9nZ2VyIGluc3RhbmNlXG5jb25zdCB7IF9fZ2V0TW9ja0xvZ2dlciB9ID0gcmVxdWlyZSgnQHNoYXJlZC9zZXJ2aWNlcy9sb2dnaW5nJyk7XG5jb25zdCBtb2NrTG9nZ2VyID0gX19nZXRNb2NrTG9nZ2VyKCk7XG5jb25zdCBtb2NrVGFibGViYXNlU2VydmljZSA9IHRhYmxlYmFzZVNlcnZpY2UgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIHRhYmxlYmFzZVNlcnZpY2U+O1xuXG4vKipcbiAqIENyZWF0ZSBhIG1vY2sgVGFibGViYXNlTW92ZSBvYmplY3QgZm9yIHRlc3RpbmdcbiAqIFxuICogQHBhcmFtIG92ZXJyaWRlcyAtIFBhcnRpYWwgbW92ZSBwcm9wZXJ0aWVzIHRvIG92ZXJyaWRlIGRlZmF1bHRzXG4gKiBAcmV0dXJucyBDb21wbGV0ZSBUYWJsZWJhc2VNb3ZlIG9iamVjdFxuICovXG5jb25zdCBjcmVhdGVNb2NrTW92ZSA9IChvdmVycmlkZXM6IFBhcnRpYWw8VGFibGViYXNlTW92ZT4pOiBUYWJsZWJhc2VNb3ZlID0+ICh7XG4gIHVjaTogJ2UyZTQnLFxuICBzYW46ICdlNCcsXG4gIHdkbDogMCxcbiAgZHR6OiAwLFxuICBkdG06IG51bGwsXG4gIGNhdGVnb3J5OiAnZHJhdycgYXMgY29uc3QsXG4gIC4uLm92ZXJyaWRlcyxcbn0pO1xuXG4vKipcbiAqIENyZWF0ZSBhIHN1Y2Nlc3NmdWwgdGFibGViYXNlIHJlc3BvbnNlIHdpdGggbW92ZXNcbiAqIFxuICogQHBhcmFtIG1vdmVzIC0gQXJyYXkgb2YgbW92ZXMgdG8gaW5jbHVkZSBpbiByZXNwb25zZVxuICogQHJldHVybnMgTW9ja2VkIHRhYmxlYmFzZSByZXNwb25zZSBvYmplY3RcbiAqL1xuY29uc3QgY3JlYXRlTW9ja1Jlc3BvbnNlID0gKG1vdmVzOiBUYWJsZWJhc2VNb3ZlW10pID0+ICh7XG4gIGlzQXZhaWxhYmxlOiB0cnVlLFxuICBtb3Zlcyxcbn0pO1xuXG5kZXNjcmliZSgnTW92ZVN0cmF0ZWd5U2VydmljZScsICgpID0+IHtcbiAgY29uc3QgdGVzdEZlbiA9ICdLNy9QNy9rNy84LzgvOC84LzggdyAtIC0gMCAxJztcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICBtb2NrTG9nZ2VyLmVycm9yLm1vY2tDbGVhcigpO1xuICAgIG1vY2tMb2dnZXIud2Fybi5tb2NrQ2xlYXIoKTtcbiAgICBtb2NrTG9nZ2VyLmRlYnVnLm1vY2tDbGVhcigpO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0TG9uZ2VzdFJlc2lzdGFuY2VNb3ZlJywgKCkgPT4ge1xuICAgIGl0KCdyZXR1cm5zIGxvbmdlc3QgcmVzaXN0YW5jZSBtb3ZlIGZvciBsb3NpbmcgcG9zaXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrTW92ZXMgPSBbXG4gICAgICAgIGNyZWF0ZU1vY2tNb3ZlKHsgdWNpOiAnYTdhOHEnLCBzYW46ICdhOD1RJywgd2RsOiAtMiwgZHRtOiAtMTUsIGR0ejogLTEyIH0pLFxuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2E3YThyJywgc2FuOiAnYTg9UicsIHdkbDogLTIsIGR0bTogLTgsIGR0ejogLTEwIH0pLFxuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2E4YjcnLCBzYW46ICdLYjcnLCB3ZGw6IC0yLCBkdG06IC0yMCwgZHR6OiAtMTUgfSksXG4gICAgICBdO1xuICAgICAgbW9ja1RhYmxlYmFzZVNlcnZpY2UuZ2V0VG9wTW92ZXMubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1Jlc3BvbnNlKG1vY2tNb3ZlcykpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb3ZlU3RyYXRlZ3lTZXJ2aWNlLmdldExvbmdlc3RSZXNpc3RhbmNlTW92ZSh0ZXN0RmVuKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnYThiNycpOyAvLyBIaWdoZXN0IERUTSAoMjApIGZvciBsb25nZXN0IHJlc2lzdGFuY2VcbiAgICAgIGV4cGVjdChtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3ZlcykudG9IYXZlQmVlbkNhbGxlZFdpdGgodGVzdEZlbiwgMTAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdyZXR1cm5zIGZhc3Rlc3Qgd2luIGZvciB3aW5uaW5nIHBvc2l0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja01vdmVzID0gW1xuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2E3YjYnLCBzYW46ICdLYjYnLCB3ZGw6IDIsIGR0bTogNSwgZHR6OiAzIH0pLFxuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2E3YjcnLCBzYW46ICdLYjcnLCB3ZGw6IDIsIGR0bTogOCwgZHR6OiA1IH0pLFxuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2E3YTYnLCBzYW46ICdLYTYnLCB3ZGw6IDIsIGR0bTogMywgZHR6OiAyIH0pLFxuICAgICAgXTtcbiAgICAgIG1vY2tUYWJsZWJhc2VTZXJ2aWNlLmdldFRvcE1vdmVzLm1vY2tSZXNvbHZlZFZhbHVlKGNyZWF0ZU1vY2tSZXNwb25zZShtb2NrTW92ZXMpKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW92ZVN0cmF0ZWd5U2VydmljZS5nZXRMb25nZXN0UmVzaXN0YW5jZU1vdmUodGVzdEZlbik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ2E3YTYnKTsgLy8gTG93ZXN0IERUWiAoMikgZm9yIGZhc3Rlc3Qgd2luXG4gICAgfSk7XG5cbiAgICBpdCgncmV0dXJucyBhbnkgZHJhd2luZyBtb3ZlIGZvciBkcmF3biBwb3NpdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tNb3ZlcyA9IFtcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdhN2I2Jywgc2FuOiAnS2I2Jywgd2RsOiAwLCBkdG06IG51bGwsIGR0ejogMCB9KSxcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdhN2I3Jywgc2FuOiAnS2I3Jywgd2RsOiAwLCBkdG06IG51bGwsIGR0ejogMCB9KSxcbiAgICAgIF07XG4gICAgICBtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3Zlcy5tb2NrUmVzb2x2ZWRWYWx1ZShjcmVhdGVNb2NrUmVzcG9uc2UobW9ja01vdmVzKSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0TG9uZ2VzdFJlc2lzdGFuY2VNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QoWydhN2I2JywgJ2E3YjcnXSkudG9Db250YWluKHJlc3VsdCk7XG4gICAgfSk7XG5cbiAgICBpdCgncHJlZmVycyBEVE0gb3ZlciBEVFogZm9yIGxvc2luZyBwb3NpdGlvbnMgd2hlbiBhdmFpbGFibGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrTW92ZXMgPSBbXG4gICAgICAgIGNyZWF0ZU1vY2tNb3ZlKHsgdWNpOiAnbW92ZTEnLCBzYW46ICdNb3ZlMScsIHdkbDogLTIsIGR0bTogLTEwLCBkdHo6IC0yMCB9KSxcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdtb3ZlMicsIHNhbjogJ01vdmUyJywgd2RsOiAtMiwgZHRtOiAtMTUsIGR0ejogLTUgfSksXG4gICAgICBdO1xuICAgICAgbW9ja1RhYmxlYmFzZVNlcnZpY2UuZ2V0VG9wTW92ZXMubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1Jlc3BvbnNlKG1vY2tNb3ZlcykpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb3ZlU3RyYXRlZ3lTZXJ2aWNlLmdldExvbmdlc3RSZXNpc3RhbmNlTW92ZSh0ZXN0RmVuKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnbW92ZTInKTsgLy8gSGlnaGVyIERUTSAoMTUpIGRlc3BpdGUgbG93ZXIgRFRaXG4gICAgfSk7XG5cbiAgICBpdCgnZmFsbHMgYmFjayB0byBEVFogd2hlbiBEVE0gaXMgbm90IGF2YWlsYWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tNb3ZlcyA9IFtcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdtb3ZlMScsIHNhbjogJ01vdmUxJywgd2RsOiAtMiwgZHRtOiBudWxsLCBkdHo6IC0xMCB9KSxcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdtb3ZlMicsIHNhbjogJ01vdmUyJywgd2RsOiAtMiwgZHRtOiBudWxsLCBkdHo6IC0yMCB9KSxcbiAgICAgIF07XG4gICAgICBtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3Zlcy5tb2NrUmVzb2x2ZWRWYWx1ZShjcmVhdGVNb2NrUmVzcG9uc2UobW9ja01vdmVzKSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0TG9uZ2VzdFJlc2lzdGFuY2VNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdtb3ZlMicpOyAvLyBIaWdoZXIgRFRaICgyMCkgd2hlbiBEVE0gdW5hdmFpbGFibGVcbiAgICB9KTtcblxuICAgIGl0KCdoYW5kbGVzIGVtcHR5IG1vdmVzIGFycmF5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RhYmxlYmFzZVNlcnZpY2UuZ2V0VG9wTW92ZXMubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1Jlc3BvbnNlKFtdKSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0TG9uZ2VzdFJlc2lzdGFuY2VNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIud2FybikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdObyB0YWJsZWJhc2UgbW92ZXMgYXZhaWxhYmxlIGZvciBwb3NpdGlvbicsXG4gICAgICAgIHsgZmVuOiB0ZXN0RmVuIH1cbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnaGFuZGxlcyB0YWJsZWJhc2Ugbm90IGF2YWlsYWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tUYWJsZWJhc2VTZXJ2aWNlLmdldFRvcE1vdmVzLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgaXNBdmFpbGFibGU6IGZhbHNlLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0TG9uZ2VzdFJlc2lzdGFuY2VNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2hhbmRsZXMgdGFibGViYXNlIHNlcnZpY2UgZXJyb3IgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdUYWJsZWJhc2UgQVBJIGVycm9yJyk7XG4gICAgICBtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3Zlcy5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0TG9uZ2VzdFJlc2lzdGFuY2VNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnRmFpbGVkIHRvIGdldCBsb25nZXN0IHJlc2lzdGFuY2UgbW92ZScsXG4gICAgICAgIGVycm9yLFxuICAgICAgICB7IGZlbjogdGVzdEZlbiB9XG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3VzZXMgc2Vjb25kYXJ5IGNyaXRlcmlvbiBEVFogd2hlbiBEVE0gaXMgZXF1YWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrTW92ZXMgPSBbXG4gICAgICAgIGNyZWF0ZU1vY2tNb3ZlKHsgdWNpOiAnbW92ZTEnLCBzYW46ICdNb3ZlMScsIHdkbDogLTIsIGR0bTogLTEwLCBkdHo6IC01IH0pLFxuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ21vdmUyJywgc2FuOiAnTW92ZTInLCB3ZGw6IC0yLCBkdG06IC0xMCwgZHR6OiAtOCB9KSxcbiAgICAgIF07XG4gICAgICBtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3Zlcy5tb2NrUmVzb2x2ZWRWYWx1ZShjcmVhdGVNb2NrUmVzcG9uc2UobW9ja01vdmVzKSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0TG9uZ2VzdFJlc2lzdGFuY2VNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdtb3ZlMicpOyAvLyBTYW1lIERUTSwgaGlnaGVyIERUWiB3aW5zXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRCZXN0TW92ZScsICgpID0+IHtcbiAgICBpdCgncmV0dXJucyBvYmplY3RpdmVseSBiZXN0IG1vdmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrTW92ZXMgPSBbXG4gICAgICAgIGNyZWF0ZU1vY2tNb3ZlKHsgdWNpOiAnYTdhOHEnLCBzYW46ICdhOD1RJywgd2RsOiAyLCBkdG06IDUsIGR0ejogMyB9KSxcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdhN2E4cicsIHNhbjogJ2E4PVInLCB3ZGw6IDIsIGR0bTogOCwgZHR6OiA1IH0pLFxuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2E3YjYnLCBzYW46ICdLYjYnLCB3ZGw6IDEsIGR0bTogMTIsIGR0ejogOCB9KSxcbiAgICAgIF07XG4gICAgICBtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3Zlcy5tb2NrUmVzb2x2ZWRWYWx1ZShjcmVhdGVNb2NrUmVzcG9uc2UobW9ja01vdmVzKSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0QmVzdE1vdmUodGVzdEZlbik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ2E3YThxJyk7IC8vIEZpcnN0IG1vdmUgKEFQSSByZXR1cm5zIHNvcnRlZClcbiAgICAgIGV4cGVjdChtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3ZlcykudG9IYXZlQmVlbkNhbGxlZFdpdGgodGVzdEZlbiwgMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnaGFuZGxlcyBlbXB0eSBtb3ZlcyBhcnJheScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tUYWJsZWJhc2VTZXJ2aWNlLmdldFRvcE1vdmVzLm1vY2tSZXNvbHZlZFZhbHVlKGNyZWF0ZU1vY2tSZXNwb25zZShbXSkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb3ZlU3RyYXRlZ3lTZXJ2aWNlLmdldEJlc3RNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2hhbmRsZXMgdGFibGViYXNlIHNlcnZpY2UgZXJyb3InLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignVGFibGViYXNlIEFQSSBlcnJvcicpO1xuICAgICAgbW9ja1RhYmxlYmFzZVNlcnZpY2UuZ2V0VG9wTW92ZXMubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb3ZlU3RyYXRlZ3lTZXJ2aWNlLmdldEJlc3RNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnRmFpbGVkIHRvIGdldCBiZXN0IG1vdmUnLFxuICAgICAgICBlcnJvcixcbiAgICAgICAgeyBmZW46IHRlc3RGZW4gfVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdoYW5kbGVzIHRhYmxlYmFzZSBub3QgYXZhaWxhYmxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RhYmxlYmFzZVNlcnZpY2UuZ2V0VG9wTW92ZXMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBpc0F2YWlsYWJsZTogZmFsc2UsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW92ZVN0cmF0ZWd5U2VydmljZS5nZXRCZXN0TW92ZSh0ZXN0RmVuKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZU51bGwoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldEh1bWFuTGlrZU1vdmUnLCAoKSA9PiB7XG4gICAgaXQoJ3JldHVybnMgYmVzdCBtb3ZlIHdpdGggZGVmYXVsdCBzdHJlbmd0aCBtb3N0IG9mIHRoZSB0aW1lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja01vdmVzID0gW1xuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2Jlc3QnLCBzYW46ICdCZXN0Jywgd2RsOiAyLCBkdG06IDUsIGR0ejogMyB9KSxcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdnb29kJywgc2FuOiAnR29vZCcsIHdkbDogMiwgZHRtOiA4LCBkdHo6IDUgfSksXG4gICAgICAgIGNyZWF0ZU1vY2tNb3ZlKHsgdWNpOiAnb2theScsIHNhbjogJ09rYXknLCB3ZGw6IDEsIGR0bTogMTIsIGR0ejogOCB9KSxcbiAgICAgIF07XG4gICAgICBtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3Zlcy5tb2NrUmVzb2x2ZWRWYWx1ZShjcmVhdGVNb2NrUmVzcG9uc2UobW9ja01vdmVzKSk7XG5cbiAgICAgIC8vIE1vY2sgTWF0aC5yYW5kb20gdG8gcmV0dXJuIHZhbHVlIGJlbG93IHN0cmVuZ3RoIHRocmVzaG9sZCAoMC44KVxuICAgICAgY29uc3Qgb3JpZ2luYWxSYW5kb20gPSBNYXRoLnJhbmRvbTtcbiAgICAgIE1hdGgucmFuZG9tID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgwLjUpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb3ZlU3RyYXRlZ3lTZXJ2aWNlLmdldEh1bWFuTGlrZU1vdmUodGVzdEZlbik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ2Jlc3QnKTtcbiAgICAgIFxuICAgICAgTWF0aC5yYW5kb20gPSBvcmlnaW5hbFJhbmRvbTtcbiAgICB9KTtcblxuICAgIGl0KCdvY2Nhc2lvbmFsbHkgcmV0dXJucyBzdWJvcHRpbWFsIG1vdmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrTW92ZXMgPSBbXG4gICAgICAgIGNyZWF0ZU1vY2tNb3ZlKHsgdWNpOiAnYmVzdCcsIHNhbjogJ0Jlc3QnLCB3ZGw6IDIsIGR0bTogNSwgZHR6OiAzIH0pLFxuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2dvb2QnLCBzYW46ICdHb29kJywgd2RsOiAyLCBkdG06IDgsIGR0ejogNSB9KSxcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdva2F5Jywgc2FuOiAnT2theScsIHdkbDogMSwgZHRtOiAxMiwgZHR6OiA4IH0pLFxuICAgICAgXTtcbiAgICAgIG1vY2tUYWJsZWJhc2VTZXJ2aWNlLmdldFRvcE1vdmVzLm1vY2tSZXNvbHZlZFZhbHVlKGNyZWF0ZU1vY2tSZXNwb25zZShtb2NrTW92ZXMpKTtcblxuICAgICAgLy8gTW9jayBNYXRoLnJhbmRvbSB0byByZXR1cm4gdmFsdWUgYWJvdmUgc3RyZW5ndGggdGhyZXNob2xkXG4gICAgICBjb25zdCBvcmlnaW5hbFJhbmRvbSA9IE1hdGgucmFuZG9tO1xuICAgICAgTWF0aC5yYW5kb20gPSBqZXN0LmZuKClcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UoMC44NSkgLy8gQWJvdmUgMC44IHRocmVzaG9sZFxuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZSgwLjYpOyAvLyBGb3IgbW92ZSBzZWxlY3Rpb25cblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW92ZVN0cmF0ZWd5U2VydmljZS5nZXRIdW1hbkxpa2VNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QoWydiZXN0JywgJ2dvb2QnLCAnb2theSddKS50b0NvbnRhaW4ocmVzdWx0KTtcbiAgICAgIFxuICAgICAgTWF0aC5yYW5kb20gPSBvcmlnaW5hbFJhbmRvbTtcbiAgICB9KTtcblxuICAgIGl0KCdhbHdheXMgcmV0dXJucyBiZXN0IG1vdmUgd2l0aCBzdHJlbmd0aCAxJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja01vdmVzID0gW1xuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2Jlc3QnLCBzYW46ICdCZXN0Jywgd2RsOiAyLCBkdG06IDUsIGR0ejogMyB9KSxcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdnb29kJywgc2FuOiAnR29vZCcsIHdkbDogMiwgZHRtOiA4LCBkdHo6IDUgfSksXG4gICAgICBdO1xuICAgICAgbW9ja1RhYmxlYmFzZVNlcnZpY2UuZ2V0VG9wTW92ZXMubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1Jlc3BvbnNlKG1vY2tNb3ZlcykpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb3ZlU3RyYXRlZ3lTZXJ2aWNlLmdldEh1bWFuTGlrZU1vdmUodGVzdEZlbiwgMSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ2Jlc3QnKTtcbiAgICB9KTtcblxuICAgIGl0KCdoYW5kbGVzIHNpbmdsZSBtb3ZlIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrTW92ZXMgPSBbXG4gICAgICAgIGNyZWF0ZU1vY2tNb3ZlKHsgdWNpOiAnb25seScsIHNhbjogJ09ubHknLCB3ZGw6IDIsIGR0bTogNSwgZHR6OiAzIH0pLFxuICAgICAgXTtcbiAgICAgIG1vY2tUYWJsZWJhc2VTZXJ2aWNlLmdldFRvcE1vdmVzLm1vY2tSZXNvbHZlZFZhbHVlKGNyZWF0ZU1vY2tSZXNwb25zZShtb2NrTW92ZXMpKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW92ZVN0cmF0ZWd5U2VydmljZS5nZXRIdW1hbkxpa2VNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdvbmx5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnaGFuZGxlcyBlbXB0eSBtb3ZlcyBhcnJheScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tUYWJsZWJhc2VTZXJ2aWNlLmdldFRvcE1vdmVzLm1vY2tSZXNvbHZlZFZhbHVlKGNyZWF0ZU1vY2tSZXNwb25zZShbXSkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb3ZlU3RyYXRlZ3lTZXJ2aWNlLmdldEh1bWFuTGlrZU1vdmUodGVzdEZlbik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnaGFuZGxlcyB0YWJsZWJhc2Ugc2VydmljZSBlcnJvcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdUYWJsZWJhc2UgQVBJIGVycm9yJyk7XG4gICAgICBtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3Zlcy5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0SHVtYW5MaWtlTW92ZSh0ZXN0RmVuKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZU51bGwoKTtcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ0ZhaWxlZCB0byBnZXQgaHVtYW4tbGlrZSBtb3ZlJyxcbiAgICAgICAgZXJyb3IsXG4gICAgICAgIHsgZmVuOiB0ZXN0RmVuIH1cbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgncmVzcGVjdHMgY3VzdG9tIHN0cmVuZ3RoIHBhcmFtZXRlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tNb3ZlcyA9IFtcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdiZXN0Jywgc2FuOiAnQmVzdCcsIHdkbDogMiwgZHRtOiA1LCBkdHo6IDMgfSksXG4gICAgICAgIGNyZWF0ZU1vY2tNb3ZlKHsgdWNpOiAnZ29vZCcsIHNhbjogJ0dvb2QnLCB3ZGw6IDIsIGR0bTogOCwgZHR6OiA1IH0pLFxuICAgICAgXTtcbiAgICAgIG1vY2tUYWJsZWJhc2VTZXJ2aWNlLmdldFRvcE1vdmVzLm1vY2tSZXNvbHZlZFZhbHVlKGNyZWF0ZU1vY2tSZXNwb25zZShtb2NrTW92ZXMpKTtcblxuICAgICAgY29uc3Qgb3JpZ2luYWxSYW5kb20gPSBNYXRoLnJhbmRvbTtcbiAgICAgIE1hdGgucmFuZG9tID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgwLjMpOyAvLyBCZWxvdyAwLjUgc3RyZW5ndGhcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW92ZVN0cmF0ZWd5U2VydmljZS5nZXRIdW1hbkxpa2VNb3ZlKHRlc3RGZW4sIDAuNSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ2Jlc3QnKTtcbiAgICAgIFxuICAgICAgTWF0aC5yYW5kb20gPSBvcmlnaW5hbFJhbmRvbTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ludGVncmF0aW9uIHNjZW5hcmlvcycsICgpID0+IHtcbiAgICBpdCgnaGFuZGxlcyBhbGwgc2VydmljZSBtZXRob2RzIGNvbnNpc3RlbnRseSBmb3Igc2FtZSBwb3NpdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tNb3ZlcyA9IFtcbiAgICAgICAgY3JlYXRlTW9ja01vdmUoeyB1Y2k6ICdhN2E4cScsIHNhbjogJ2E4PVEnLCB3ZGw6IDIsIGR0bTogNSwgZHR6OiAzIH0pLFxuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2E3YThyJywgc2FuOiAnYTg9UicsIHdkbDogMiwgZHRtOiA4LCBkdHo6IDUgfSksXG4gICAgICBdO1xuICAgICAgbW9ja1RhYmxlYmFzZVNlcnZpY2UuZ2V0VG9wTW92ZXMubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1Jlc3BvbnNlKG1vY2tNb3ZlcykpO1xuXG4gICAgICBjb25zdCBbbG9uZ2VzdCwgYmVzdCwgaHVtYW5MaWtlXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgbW92ZVN0cmF0ZWd5U2VydmljZS5nZXRMb25nZXN0UmVzaXN0YW5jZU1vdmUodGVzdEZlbiksXG4gICAgICAgIG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0QmVzdE1vdmUodGVzdEZlbiksXG4gICAgICAgIG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0SHVtYW5MaWtlTW92ZSh0ZXN0RmVuKSxcbiAgICAgIF0pO1xuXG4gICAgICBleHBlY3QobG9uZ2VzdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChiZXN0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGh1bWFuTGlrZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3ZlcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2xvZ3MgZGVidWcgaW5mb3JtYXRpb24gZm9yIG1vdmUgc2VsZWN0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja01vdmVzID0gW1xuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ2E3YThxJywgc2FuOiAnYTg9UScsIHdkbDogMiwgZHRtOiA1LCBkdHo6IDMgfSksXG4gICAgICBdO1xuICAgICAgbW9ja1RhYmxlYmFzZVNlcnZpY2UuZ2V0VG9wTW92ZXMubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1Jlc3BvbnNlKG1vY2tNb3ZlcykpO1xuXG4gICAgICBhd2FpdCBtb3ZlU3RyYXRlZ3lTZXJ2aWNlLmdldExvbmdlc3RSZXNpc3RhbmNlTW92ZSh0ZXN0RmVuKTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZGVidWcpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnU2VsZWN0ZWQnKSxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIG1vdmU6ICdhOD1RJyxcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnaGFuZGxlcyBwb3NpdGlvbnMgd2l0aCB1bmRlZmluZWQvbnVsbCBEVE0gYW5kIERUWiBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja01vdmVzID0gW1xuICAgICAgICBjcmVhdGVNb2NrTW92ZSh7IHVjaTogJ21vdmUxJywgc2FuOiAnTW92ZTEnLCB3ZGw6IDAsIGR0bTogdW5kZWZpbmVkLCBkdHo6IG51bGwgfSksXG4gICAgICAgIGNyZWF0ZU1vY2tNb3ZlKHsgdWNpOiAnbW92ZTInLCBzYW46ICdNb3ZlMicsIHdkbDogMCwgZHRtOiBudWxsLCBkdHo6IHVuZGVmaW5lZCB9KSxcbiAgICAgIF07XG4gICAgICBtb2NrVGFibGViYXNlU2VydmljZS5nZXRUb3BNb3Zlcy5tb2NrUmVzb2x2ZWRWYWx1ZShjcmVhdGVNb2NrUmVzcG9uc2UobW9ja01vdmVzKSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vdmVTdHJhdGVneVNlcnZpY2UuZ2V0TG9uZ2VzdFJlc2lzdGFuY2VNb3ZlKHRlc3RGZW4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KFsnbW92ZTEnLCAnbW92ZTInXSkudG9Db250YWluKHJlc3VsdCk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwibW9ja0xvZ2dlckluc3RhbmNlIiwiZXJyb3IiLCJmbiIsIndhcm4iLCJkZWJ1ZyIsInNldENvbnRleHQiLCJtb2NrUmV0dXJuVmFsdWUiLCJnZXRMb2dnZXIiLCJfX2dldE1vY2tMb2dnZXIiLCJyZXF1aXJlIiwibW9ja0xvZ2dlciIsIm1vY2tUYWJsZWJhc2VTZXJ2aWNlIiwidGFibGViYXNlU2VydmljZSIsImNyZWF0ZU1vY2tNb3ZlIiwib3ZlcnJpZGVzIiwidWNpIiwic2FuIiwid2RsIiwiZHR6IiwiZHRtIiwiY2F0ZWdvcnkiLCJjcmVhdGVNb2NrUmVzcG9uc2UiLCJtb3ZlcyIsImlzQXZhaWxhYmxlIiwiZGVzY3JpYmUiLCJ0ZXN0RmVuIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrQ2xlYXIiLCJpdCIsIm1vY2tNb3ZlcyIsImdldFRvcE1vdmVzIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJyZXN1bHQiLCJtb3ZlU3RyYXRlZ3lTZXJ2aWNlIiwiZ2V0TG9uZ2VzdFJlc2lzdGFuY2VNb3ZlIiwiZXhwZWN0IiwidG9CZSIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwidG9Db250YWluIiwidG9CZU51bGwiLCJmZW4iLCJFcnJvciIsIm1vY2tSZWplY3RlZFZhbHVlIiwiZ2V0QmVzdE1vdmUiLCJvcmlnaW5hbFJhbmRvbSIsIk1hdGgiLCJyYW5kb20iLCJnZXRIdW1hbkxpa2VNb3ZlIiwibW9ja1JldHVyblZhbHVlT25jZSIsImxvbmdlc3QiLCJiZXN0IiwiaHVtYW5MaWtlIiwiUHJvbWlzZSIsImFsbCIsInRvQmVEZWZpbmVkIiwidG9IYXZlQmVlbkNhbGxlZFRpbWVzIiwic3RyaW5nQ29udGFpbmluZyIsIm9iamVjdENvbnRhaW5pbmciLCJtb3ZlIiwidW5kZWZpbmVkIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Q0FXQztBQUlELGlEQUFpRDtBQUNqREEsS0FBS0MsSUFBSSxDQUFDLDRCQUE0QjtJQUNwQyxNQUFNQyxxQkFBcUI7UUFDekJDLE9BQU9ILEtBQUtJLEVBQUU7UUFDZEMsTUFBTUwsS0FBS0ksRUFBRTtRQUNiRSxPQUFPTixLQUFLSSxFQUFFO1FBQ2RHLFlBQVlQLEtBQUtJLEVBQUUsQ0FBQztZQUFhLE9BQU8sSUFBSTtRQUFFO0lBQ2hEO0lBQ0FGLG1CQUFtQkssVUFBVSxDQUFDQyxlQUFlLENBQUNOO0lBRTlDLE9BQU87UUFDTE8sV0FBV1QsS0FBS0ksRUFBRSxDQUFDLElBQU1GO1FBQ3pCOzs7S0FHQyxHQUNEUSxpQkFBaUIsSUFBTVI7SUFDekI7QUFDRjtBQUVBRixLQUFLQyxJQUFJLENBQUM7Ozs7cUNBRzBCO2tDQUNIO0FBRWpDLCtCQUErQjtBQUMvQixNQUFNLEVBQUVTLGVBQWUsRUFBRSxHQUFHQyxRQUFRO0FBQ3BDLE1BQU1DLGFBQWFGO0FBQ25CLE1BQU1HLHVCQUF1QkMsa0NB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