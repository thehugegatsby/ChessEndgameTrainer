1d58fe2cb55a30bb4f15f865ad88246a
/**
 * @file Tests for TablebaseSlice with nested store structure
 * @module tests/unit/store/slices/tablebaseSlice.nested
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _rootStore = require("../../../../shared/store/rootStore");
describe("TablebaseSlice - Nested Store Structure", ()=>{
    beforeEach(()=>{
        // Reset store to initial state - preserve actions by only updating state properties
        _rootStore.useStore.setState((state)=>{
            state.tablebase.tablebaseMove = undefined;
            state.tablebase.analysisStatus = "idle";
            state.tablebase.evaluations = [];
            state.tablebase.currentEvaluation = undefined;
        });
    });
    describe("setTablebaseMove", ()=>{
        it("should set tablebase move string", ()=>{
            const store = _rootStore.useStore.getState();
            store.tablebase.setTablebaseMove("Qb7");
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.tablebaseMove).toBe("Qb7");
        });
        it("should set null for draw position", ()=>{
            const store = _rootStore.useStore.getState();
            store.tablebase.setTablebaseMove(null);
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.tablebaseMove).toBeNull();
        });
        it("should set undefined for no lookup", ()=>{
            const store = _rootStore.useStore.getState();
            store.tablebase.setTablebaseMove(undefined);
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.tablebaseMove).toBeUndefined();
        });
    });
    describe("setAnalysisStatus", ()=>{
        it("should set all analysis status values", ()=>{
            const store = _rootStore.useStore.getState();
            const statuses = [
                "idle",
                "loading",
                "success",
                "error"
            ];
            statuses.forEach((status)=>{
                store.tablebase.setAnalysisStatus(status);
                const state = _rootStore.useStore.getState();
                expect(state.tablebase.analysisStatus).toBe(status);
            });
        });
    });
    describe("setEvaluations", ()=>{
        it("should set evaluations array", ()=>{
            const store = _rootStore.useStore.getState();
            const evaluations = [
                {
                    fen: "8/8/8/8/8/8/8/8 w - - 0 1",
                    evaluation: 0
                },
                {
                    fen: "K7/P7/k7/8/8/8/8/8 w - - 0 1",
                    evaluation: 2
                }
            ];
            store.tablebase.setEvaluations(evaluations);
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.evaluations).toEqual(evaluations);
            expect(state.tablebase.evaluations).toHaveLength(2);
        });
        it("should clear evaluations with empty array", ()=>{
            const store = _rootStore.useStore.getState();
            // First set some evaluations
            store.tablebase.setEvaluations([
                {
                    fen: "8/8/8/8/8/8/8/8 w - - 0 1",
                    evaluation: 0
                }
            ]);
            // Then clear them
            store.tablebase.setEvaluations([]);
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.evaluations).toEqual([]);
        });
    });
    describe("addEvaluation", ()=>{
        it("should add evaluation to array", ()=>{
            const store = _rootStore.useStore.getState();
            const evaluation = {
                fen: "8/8/8/8/8/8/8/8 w - - 0 1",
                evaluation: 0
            };
            store.tablebase.addEvaluation(evaluation);
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.evaluations).toContainEqual(evaluation);
            expect(state.tablebase.evaluations).toHaveLength(1);
        });
        it("should append evaluations to existing array", ()=>{
            const store = _rootStore.useStore.getState();
            const eval1 = {
                fen: "8/8/8/8/8/8/8/8 w - - 0 1",
                evaluation: 0
            };
            const eval2 = {
                fen: "K7/P7/k7/8/8/8/8/8 w - - 0 1",
                evaluation: 2
            };
            store.tablebase.addEvaluation(eval1);
            store.tablebase.addEvaluation(eval2);
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.evaluations).toHaveLength(2);
            expect(state.tablebase.evaluations[0]).toEqual(eval1);
            expect(state.tablebase.evaluations[1]).toEqual(eval2);
        });
    });
    describe("setCurrentEvaluation", ()=>{
        it("should set current evaluation", ()=>{
            const store = _rootStore.useStore.getState();
            const evaluation = {
                fen: "8/8/8/8/8/8/8/8 w - - 0 1",
                evaluation: 0
            };
            store.tablebase.setCurrentEvaluation(evaluation);
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.currentEvaluation).toEqual(evaluation);
        });
        it("should clear current evaluation", ()=>{
            const store = _rootStore.useStore.getState();
            // First set an evaluation
            store.tablebase.setCurrentEvaluation({
                fen: "8/8/8/8/8/8/8/8 w - - 0 1",
                evaluation: 0
            });
            // Then clear it
            store.tablebase.setCurrentEvaluation(undefined);
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.currentEvaluation).toBeUndefined();
        });
    });
    describe("clearTablebaseState", ()=>{
        it("should reset all state to initial values", ()=>{
            const store = _rootStore.useStore.getState();
            // Set various values
            store.tablebase.setTablebaseMove("Qb7");
            store.tablebase.setAnalysisStatus("loading");
            store.tablebase.addEvaluation({
                fen: "8/8/8/8/8/8/8/8 w - - 0 1",
                evaluation: 0
            });
            store.tablebase.setCurrentEvaluation({
                fen: "K7/P7/k7/8/8/8/8/8 w - - 0 1",
                evaluation: 2
            });
            // Clear everything
            store.tablebase.clearTablebaseState();
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.tablebaseMove).toBeUndefined();
            expect(state.tablebase.analysisStatus).toBe("idle");
            expect(state.tablebase.evaluations).toEqual([]);
            expect(state.tablebase.currentEvaluation).toBeUndefined();
        });
    });
    describe("Integration with nested structure", ()=>{
        it("should work with other slices in the store", ()=>{
            const store = _rootStore.useStore.getState();
            // Verify that other slices exist
            expect(store.game).toBeDefined();
            expect(store.training).toBeDefined();
            expect(store.ui).toBeDefined();
            // Set tablebase data
            store.tablebase.setTablebaseMove("Kd6");
            // Verify it doesn't affect other slices
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.tablebaseMove).toBe("Kd6");
            expect(state.game.currentFen).toBeDefined();
            expect(state.training.currentPosition).toBeUndefined(); // Should be undefined initially
        });
        it("should maintain proper nesting in state updates", ()=>{
            const store = _rootStore.useStore.getState();
            // Make multiple updates
            store.tablebase.setAnalysisStatus("loading");
            store.tablebase.setTablebaseMove("Qb7");
            store.tablebase.addEvaluation({
                fen: "8/8/8/8/8/8/8/8 w - - 0 1",
                evaluation: 0
            });
            // Check all updates were applied correctly
            const state = _rootStore.useStore.getState();
            expect(state.tablebase.analysisStatus).toBe("loading");
            expect(state.tablebase.tablebaseMove).toBe("Qb7");
            expect(state.tablebase.evaluations).toHaveLength(1);
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3RoZWh1L2Nvb2xQcm9qZWN0cy9FbmRnYW1lVHJhaW5lci10cmFpbmluZy1ib2FyZC1jb21wbGV0ZS9zcmMvdGVzdHMvdW5pdC9zdG9yZS9zbGljZXMvdGFibGViYXNlU2xpY2UudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIFRlc3RzIGZvciBUYWJsZWJhc2VTbGljZSB3aXRoIG5lc3RlZCBzdG9yZSBzdHJ1Y3R1cmVcbiAqIEBtb2R1bGUgdGVzdHMvdW5pdC9zdG9yZS9zbGljZXMvdGFibGViYXNlU2xpY2UubmVzdGVkXG4gKi9cblxuaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tIFwiQHNoYXJlZC9zdG9yZS9yb290U3RvcmVcIjtcbmltcG9ydCB0eXBlIHsgUG9zaXRpb25BbmFseXNpcyB9IGZyb20gXCJAc2hhcmVkL3R5cGVzXCI7XG5cbmRlc2NyaWJlKFwiVGFibGViYXNlU2xpY2UgLSBOZXN0ZWQgU3RvcmUgU3RydWN0dXJlXCIsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgLy8gUmVzZXQgc3RvcmUgdG8gaW5pdGlhbCBzdGF0ZSAtIHByZXNlcnZlIGFjdGlvbnMgYnkgb25seSB1cGRhdGluZyBzdGF0ZSBwcm9wZXJ0aWVzXG4gICAgdXNlU3RvcmUuc2V0U3RhdGUoKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS50YWJsZWJhc2UudGFibGViYXNlTW92ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHN0YXRlLnRhYmxlYmFzZS5hbmFseXNpc1N0YXR1cyA9IFwiaWRsZVwiO1xuICAgICAgc3RhdGUudGFibGViYXNlLmV2YWx1YXRpb25zID0gW107XG4gICAgICBzdGF0ZS50YWJsZWJhc2UuY3VycmVudEV2YWx1YXRpb24gPSB1bmRlZmluZWQ7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwic2V0VGFibGViYXNlTW92ZVwiLCAoKSA9PiB7XG4gICAgaXQoXCJzaG91bGQgc2V0IHRhYmxlYmFzZSBtb3ZlIHN0cmluZ1wiLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdG9yZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG5cbiAgICAgIHN0b3JlLnRhYmxlYmFzZS5zZXRUYWJsZWJhc2VNb3ZlKFwiUWI3XCIpO1xuXG4gICAgICBjb25zdCBzdGF0ZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUudGFibGViYXNlLnRhYmxlYmFzZU1vdmUpLnRvQmUoXCJRYjdcIik7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBzZXQgbnVsbCBmb3IgZHJhdyBwb3NpdGlvblwiLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdG9yZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG5cbiAgICAgIHN0b3JlLnRhYmxlYmFzZS5zZXRUYWJsZWJhc2VNb3ZlKG51bGwpO1xuXG4gICAgICBjb25zdCBzdGF0ZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUudGFibGViYXNlLnRhYmxlYmFzZU1vdmUpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBzZXQgdW5kZWZpbmVkIGZvciBubyBsb29rdXBcIiwgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RvcmUgPSB1c2VTdG9yZS5nZXRTdGF0ZSgpO1xuXG4gICAgICBzdG9yZS50YWJsZWJhc2Uuc2V0VGFibGViYXNlTW92ZSh1bmRlZmluZWQpO1xuXG4gICAgICBjb25zdCBzdGF0ZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUudGFibGViYXNlLnRhYmxlYmFzZU1vdmUpLnRvQmVVbmRlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJzZXRBbmFseXNpc1N0YXR1c1wiLCAoKSA9PiB7XG4gICAgaXQoXCJzaG91bGQgc2V0IGFsbCBhbmFseXNpcyBzdGF0dXMgdmFsdWVzXCIsICgpID0+IHtcbiAgICAgIGNvbnN0IHN0b3JlID0gdXNlU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgIGNvbnN0IHN0YXR1c2VzID0gW1wiaWRsZVwiLCBcImxvYWRpbmdcIiwgXCJzdWNjZXNzXCIsIFwiZXJyb3JcIl0gYXMgY29uc3Q7XG5cbiAgICAgIHN0YXR1c2VzLmZvckVhY2goKHN0YXR1cykgPT4ge1xuICAgICAgICBzdG9yZS50YWJsZWJhc2Uuc2V0QW5hbHlzaXNTdGF0dXMoc3RhdHVzKTtcbiAgICAgICAgY29uc3Qgc3RhdGUgPSB1c2VTdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgICBleHBlY3Qoc3RhdGUudGFibGViYXNlLmFuYWx5c2lzU3RhdHVzKS50b0JlKHN0YXR1cyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJzZXRFdmFsdWF0aW9uc1wiLCAoKSA9PiB7XG4gICAgaXQoXCJzaG91bGQgc2V0IGV2YWx1YXRpb25zIGFycmF5XCIsICgpID0+IHtcbiAgICAgIGNvbnN0IHN0b3JlID0gdXNlU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgIGNvbnN0IGV2YWx1YXRpb25zOiBQb3NpdGlvbkFuYWx5c2lzW10gPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBmZW46IFwiOC84LzgvOC84LzgvOC84IHcgLSAtIDAgMVwiLFxuICAgICAgICAgIGV2YWx1YXRpb246IDAsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBmZW46IFwiSzcvUDcvazcvOC84LzgvOC84IHcgLSAtIDAgMVwiLFxuICAgICAgICAgIGV2YWx1YXRpb246IDIsXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICBzdG9yZS50YWJsZWJhc2Uuc2V0RXZhbHVhdGlvbnMoZXZhbHVhdGlvbnMpO1xuXG4gICAgICBjb25zdCBzdGF0ZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUudGFibGViYXNlLmV2YWx1YXRpb25zKS50b0VxdWFsKGV2YWx1YXRpb25zKTtcbiAgICAgIGV4cGVjdChzdGF0ZS50YWJsZWJhc2UuZXZhbHVhdGlvbnMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGNsZWFyIGV2YWx1YXRpb25zIHdpdGggZW1wdHkgYXJyYXlcIiwgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RvcmUgPSB1c2VTdG9yZS5nZXRTdGF0ZSgpO1xuXG4gICAgICAvLyBGaXJzdCBzZXQgc29tZSBldmFsdWF0aW9uc1xuICAgICAgc3RvcmUudGFibGViYXNlLnNldEV2YWx1YXRpb25zKFtcbiAgICAgICAgeyBmZW46IFwiOC84LzgvOC84LzgvOC84IHcgLSAtIDAgMVwiLCBldmFsdWF0aW9uOiAwIH0sXG4gICAgICBdKTtcblxuICAgICAgLy8gVGhlbiBjbGVhciB0aGVtXG4gICAgICBzdG9yZS50YWJsZWJhc2Uuc2V0RXZhbHVhdGlvbnMoW10pO1xuXG4gICAgICBjb25zdCBzdGF0ZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUudGFibGViYXNlLmV2YWx1YXRpb25zKS50b0VxdWFsKFtdKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJhZGRFdmFsdWF0aW9uXCIsICgpID0+IHtcbiAgICBpdChcInNob3VsZCBhZGQgZXZhbHVhdGlvbiB0byBhcnJheVwiLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdG9yZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBjb25zdCBldmFsdWF0aW9uOiBQb3NpdGlvbkFuYWx5c2lzID0ge1xuICAgICAgICBmZW46IFwiOC84LzgvOC84LzgvOC84IHcgLSAtIDAgMVwiLFxuICAgICAgICBldmFsdWF0aW9uOiAwLFxuICAgICAgfTtcblxuICAgICAgc3RvcmUudGFibGViYXNlLmFkZEV2YWx1YXRpb24oZXZhbHVhdGlvbik7XG5cbiAgICAgIGNvbnN0IHN0YXRlID0gdXNlU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgIGV4cGVjdChzdGF0ZS50YWJsZWJhc2UuZXZhbHVhdGlvbnMpLnRvQ29udGFpbkVxdWFsKGV2YWx1YXRpb24pO1xuICAgICAgZXhwZWN0KHN0YXRlLnRhYmxlYmFzZS5ldmFsdWF0aW9ucykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgYXBwZW5kIGV2YWx1YXRpb25zIHRvIGV4aXN0aW5nIGFycmF5XCIsICgpID0+IHtcbiAgICAgIGNvbnN0IHN0b3JlID0gdXNlU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgIGNvbnN0IGV2YWwxOiBQb3NpdGlvbkFuYWx5c2lzID0ge1xuICAgICAgICBmZW46IFwiOC84LzgvOC84LzgvOC84IHcgLSAtIDAgMVwiLFxuICAgICAgICBldmFsdWF0aW9uOiAwLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGV2YWwyOiBQb3NpdGlvbkFuYWx5c2lzID0ge1xuICAgICAgICBmZW46IFwiSzcvUDcvazcvOC84LzgvOC84IHcgLSAtIDAgMVwiLFxuICAgICAgICBldmFsdWF0aW9uOiAyLFxuICAgICAgfTtcblxuICAgICAgc3RvcmUudGFibGViYXNlLmFkZEV2YWx1YXRpb24oZXZhbDEpO1xuICAgICAgc3RvcmUudGFibGViYXNlLmFkZEV2YWx1YXRpb24oZXZhbDIpO1xuXG4gICAgICBjb25zdCBzdGF0ZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUudGFibGViYXNlLmV2YWx1YXRpb25zKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBleHBlY3Qoc3RhdGUudGFibGViYXNlLmV2YWx1YXRpb25zWzBdKS50b0VxdWFsKGV2YWwxKTtcbiAgICAgIGV4cGVjdChzdGF0ZS50YWJsZWJhc2UuZXZhbHVhdGlvbnNbMV0pLnRvRXF1YWwoZXZhbDIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcInNldEN1cnJlbnRFdmFsdWF0aW9uXCIsICgpID0+IHtcbiAgICBpdChcInNob3VsZCBzZXQgY3VycmVudCBldmFsdWF0aW9uXCIsICgpID0+IHtcbiAgICAgIGNvbnN0IHN0b3JlID0gdXNlU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgIGNvbnN0IGV2YWx1YXRpb246IFBvc2l0aW9uQW5hbHlzaXMgPSB7XG4gICAgICAgIGZlbjogXCI4LzgvOC84LzgvOC84LzggdyAtIC0gMCAxXCIsXG4gICAgICAgIGV2YWx1YXRpb246IDAsXG4gICAgICB9O1xuXG4gICAgICBzdG9yZS50YWJsZWJhc2Uuc2V0Q3VycmVudEV2YWx1YXRpb24oZXZhbHVhdGlvbik7XG5cbiAgICAgIGNvbnN0IHN0YXRlID0gdXNlU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgIGV4cGVjdChzdGF0ZS50YWJsZWJhc2UuY3VycmVudEV2YWx1YXRpb24pLnRvRXF1YWwoZXZhbHVhdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBjbGVhciBjdXJyZW50IGV2YWx1YXRpb25cIiwgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RvcmUgPSB1c2VTdG9yZS5nZXRTdGF0ZSgpO1xuXG4gICAgICAvLyBGaXJzdCBzZXQgYW4gZXZhbHVhdGlvblxuICAgICAgc3RvcmUudGFibGViYXNlLnNldEN1cnJlbnRFdmFsdWF0aW9uKHtcbiAgICAgICAgZmVuOiBcIjgvOC84LzgvOC84LzgvOCB3IC0gLSAwIDFcIixcbiAgICAgICAgZXZhbHVhdGlvbjogMCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUaGVuIGNsZWFyIGl0XG4gICAgICBzdG9yZS50YWJsZWJhc2Uuc2V0Q3VycmVudEV2YWx1YXRpb24odW5kZWZpbmVkKTtcblxuICAgICAgY29uc3Qgc3RhdGUgPSB1c2VTdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgZXhwZWN0KHN0YXRlLnRhYmxlYmFzZS5jdXJyZW50RXZhbHVhdGlvbikudG9CZVVuZGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcImNsZWFyVGFibGViYXNlU3RhdGVcIiwgKCkgPT4ge1xuICAgIGl0KFwic2hvdWxkIHJlc2V0IGFsbCBzdGF0ZSB0byBpbml0aWFsIHZhbHVlc1wiLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdG9yZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG5cbiAgICAgIC8vIFNldCB2YXJpb3VzIHZhbHVlc1xuICAgICAgc3RvcmUudGFibGViYXNlLnNldFRhYmxlYmFzZU1vdmUoXCJRYjdcIik7XG4gICAgICBzdG9yZS50YWJsZWJhc2Uuc2V0QW5hbHlzaXNTdGF0dXMoXCJsb2FkaW5nXCIpO1xuICAgICAgc3RvcmUudGFibGViYXNlLmFkZEV2YWx1YXRpb24oe1xuICAgICAgICBmZW46IFwiOC84LzgvOC84LzgvOC84IHcgLSAtIDAgMVwiLFxuICAgICAgICBldmFsdWF0aW9uOiAwLFxuICAgICAgfSk7XG4gICAgICBzdG9yZS50YWJsZWJhc2Uuc2V0Q3VycmVudEV2YWx1YXRpb24oe1xuICAgICAgICBmZW46IFwiSzcvUDcvazcvOC84LzgvOC84IHcgLSAtIDAgMVwiLFxuICAgICAgICBldmFsdWF0aW9uOiAyLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIENsZWFyIGV2ZXJ5dGhpbmdcbiAgICAgIHN0b3JlLnRhYmxlYmFzZS5jbGVhclRhYmxlYmFzZVN0YXRlKCk7XG5cbiAgICAgIGNvbnN0IHN0YXRlID0gdXNlU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgIGV4cGVjdChzdGF0ZS50YWJsZWJhc2UudGFibGViYXNlTW92ZSkudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHN0YXRlLnRhYmxlYmFzZS5hbmFseXNpc1N0YXR1cykudG9CZShcImlkbGVcIik7XG4gICAgICBleHBlY3Qoc3RhdGUudGFibGViYXNlLmV2YWx1YXRpb25zKS50b0VxdWFsKFtdKTtcbiAgICAgIGV4cGVjdChzdGF0ZS50YWJsZWJhc2UuY3VycmVudEV2YWx1YXRpb24pLnRvQmVVbmRlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJJbnRlZ3JhdGlvbiB3aXRoIG5lc3RlZCBzdHJ1Y3R1cmVcIiwgKCkgPT4ge1xuICAgIGl0KFwic2hvdWxkIHdvcmsgd2l0aCBvdGhlciBzbGljZXMgaW4gdGhlIHN0b3JlXCIsICgpID0+IHtcbiAgICAgIGNvbnN0IHN0b3JlID0gdXNlU3RvcmUuZ2V0U3RhdGUoKTtcblxuICAgICAgLy8gVmVyaWZ5IHRoYXQgb3RoZXIgc2xpY2VzIGV4aXN0XG4gICAgICBleHBlY3Qoc3RvcmUuZ2FtZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChzdG9yZS50cmFpbmluZykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChzdG9yZS51aSkudG9CZURlZmluZWQoKTtcblxuICAgICAgLy8gU2V0IHRhYmxlYmFzZSBkYXRhXG4gICAgICBzdG9yZS50YWJsZWJhc2Uuc2V0VGFibGViYXNlTW92ZShcIktkNlwiKTtcblxuICAgICAgLy8gVmVyaWZ5IGl0IGRvZXNuJ3QgYWZmZWN0IG90aGVyIHNsaWNlc1xuICAgICAgY29uc3Qgc3RhdGUgPSB1c2VTdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgZXhwZWN0KHN0YXRlLnRhYmxlYmFzZS50YWJsZWJhc2VNb3ZlKS50b0JlKFwiS2Q2XCIpO1xuICAgICAgZXhwZWN0KHN0YXRlLmdhbWUuY3VycmVudEZlbikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChzdGF0ZS50cmFpbmluZy5jdXJyZW50UG9zaXRpb24pLnRvQmVVbmRlZmluZWQoKTsgLy8gU2hvdWxkIGJlIHVuZGVmaW5lZCBpbml0aWFsbHlcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIG1haW50YWluIHByb3BlciBuZXN0aW5nIGluIHN0YXRlIHVwZGF0ZXNcIiwgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RvcmUgPSB1c2VTdG9yZS5nZXRTdGF0ZSgpO1xuXG4gICAgICAvLyBNYWtlIG11bHRpcGxlIHVwZGF0ZXNcbiAgICAgIHN0b3JlLnRhYmxlYmFzZS5zZXRBbmFseXNpc1N0YXR1cyhcImxvYWRpbmdcIik7XG4gICAgICBzdG9yZS50YWJsZWJhc2Uuc2V0VGFibGViYXNlTW92ZShcIlFiN1wiKTtcbiAgICAgIHN0b3JlLnRhYmxlYmFzZS5hZGRFdmFsdWF0aW9uKHtcbiAgICAgICAgZmVuOiBcIjgvOC84LzgvOC84LzgvOCB3IC0gLSAwIDFcIixcbiAgICAgICAgZXZhbHVhdGlvbjogMCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDaGVjayBhbGwgdXBkYXRlcyB3ZXJlIGFwcGxpZWQgY29ycmVjdGx5XG4gICAgICBjb25zdCBzdGF0ZSA9IHVzZVN0b3JlLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUudGFibGViYXNlLmFuYWx5c2lzU3RhdHVzKS50b0JlKFwibG9hZGluZ1wiKTtcbiAgICAgIGV4cGVjdChzdGF0ZS50YWJsZWJhc2UudGFibGViYXNlTW92ZSkudG9CZShcIlFiN1wiKTtcbiAgICAgIGV4cGVjdChzdGF0ZS50YWJsZWJhc2UuZXZhbHVhdGlvbnMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJ1c2VTdG9yZSIsInNldFN0YXRlIiwic3RhdGUiLCJ0YWJsZWJhc2UiLCJ0YWJsZWJhc2VNb3ZlIiwidW5kZWZpbmVkIiwiYW5hbHlzaXNTdGF0dXMiLCJldmFsdWF0aW9ucyIsImN1cnJlbnRFdmFsdWF0aW9uIiwiaXQiLCJzdG9yZSIsImdldFN0YXRlIiwic2V0VGFibGViYXNlTW92ZSIsImV4cGVjdCIsInRvQmUiLCJ0b0JlTnVsbCIsInRvQmVVbmRlZmluZWQiLCJzdGF0dXNlcyIsImZvckVhY2giLCJzdGF0dXMiLCJzZXRBbmFseXNpc1N0YXR1cyIsImZlbiIsImV2YWx1YXRpb24iLCJzZXRFdmFsdWF0aW9ucyIsInRvRXF1YWwiLCJ0b0hhdmVMZW5ndGgiLCJhZGRFdmFsdWF0aW9uIiwidG9Db250YWluRXF1YWwiLCJldmFsMSIsImV2YWwyIiwic2V0Q3VycmVudEV2YWx1YXRpb24iLCJjbGVhclRhYmxlYmFzZVN0YXRlIiwiZ2FtZSIsInRvQmVEZWZpbmVkIiwidHJhaW5pbmciLCJ1aSIsImN1cnJlbnRGZW4i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